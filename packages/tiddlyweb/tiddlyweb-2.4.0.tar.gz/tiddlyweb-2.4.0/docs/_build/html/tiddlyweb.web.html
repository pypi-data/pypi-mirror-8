<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>web Package &mdash; TiddlyWeb 1.4 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="TiddlyWeb 1.4 documentation" href="index.html" />
    <link rel="next" title="challengers Package" href="tiddlyweb.web.challengers.html" />
    <link rel="prev" title="stores Package" href="tiddlyweb.stores.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.web.challengers.html" title="challengers Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.stores.html" title="stores Package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">TiddlyWeb 1.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="web-package">
<h1>web Package<a class="headerlink" href="#web-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">web</span></tt> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-tiddlyweb.web"></span><p>The routines, modules, etc. that are involved in the
presentation and handling of content over HTTP.</p>
<p>These are the parts that makes it TiddlyWeb, not Tiddly
something else.</p>
</div>
<div class="section" id="module-tiddlyweb.web.challenge">
<span id="challenge-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">challenge</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.challenge" title="Permalink to this headline">¶</a></h2>
<p>WSGI App for running the base challenge system, which lists and links
to the available <a class="reference internal" href="tiddlyweb.web.challengers.html#tiddlyweb.web.challengers.ChallengerInterface" title="tiddlyweb.web.challengers.ChallengerInterface"><tt class="xref py py-class docutils literal"><span class="pre">challengers</span></tt></a>. If there is only one
challenger, redirect to it.</p>
<dl class="function">
<dt id="tiddlyweb.web.challenge.base">
<tt class="descclassname">tiddlyweb.web.challenge.</tt><tt class="descname">base</tt><big>(</big><em>environ</em>, <em>start_response</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.challenge.base" title="Permalink to this definition">¶</a></dt>
<dd><p>The basic listing page that shows all available
<a class="reference internal" href="tiddlyweb.web.challengers.html#tiddlyweb.web.challengers.ChallengerInterface" title="tiddlyweb.web.challengers.ChallengerInterface"><tt class="xref py py-class docutils literal"><span class="pre">challenger</span> <span class="pre">systems</span></tt></a>. If there is only
one challenger, we redirect to that instead of listing.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.challenge.challenge_get">
<tt class="descclassname">tiddlyweb.web.challenge.</tt><tt class="descname">challenge_get</tt><big>(</big><em>environ</em>, <em>start_response</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.challenge.challenge_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispatch a <tt class="docutils literal"><span class="pre">GET</span></tt> request to the chosen <a class="reference internal" href="tiddlyweb.web.challengers.html#tiddlyweb.web.challengers.ChallengerInterface" title="tiddlyweb.web.challengers.ChallengerInterface"><tt class="xref py py-class docutils literal"><span class="pre">challenger</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.challenge.challenge_post">
<tt class="descclassname">tiddlyweb.web.challenge.</tt><tt class="descname">challenge_post</tt><big>(</big><em>environ</em>, <em>start_response</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.challenge.challenge_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispatch a <tt class="docutils literal"><span class="pre">POST</span></tt> request to the chosen <a class="reference internal" href="tiddlyweb.web.challengers.html#tiddlyweb.web.challengers.ChallengerInterface" title="tiddlyweb.web.challengers.ChallengerInterface"><tt class="xref py py-class docutils literal"><span class="pre">challenger</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.extractor">
<span id="extractor-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">extractor</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.extractor" title="Permalink to this headline">¶</a></h2>
<p>Extract of user credentials from incoming web requests.
<a class="reference internal" href="#tiddlyweb.web.extractor.UserExtract" title="tiddlyweb.web.extractor.UserExtract"><tt class="xref py py-class docutils literal"><span class="pre">UserExtract</span></tt></a> passes to a stack of extractors. If an
<a class="reference internal" href="tiddlyweb.web.extractors.html#tiddlyweb.web.extractors.ExtractorInterface" title="tiddlyweb.web.extractors.ExtractorInterface"><tt class="xref py py-class docutils literal"><span class="pre">extractor</span></tt></a>
returns something other than <tt class="docutils literal"><span class="pre">None</span></tt>, we have found
valid data with which to set <tt class="docutils literal"><span class="pre">tiddlyweb.usersign</span></tt>.</p>
<dl class="class">
<dt id="tiddlyweb.web.extractor.UserExtract">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.extractor.</tt><tt class="descname">UserExtract</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.extractor.UserExtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to set the <tt class="docutils literal"><span class="pre">tiddlyweb.usersign</span></tt>, if it can
be found in the request.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.listentities">
<span id="listentities-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">listentities</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.listentities" title="Permalink to this headline">¶</a></h2>
<p>Common code used for listing <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bags</span></tt></a>
and <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipes</span></tt></a> in HTTP responses.</p>
<dl class="function">
<dt id="tiddlyweb.web.listentities.list_entities">
<tt class="descclassname">tiddlyweb.web.listentities.</tt><tt class="descname">list_entities</tt><big>(</big><em>environ</em>, <em>start_response</em>, <em>method_name</em>, <em>store_list=None</em>, <em>serializer_list=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.listentities.list_entities" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an optionally <a class="reference internal" href="tiddlyweb.filters.html#module-tiddlyweb.filters" title="tiddlyweb.filters"><tt class="xref py py-mod docutils literal"><span class="pre">filtered</span></tt></a> list
of all the <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bags</span></tt></a> or
<a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipes</span></tt></a>
the current <tt class="docutils literal"><span class="pre">tiddlyweb.usersign</span></tt> can read.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.negotiate">
<span id="negotiate-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">negotiate</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.negotiate" title="Permalink to this headline">¶</a></h2>
<p>WSGI Middleware to do a limited version of content negotiation
and put the type in <tt class="docutils literal"><span class="pre">tiddlyweb.type</span></tt>. On <tt class="docutils literal"><span class="pre">GET</span></tt> and <tt class="docutils literal"><span class="pre">HEAD</span></tt>
requests the <tt class="docutils literal"><span class="pre">Accept</span></tt> header is examined. On <tt class="docutils literal"><span class="pre">POST</span></tt> and <tt class="docutils literal"><span class="pre">PUT</span></tt>,
<tt class="docutils literal"><span class="pre">Content-Type</span></tt>. If extensions are provided on a URI used in a <tt class="docutils literal"><span class="pre">GET</span></tt>
request if the extension matches something in <tt class="docutils literal"><span class="pre">extension_types</span></tt> in
<a class="reference internal" href="tiddlyweb.html#module-tiddlyweb.config" title="tiddlyweb.config"><tt class="xref py py-mod docutils literal"><span class="pre">config</span></tt></a>, the type indicated by the
extension wins over the Accept header.</p>
<dl class="class">
<dt id="tiddlyweb.web.negotiate.Negotiate">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.negotiate.</tt><tt class="descname">Negotiate</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.negotiate.Negotiate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Perform a form of content negotiation to provide information
to the WSGI environment that will later be used to choose
serializers.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.negotiate.figure_type">
<tt class="descclassname">tiddlyweb.web.negotiate.</tt><tt class="descname">figure_type</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.negotiate.figure_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine either the <tt class="docutils literal"><span class="pre">Content-Type</span></tt> (for <tt class="docutils literal"><span class="pre">POST</span></tt> and <tt class="docutils literal"><span class="pre">PUT</span></tt>)
or <tt class="docutils literal"><span class="pre">Accept</span></tt> header (for <tt class="docutils literal"><span class="pre">GET</span></tt>) and put that information
in <tt class="docutils literal"><span class="pre">tiddlyweb.type</span></tt> in the WSGI environment.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.query">
<span id="query-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">query</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.query" title="Permalink to this headline">¶</a></h2>
<p>WSGI Middleware that extracts <tt class="docutils literal"><span class="pre">CGI</span></tt> parameters from the
<tt class="docutils literal"><span class="pre">QUERY_STRING</span></tt> and puts them in <tt class="docutils literal"><span class="pre">tiddlyweb.query</span></tt> in the
environ in the same structure that cgi.py uses (dictionary of lists).
If the current request is a <tt class="docutils literal"><span class="pre">POST</span></tt> of HTML form data, parse that too.</p>
<dl class="class">
<dt id="tiddlyweb.web.query.Query">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.query.</tt><tt class="descname">Query</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.query.Query" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Extract <tt class="docutils literal"><span class="pre">CGI</span></tt> parameter data from <tt class="docutils literal"><span class="pre">QUERY_STRING</span></tt> and POSTed form data.</p>
<dl class="method">
<dt id="tiddlyweb.web.query.Query.extract_query">
<tt class="descname">extract_query</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.query.Query.extract_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the <tt class="docutils literal"><span class="pre">QUERY_STRING</span></tt> and body (if a POSTed form) to extract
query parameters. Put the results in <tt class="docutils literal"><span class="pre">tiddlyweb.query</span></tt> in
environ. The query names and values are decoded from UTF-8 to
unicode.</p>
<p>If there are file uploads in posted form data, the files are
not put into <tt class="docutils literal"><span class="pre">tiddlyweb.query</span></tt>. Instead the file handles are
appended to <tt class="docutils literal"><span class="pre">tiddlyweb.input_files</span></tt>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.sendentity">
<span id="sendentity-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">sendentity</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.sendentity" title="Permalink to this headline">¶</a></h2>
<p>Send a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a> or <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a> out over HTTP, first <a class="reference internal" href="tiddlyweb.html#tiddlyweb.serializer.Serializer" title="tiddlyweb.serializer.Serializer"><tt class="xref py py-class docutils literal"><span class="pre">serializing</span></tt></a> to the correct type.</p>
<p>This consolidates common code for bags and recipes.</p>
<dl class="function">
<dt id="tiddlyweb.web.sendentity.send_entity">
<tt class="descclassname">tiddlyweb.web.sendentity.</tt><tt class="descname">send_entity</tt><big>(</big><em>environ</em>, <em>start_response</em>, <em>entity</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.sendentity.send_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a> or <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a> out over HTTP, first
<a class="reference internal" href="tiddlyweb.html#tiddlyweb.serializer.Serializer" title="tiddlyweb.serializer.Serializer"><tt class="xref py py-class docutils literal"><span class="pre">serializing</span></tt></a> to
the correct type. If an incoming <tt class="docutils literal"><span class="pre">Etag</span></tt> validates, raise a
<tt class="docutils literal"><span class="pre">304</span></tt> response.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.sendtiddlers">
<span id="sendtiddlers-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">sendtiddlers</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.sendtiddlers" title="Permalink to this headline">¶</a></h2>
<p>Routines related to sending a list of <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.tiddler.Tiddler" title="tiddlyweb.model.tiddler.Tiddler"><tt class="xref py py-class docutils literal"><span class="pre">tiddlers</span></tt></a> out to the web, including optionally
<a class="reference internal" href="tiddlyweb.filters.html#module-tiddlyweb.filters" title="tiddlyweb.filters"><tt class="xref py py-mod docutils literal"><span class="pre">filtering</span></tt></a> those tiddlers and
validating cache-oriented request headers.</p>
<dl class="function">
<dt id="tiddlyweb.web.sendtiddlers.send_tiddlers">
<tt class="descclassname">tiddlyweb.web.sendtiddlers.</tt><tt class="descname">send_tiddlers</tt><big>(</big><em>environ</em>, <em>start_response</em>, <em>tiddlers=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.sendtiddlers.send_tiddlers" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.tiddler.Tiddler" title="tiddlyweb.model.tiddler.Tiddler"><tt class="xref py py-class docutils literal"><span class="pre">tiddlers</span></tt></a>
contained in the provided <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.collections.Tiddlers" title="tiddlyweb.model.collections.Tiddlers"><tt class="xref py py-class docutils literal"><span class="pre">Tiddlers</span> <span class="pre">collection</span></tt></a> in a <a class="reference internal" href="#module-tiddlyweb.web.negotiate" title="tiddlyweb.web.negotiate"><tt class="xref py py-mod docutils literal"><span class="pre">Negotiated</span></tt></a> representation.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.serve">
<span id="serve-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">serve</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.serve" title="Permalink to this headline">¶</a></h2>
<p>Functions and Classes for running a TiddlyWeb server, including
optionally a built in web server.</p>
<dl class="class">
<dt id="tiddlyweb.web.serve.Configurator">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">Configurator</tt><big>(</big><em>application</em>, <em>config</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.Configurator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI middleware to set <tt class="docutils literal"><span class="pre">tiddlyweb.config</span></tt> in <tt class="docutils literal"><span class="pre">environ</span></tt> for
every request from <a class="reference internal" href="tiddlyweb.html#module-tiddlyweb.config" title="tiddlyweb.config"><tt class="xref py py-mod docutils literal"><span class="pre">config</span></tt></a>.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.serve.RequestStarter">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">RequestStarter</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.RequestStarter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI middleware that logs basic request information and cleans
<tt class="docutils literal"><span class="pre">PATH_INFO</span></tt> in the environment.</p>
<p><tt class="docutils literal"><span class="pre">PATH_INFO</span></tt> cleaning is done to ensure that there is a
well known encoding of special characters and to support
<tt class="docutils literal"><span class="pre">/</span></tt> in entity names (see <a class="reference internal" href="#tiddlyweb.web.serve.RequestStarter.clean_path_info" title="tiddlyweb.web.serve.RequestStarter.clean_path_info"><tt class="xref py py-func docutils literal"><span class="pre">clean_path_info()</span></tt></a>).</p>
<dl class="method">
<dt id="tiddlyweb.web.serve.RequestStarter.clean_path_info">
<tt class="descname">clean_path_info</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.RequestStarter.clean_path_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean <tt class="docutils literal"><span class="pre">PATH_INFO</span></tt> in the environment.</p>
<p>This is necessary because WSGI servers tend to decode
the URI before putting it in <tt class="docutils literal"><span class="pre">PATH_INFO</span></tt>. This means that
uri encoded data, such as the <tt class="docutils literal"><span class="pre">%2F</span></tt> encoding of <tt class="docutils literal"><span class="pre">/</span></tt>
will be decoded before we get to route dispatch handling,
by which time the <tt class="docutils literal"><span class="pre">/</span></tt> is treated as a separator. People
say that the right thing to do here is not use <tt class="docutils literal"><span class="pre">%2F</span></tt>.
This is hogwash. The right thing to do is not decode
<tt class="docutils literal"><span class="pre">PATH_INFO</span></tt>. In this solution if <tt class="docutils literal"><span class="pre">REQUEST_URI</span></tt> is present
we use a portion of it to set <tt class="docutils literal"><span class="pre">PATH_INFO</span></tt>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.serve.load_app">
<tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">load_app</tt><big>(</big><em>app_prefix=None</em>, <em>dirname=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.load_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Create our application from a series of layers. The innermost
layer is a Selector application based on <tt class="docutils literal"><span class="pre">urls_map</span></tt> defined in
<a class="reference internal" href="tiddlyweb.html#module-tiddlyweb.config" title="tiddlyweb.config"><tt class="xref py py-mod docutils literal"><span class="pre">config</span></tt></a>. This is surrounded by wrappers,
which either set something in the environment, modify the request,
or transform the response. The wrappers are WSGI middleware defined
by <tt class="docutils literal"><span class="pre">server_request_filters</span></tt> and <tt class="docutils literal"><span class="pre">server_response_filters</span></tt> in
<a class="reference internal" href="tiddlyweb.html#module-tiddlyweb.config" title="tiddlyweb.config"><tt class="xref py py-mod docutils literal"><span class="pre">tiddlyweb.config</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.serve.start_server">
<tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">start_server</tt><big>(</big><em>config</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.start_server" title="Permalink to this definition">¶</a></dt>
<dd><p>Start a simple webserver, from <tt class="docutils literal"><span class="pre">wsgiref</span></tt>, to run our app.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.util">
<span id="util-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">util</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.util" title="Permalink to this headline">¶</a></h2>
<p>General utility routines shared by various web related modules.</p>
<dl class="function">
<dt id="tiddlyweb.web.util.bag_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">bag_etag</tt><big>(</big><em>environ</em>, <em>bag</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.bag_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag for a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.bag_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">bag_url</tt><big>(</big><em>environ</em>, <em>bag</em>, <em>full=True</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.bag_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a URL for a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.check_bag_constraint">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">check_bag_constraint</tt><big>(</big><em>environ</em>, <em>bag</em>, <em>constraint</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.check_bag_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Check to see if the provided <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a>
allows the current <tt class="docutils literal"><span class="pre">tiddlyweb.usersign</span></tt> to perform the action described
by <tt class="docutils literal"><span class="pre">constraint</span></tt>. Lets NoBagError raise if the bag does not exist.</p>
<p>This is a web util because user and store come from the WSGI environ.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.check_incoming_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">check_incoming_etag</tt><big>(</big><em>environ</em>, <em>etag_string</em>, <em>cache_control='no-cache'</em>, <em>last_modified=None</em>, <em>vary='Accept'</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.check_incoming_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise 304 if the provided <tt class="docutils literal"><span class="pre">etag_string</span></tt> is the same as that found
in the <tt class="docutils literal"><span class="pre">If-None-Match</span></tt> header of the incoming request.</p>
<p>Return <tt class="docutils literal"><span class="pre">incoming_etag</span></tt> to indicate if an etag was there but
did not match.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.check_last_modified">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">check_last_modified</tt><big>(</big><em>environ</em>, <em>last_modified_string</em>, <em>etag=''</em>, <em>cache_control='no-cache'</em>, <em>vary='Accept'</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.check_last_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise <tt class="docutils literal"><span class="pre">304</span></tt> if an <tt class="docutils literal"><span class="pre">If-Modified-Since</span></tt> header matches
<tt class="docutils literal"><span class="pre">last_modified_string</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.content_length_and_type">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">content_length_and_type</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.content_length_and_type" title="Permalink to this definition">¶</a></dt>
<dd><p>For <tt class="docutils literal"><span class="pre">PUT</span></tt> or <tt class="docutils literal"><span class="pre">POST</span></tt> request there must be <tt class="docutils literal"><span class="pre">Content-Length</span></tt> and
<tt class="docutils literal"><span class="pre">Content-Type</span></tt> headers. Raise <tt class="docutils literal"><span class="pre">400</span></tt> if not present in the request.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.datetime_from_http_date">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">datetime_from_http_date</tt><big>(</big><em>http_datestring</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.datetime_from_http_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn an HTTP formatted date into a datetime object.
Return <tt class="docutils literal"><span class="pre">None</span></tt> if the date string is invalid.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.encode_name">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">encode_name</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.encode_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode a unicode value as utf-8 and then URL encode that
string. Use for entity titles in URLs.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.entity_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">entity_etag</tt><big>(</big><em>environ</em>, <em>entity</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.entity_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an Etag from the digest of the <a class="reference internal" href="tiddlyweb.serializations.html#tiddlyweb.serializations.json.Serialization" title="tiddlyweb.serializations.json.Serialization"><tt class="xref py py-class docutils literal"><span class="pre">JSON</span></tt></a> reprepresentation
of an entity.</p>
<p>The JSON representation provides a reasonably repeatable and
unique string of data.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.escape_attribute_value">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">escape_attribute_value</tt><big>(</big><em>text</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.escape_attribute_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Escape common HTML character entities, including double quotes
in attribute values</p>
<p>This assumes values are enclosed in double quotes (key=&#8221;value&#8221;).</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.get_route_value">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">get_route_value</tt><big>(</big><em>environ</em>, <em>name</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.get_route_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and decode <tt class="docutils literal"><span class="pre">name</span></tt> from data provided in WSGI route.</p>
<p>If <tt class="docutils literal"><span class="pre">name</span></tt> is not present in the route, allow KeyError to raise.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.get_serialize_type">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">get_serialize_type</tt><big>(</big><em>environ</em>, <em>collection=False</em>, <em>accept_type=False</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.get_serialize_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Look in the <tt class="docutils literal"><span class="pre">environ</span></tt> to determine which <a class="reference internal" href="tiddlyweb.html#tiddlyweb.serializer.Serializer" title="tiddlyweb.serializer.Serializer"><tt class="xref py py-class docutils literal"><span class="pre">serializer</span></tt></a> should be used for this request.</p>
<p>If <tt class="docutils literal"><span class="pre">collection</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, then the presence of an extension
on the URI which does not match any serializer should lead to a <tt class="docutils literal"><span class="pre">415</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.handle_extension">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">handle_extension</tt><big>(</big><em>environ</em>, <em>resource_name</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.handle_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for an extension (as defined in <a class="reference internal" href="tiddlyweb.html#module-tiddlyweb.config" title="tiddlyweb.config"><tt class="xref py py-mod docutils literal"><span class="pre">config</span></tt></a>)
on the provided <tt class="docutils literal"><span class="pre">resource_name</span></tt> and trim it off to give the
&#8220;real&#8221; resource name.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.html_encode">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">html_encode</tt><big>(</big><em>text</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.html_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode <tt class="docutils literal"><span class="pre">&amp;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;</span></tt> and <tt class="docutils literal"><span class="pre">&gt;</span></tt> entities in <tt class="docutils literal"><span class="pre">text</span></tt> that will
be used in or as HTML.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.html_frame">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">html_frame</tt><big>(</big><em>environ</em>, <em>title=''</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.html_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the header and footer from the current HTML
<a class="reference internal" href="tiddlyweb.serializations.html#tiddlyweb.serializations.SerializationInterface" title="tiddlyweb.serializations.SerializationInterface"><tt class="xref py py-class docutils literal"><span class="pre">serialization</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.http_date_from_timestamp">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">http_date_from_timestamp</tt><big>(</big><em>timestamp</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.http_date_from_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a modifier or created tiddler <tt class="docutils literal"><span class="pre">timestamp</span></tt>
into a properly formatted HTTP date. If the timestamp
is invalid use the current time as the timestamp.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.make_cookie">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">make_cookie</tt><big>(</big><em>name</em>, <em>value</em>, <em>mac_key=None</em>, <em>path=None</em>, <em>expires=None</em>, <em>httponly=True</em>, <em>domain=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.make_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a cookie string, optionally with a MAC, path and
expires value. If <tt class="docutils literal"><span class="pre">expires</span></tt> is provided, its value should be
in seconds.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.read_request_body">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">read_request_body</tt><big>(</big><em>environ</em>, <em>length</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.read_request_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the <tt class="docutils literal"><span class="pre">wsgi.input</span></tt> handle to get the request body.</p>
<p>Length is a required parameter because it is tested for existence
earlier in the process.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.recipe_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">recipe_etag</tt><big>(</big><em>environ</em>, <em>recipe</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.recipe_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag for a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.recipe_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">recipe_url</tt><big>(</big><em>environ</em>, <em>recipe</em>, <em>full=True</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.recipe_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a URL for a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.server_base_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">server_base_url</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.server_base_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Using information in <a class="reference internal" href="tiddlyweb.html#module-tiddlyweb.config" title="tiddlyweb.config"><tt class="xref py py-mod docutils literal"><span class="pre">tiddlyweb.config</span></tt></a>, construct
the base URL of the server, without the trailing <tt class="docutils literal"><span class="pre">/</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.server_host_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">server_host_url</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.server_host_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the scheme and host portion of our server url.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.tiddler_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">tiddler_etag</tt><big>(</big><em>environ</em>, <em>tiddler</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.tiddler_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag for a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.tiddler.Tiddler" title="tiddlyweb.model.tiddler.Tiddler"><tt class="xref py py-class docutils literal"><span class="pre">tiddler</span></tt></a> from the tiddler&#8217;s attributes,
but not its text.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.tiddler_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">tiddler_url</tt><big>(</big><em>environ</em>, <em>tiddler</em>, <em>container='bags'</em>, <em>full=True</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.tiddler_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a URL for a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.tiddler.Tiddler" title="tiddlyweb.model.tiddler.Tiddler"><tt class="xref py py-class docutils literal"><span class="pre">tiddler</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.validator">
<span id="validator-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">validator</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.validator" title="Permalink to this headline">¶</a></h2>
<p>A collection of routines for validating, santizing and otherwise messing
with content coming in from the web to be <tt class="xref py py-class docutils literal"><span class="pre">tiddlers</span></tt>, <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bags</span></tt></a> or <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipes</span></tt></a>.</p>
<p>The validators can be extended by adding functions to the <tt class="docutils literal"><span class="pre">BAG_VALIDATORS</span></tt>,
<tt class="docutils literal"><span class="pre">RECIPE_VALIDATORS</span></tt> and <tt class="docutils literal"><span class="pre">TIDDLER_VALIDATORS</span></tt>. The functions take an
entity object, and an optional WSGI <tt class="docutils literal"><span class="pre">environ</span></tt> dict.</p>
<dl class="exception">
<dt id="tiddlyweb.web.validator.InvalidBagError">
<em class="property">exception </em><tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">InvalidBagError</tt><a class="headerlink" href="#tiddlyweb.web.validator.InvalidBagError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
<p>The provided <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a> has not passed
a validation routine and has been rejected. The caller should stop
processing and return an error to calling code or user-agent.</p>
</dd></dl>

<dl class="exception">
<dt id="tiddlyweb.web.validator.InvalidRecipeError">
<em class="property">exception </em><tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">InvalidRecipeError</tt><a class="headerlink" href="#tiddlyweb.web.validator.InvalidRecipeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
<p>The provided <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a> has
not passed a validation routine and has been rejected. The caller
should stop processing and return an error to calling code or
user-agent.</p>
</dd></dl>

<dl class="exception">
<dt id="tiddlyweb.web.validator.InvalidTiddlerError">
<em class="property">exception </em><tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">InvalidTiddlerError</tt><a class="headerlink" href="#tiddlyweb.web.validator.InvalidTiddlerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
<p>The provided <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.tiddler.Tiddler" title="tiddlyweb.model.tiddler.Tiddler"><tt class="xref py py-class docutils literal"><span class="pre">tiddler</span></tt></a>
has not passed a validation routine and has been rejected.
The caller should stop processing and return an error to calling
code or user-agent.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.sanitize_desc">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">sanitize_desc</tt><big>(</big><em>entity</em>, <em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.sanitize_desc" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip any dangerous HTML which may be present in a <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a> or <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a> description.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.sanitize_html_fragment">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">sanitize_html_fragment</tt><big>(</big><em>fragment</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.sanitize_html_fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Santize an HTML <tt class="docutils literal"><span class="pre">fragment</span></tt>, returning a copy of the fragment
that has been cleaned up.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.validate_bag">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">validate_bag</tt><big>(</big><em>bag</em>, <em>environ=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.validate_bag" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a> to each of
the functions in <tt class="docutils literal"><span class="pre">BAG_VALIDATORS</span></tt>, in order, either changing
the content of the bags&#8217;s attributes, or if some aspect of the
bag can not be accepted raising <a class="reference internal" href="#tiddlyweb.web.validator.InvalidBagError" title="tiddlyweb.web.validator.InvalidBagError"><tt class="xref py py-class docutils literal"><span class="pre">InvalidBagError</span></tt></a>.</p>
<p><tt class="docutils literal"><span class="pre">BAG_VALIDATORS</span></tt> may be extended by plugins.</p>
<p><tt class="docutils literal"><span class="pre">validate_bag</span></tt> is called whenever a bag is <tt class="docutils literal"><span class="pre">PUT</span></tt> via HTTP.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.validate_recipe">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">validate_recipe</tt><big>(</big><em>recipe</em>, <em>environ=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.validate_recipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.recipe.Recipe" title="tiddlyweb.model.recipe.Recipe"><tt class="xref py py-class docutils literal"><span class="pre">recipe</span></tt></a> to
each of the functions in <tt class="docutils literal"><span class="pre">RECIPE_VALIDATORS</span></tt>, in order, either
changing the content of the recipes&#8217;s attributes, or if some aspect
of the recipe can not be accepted raising <a class="reference internal" href="#tiddlyweb.web.validator.InvalidRecipeError" title="tiddlyweb.web.validator.InvalidRecipeError"><tt class="xref py py-class docutils literal"><span class="pre">InvalidRecipeError</span></tt></a>.</p>
<p><tt class="docutils literal"><span class="pre">RECIPE_VALIDATORS</span></tt> may be extended by plugins.</p>
<p><tt class="docutils literal"><span class="pre">validate_recipe</span></tt> is called whenever a recipe is <tt class="docutils literal"><span class="pre">PUT</span></tt> via HTTP.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.validate_tiddler">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">validate_tiddler</tt><big>(</big><em>tiddler</em>, <em>environ=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.validate_tiddler" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.tiddler.Tiddler" title="tiddlyweb.model.tiddler.Tiddler"><tt class="xref py py-class docutils literal"><span class="pre">tiddler</span></tt></a>
to each of the functions in <tt class="docutils literal"><span class="pre">TIDDLER_VALIDATORS</span></tt>, in order,
either changing the content of the tiddler&#8217;s attributes, or if
some aspect of the tiddler can not be accepted raising
<a class="reference internal" href="#tiddlyweb.web.validator.InvalidTiddlerError" title="tiddlyweb.web.validator.InvalidTiddlerError"><tt class="xref py py-class docutils literal"><span class="pre">InvalidTiddlerError</span></tt></a>.</p>
<p><tt class="docutils literal"><span class="pre">TIDDLER_VALIDATORS</span></tt> is an empty list which may be extended
by plugins.</p>
<p><tt class="docutils literal"><span class="pre">validate_tiddler</span></tt> is called from <a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler" title="tiddlyweb.web.handler"><tt class="xref py py-mod docutils literal"><span class="pre">web</span> <span class="pre">handlers</span></tt></a>, when the <tt class="docutils literal"><span class="pre">accept</span></tt> constraint on
the <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.policy.Policy" title="tiddlyweb.model.policy.Policy"><tt class="xref py py-class docutils literal"><span class="pre">policy</span></tt></a> of the
<a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.bag.Bag" title="tiddlyweb.model.bag.Bag"><tt class="xref py py-class docutils literal"><span class="pre">bag</span></tt></a> containing the
tiddler does not pass.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.wsgi">
<span id="wsgi-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">wsgi</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.wsgi" title="Permalink to this headline">¶</a></h2>
<p>WSGI Middleware apps that haven&#8217;t gotten around to being extracted to
their own modules.</p>
<dl class="class">
<dt id="tiddlyweb.web.wsgi.EncodeUTF8">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">EncodeUTF8</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.EncodeUTF8" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to ensure that the unicode content sent out the
pipe is encoded to UTF-8. Within the application string-based content
is <em>unicode</em> (i.e. not encoded).</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.Header">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">Header</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.Header" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>If <tt class="docutils literal"><span class="pre">REQUEST_METHOD</span></tt> is HEAD, change it internally to <tt class="docutils literal"><span class="pre">GET</span></tt> and
consume the generated output so the response has no body.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.PermissionsExceptor">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">PermissionsExceptor</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.PermissionsExceptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Trap <a class="reference internal" href="tiddlyweb.model.html#tiddlyweb.model.policy.PermissionsError" title="tiddlyweb.model.policy.PermissionsError"><tt class="xref py py-class docutils literal"><span class="pre">permissions</span> <span class="pre">exceptions</span></tt></a> and turn them into HTTP
exceptions so the errors are propagated to clients.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.SimpleLog">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">SimpleLog</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.SimpleLog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to write a very simple log to <tt class="docutils literal"><span class="pre">stdout</span></tt>.</p>
<p>Borrowed from Paste Translogger</p>
<dl class="attribute">
<dt id="tiddlyweb.web.wsgi.SimpleLog.format">
<tt class="descname">format</tt><em class="property"> = '%(REMOTE_ADDR)s - %(REMOTE_USER)s [%(time)s] &quot;%(REQUEST_METHOD)s %(REQUEST_URI)s %(HTTP_VERSION)s&quot; %(status)s %(bytes)s &quot;%(HTTP_REFERER)s&quot; &quot;%(HTTP_USER_AGENT)s&quot;'</em><a class="headerlink" href="#tiddlyweb.web.wsgi.SimpleLog.format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tiddlyweb.web.wsgi.SimpleLog.write_log">
<tt class="descname">write_log</tt><big>(</big><em>environ</em>, <em>req_uri</em>, <em>status</em>, <em>size</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.SimpleLog.write_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the log info out in a formatted form to <tt class="docutils literal"><span class="pre">logging.info</span></tt>.</p>
<p>This is rather more complex than desirable because there is
a mix of <tt class="docutils literal"><span class="pre">str</span></tt> and <tt class="docutils literal"><span class="pre">unicode</span></tt> in the gathered data and it
needs to be made acceptable for output.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.StoreSet">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">StoreSet</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.StoreSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware that sets our choice of <a class="reference internal" href="tiddlyweb.html#tiddlyweb.store.Store" title="tiddlyweb.store.Store"><tt class="xref py py-class docutils literal"><span class="pre">Store</span></tt></a> in the <tt class="docutils literal"><span class="pre">environ</span></tt>. That is, initialize
the store for each request.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.TransformProtect">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">TransformProtect</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.TransformProtect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to add a <tt class="docutils literal"><span class="pre">Cache-Control:</span> <span class="pre">no-transform`</span></tt> header
so that mobile companies that transcode content over their 3G (etc)
networks don&#8217;t, as it will break various JavaScript things,
including TiddlyWiki.</p>
</dd></dl>

</div>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="tiddlyweb.web.challengers.html">challengers Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.challengers.html#id1"><tt class="docutils literal"><span class="pre">challengers</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.challengers.html#module-tiddlyweb.web.challengers.cookie_form"><tt class="docutils literal"><span class="pre">cookie_form</span></tt> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tiddlyweb.web.extractors.html">extractors Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.extractors.html#id1"><tt class="docutils literal"><span class="pre">extractors</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.extractors.html#module-tiddlyweb.web.extractors.http_basic"><tt class="docutils literal"><span class="pre">http_basic</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.extractors.html#module-tiddlyweb.web.extractors.simple_cookie"><tt class="docutils literal"><span class="pre">simple_cookie</span></tt> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tiddlyweb.web.handler.html">handler Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#id1"><tt class="docutils literal"><span class="pre">handler</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.bag"><tt class="docutils literal"><span class="pre">bag</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.chronicle"><tt class="docutils literal"><span class="pre">chronicle</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.recipe"><tt class="docutils literal"><span class="pre">recipe</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.search"><tt class="docutils literal"><span class="pre">search</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.tiddler"><tt class="docutils literal"><span class="pre">tiddler</span></tt> Module</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">web Package</a><ul>
<li><a class="reference internal" href="#id1"><tt class="docutils literal"><span class="pre">web</span></tt> Package</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.challenge"><tt class="docutils literal"><span class="pre">challenge</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.extractor"><tt class="docutils literal"><span class="pre">extractor</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.listentities"><tt class="docutils literal"><span class="pre">listentities</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.negotiate"><tt class="docutils literal"><span class="pre">negotiate</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.query"><tt class="docutils literal"><span class="pre">query</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.sendentity"><tt class="docutils literal"><span class="pre">sendentity</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.sendtiddlers"><tt class="docutils literal"><span class="pre">sendtiddlers</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.serve"><tt class="docutils literal"><span class="pre">serve</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.util"><tt class="docutils literal"><span class="pre">util</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.validator"><tt class="docutils literal"><span class="pre">validator</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.wsgi"><tt class="docutils literal"><span class="pre">wsgi</span></tt> Module</a></li>
<li><a class="reference internal" href="#subpackages">Subpackages</a><ul>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tiddlyweb.stores.html"
                        title="previous chapter">stores Package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tiddlyweb.web.challengers.html"
                        title="next chapter">challengers Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tiddlyweb.web.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.web.challengers.html" title="challengers Package"
             >next</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.stores.html" title="stores Package"
             >previous</a> |</li>
        <li><a href="index.html">TiddlyWeb 1.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Chris Dent.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>