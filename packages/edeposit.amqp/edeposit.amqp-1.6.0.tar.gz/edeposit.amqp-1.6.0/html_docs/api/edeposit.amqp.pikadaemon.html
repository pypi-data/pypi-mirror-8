<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PikaDaemon &mdash; edeposit.amqp 1.6.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="edeposit.amqp 1.6.0 documentation" href="../index.html" />
    <link rel="next" title="AMQPDaemon" href="edeposit.amqp.amqpdaemon.html" />
    <link rel="prev" title="DaemonRunnerWrapper" href="edeposit.amqp.daemonwrapper.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="edeposit.amqp.amqpdaemon.html" title="AMQPDaemon"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="edeposit.amqp.daemonwrapper.html" title="DaemonRunnerWrapper"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">edeposit.amqp 1.6.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-edeposit.amqp.pikadaemon">
<span id="pikadaemon"></span><h1>PikaDaemon<a class="headerlink" href="#module-edeposit.amqp.pikadaemon" title="Permalink to this headline">¶</a></h1>
<p>Generic AMQP blocking communication daemon server.</p>
<p>Usage is simple - just inherit the class and override
<a class="reference internal" href="#edeposit.amqp.pikadaemon.PikaDaemon.onMessageReceived" title="edeposit.amqp.pikadaemon.PikaDaemon.onMessageReceived"><tt class="xref py py-func docutils literal"><span class="pre">PikaDaemon.onMessageReceived()</span></tt></a>.</p>
<p>You can send messages back using either <a class="reference internal" href="#edeposit.amqp.pikadaemon.PikaDaemon.sendMessage" title="edeposit.amqp.pikadaemon.PikaDaemon.sendMessage"><tt class="xref py py-func docutils literal"><span class="pre">PikaDaemon.sendMessage()</span></tt></a> or
<a class="reference internal" href="#edeposit.amqp.pikadaemon.PikaDaemon.sendResponse" title="edeposit.amqp.pikadaemon.PikaDaemon.sendResponse"><tt class="xref py py-func docutils literal"><span class="pre">PikaDaemon.sendResponse()</span></tt></a>. Fist one allows you to send message
everywhere, second one send message to the queue defined by constructor.</p>
<dl class="class">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon">
<em class="property">class </em><tt class="descclassname">edeposit.amqp.pikadaemon.</tt><tt class="descname">PikaDaemon</tt><big>(</big><em>connection_param</em>, <em>queue</em>, <em>output_exchange</em>, <em>output_key</em><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="edeposit.amqp.daemonwrapper.html#edeposit.amqp.daemonwrapper.DaemonRunnerWrapper" title="edeposit.amqp.daemonwrapper.DaemonRunnerWrapper"><tt class="xref py py-class docutils literal"><span class="pre">edeposit.amqp.daemonwrapper.DaemonRunnerWrapper</span></tt></a></p>
<p>Pika and Daemon wrapper for handling AMQP connections.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>connection_param</strong> (<em>pika.ConnectionParameters</em>) &#8211;
object setting the
connection</li>
<li><strong>queue</strong> (<em>str</em>) &#8211;
name of queue where the daemon should listen</li>
<li><strong>output_exchange</strong> (<em>str</em>) &#8211;
name of exchange where the daemon should put
responses</li>
<li><strong>output_key</strong> (<em>str</em>) &#8211;
routing key for output exchange</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon.ack">
<tt class="descname">ack</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon.ack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon.ack" title="Permalink to this definition">¶</a></dt>
<dd><p>Acknowledge, that message was received.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This will in some cases (depends on settings of RabbitMQ) remove
the message from the message queue.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon.body">
<tt class="descname">body</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon.body"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon.body" title="Permalink to this definition">¶</a></dt>
<dd><p>This method just handles AMQP connection details and receive loop.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Don&#8217;t override this method!</p>
</div>
</dd></dl>

<dl class="method">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon.onExit">
<tt class="descname">onExit</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon.onExit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon.onExit" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when daemon is stopped. Basically just AMQP&#8217;s <tt class="docutils literal"><span class="pre">.close()</span></tt>
functions to ensure clean exit.</p>
<p>You can override this, but don&#8217;t forget to call it thru <tt class="docutils literal"><span class="pre">super()</span></tt>, or
the AMQP communication won&#8217;t be closed properly!</p>
</dd></dl>

<dl class="method">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon.onMessageReceived">
<tt class="descname">onMessageReceived</tt><big>(</big><em>method_frame</em>, <em>properties</em>, <em>body</em><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon.onMessageReceived"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon.onMessageReceived" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback which is called every time when message is received.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You SHOULD override this.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is expected, that method returns True, if you want to
automatically ack the received message, which can be important in
some situations, because otherwise the message will be held in
message queue until someone will ack it.</p>
<p class="last">You don&#8217;t have to return True/False - you can ack the message
yourself, by calling <a class="reference internal" href="#edeposit.amqp.pikadaemon.PikaDaemon.ack" title="edeposit.amqp.pikadaemon.PikaDaemon.ack"><tt class="xref py py-func docutils literal"><span class="pre">ack()</span></tt></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Good design choice is to ack the message AFTER you process it, to
be sure, that message is processed properly and can be removed from
queue.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon.sendMessage">
<tt class="descname">sendMessage</tt><big>(</big><em>exchange</em>, <em>routing_key</em>, <em>message</em>, <em>properties=None</em>, <em>UUID=None</em><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon.sendMessage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon.sendMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>With this function, you can send message to <cite>exchange</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>exchange</strong> (<em>str</em>) &#8211;
name of exchange you want to message to be
delivered</li>
<li><strong>routing_key</strong> (<em>str</em>) &#8211;
which routing key to use in headers of message</li>
<li><strong>message</strong> (<em>str</em>) &#8211;
body of message</li>
<li><strong>properties</strong> (<em>dict ,optional</em>) &#8211;
properties of message - if not used,
or set to <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">self.content_type</span></tt>
and <tt class="docutils literal"><span class="pre">delivery_mode=2</span></tt> (persistent) is
used</li>
<li><strong>UUID</strong> (<em>str, optional</em>) &#8211;
UUID of the message. If set, it is included
into <tt class="docutils literal"><span class="pre">properties</span></tt> of the message.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="edeposit.amqp.pikadaemon.PikaDaemon.sendResponse">
<tt class="descname">sendResponse</tt><big>(</big><em>message</em>, <em>UUID</em>, <em>routing_key</em><big>)</big><a class="reference internal" href="../_modules/edeposit/amqp/pikadaemon.html#PikaDaemon.sendResponse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edeposit.amqp.pikadaemon.PikaDaemon.sendResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Send <cite>message</cite> to <tt class="docutils literal"><span class="pre">self.output_exchange</span></tt> with routing key
<tt class="docutils literal"><span class="pre">self.output_key</span></tt>, <tt class="docutils literal"><span class="pre">self.content_type</span></tt> in <tt class="docutils literal"><span class="pre">delivery_mode=2</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> (<em>str</em>) &#8211;
message which will be sent</li>
<li><strong>UUID</strong> &#8211;
unique identification of message</li>
<li><strong>routing_key</strong> (<em>str</em>) &#8211;
which routing key to use to send message back</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="edeposit.amqp.daemonwrapper.html"
                        title="previous chapter">DaemonRunnerWrapper</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="edeposit.amqp.amqpdaemon.html"
                        title="next chapter">AMQPDaemon</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/edeposit.amqp.pikadaemon.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="edeposit.amqp.amqpdaemon.html" title="AMQPDaemon"
             >next</a> |</li>
        <li class="right" >
          <a href="edeposit.amqp.daemonwrapper.html" title="DaemonRunnerWrapper"
             >previous</a> |</li>
        <li><a href="../index.html">edeposit.amqp 1.6.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014 E-deposit team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>