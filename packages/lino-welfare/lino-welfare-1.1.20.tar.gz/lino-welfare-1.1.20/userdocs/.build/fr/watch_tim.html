<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>watch_tim &mdash; documentation Lino-Welfare User Documentation 1.1.11</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.11',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="documentation Lino-Welfare User Documentation 1.1.11" href="index.html" />
    <link rel="next" title="Users" href="users.html" />
    <link rel="prev" title="Concepts généraux" href="general.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="users.html" title="Users"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="general.html" title="Concepts généraux"
             accesskey="P">précédent</a> |</li>
        <li><a href="index.html">documentation Lino-Welfare User Documentation 1.1.11</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
  <div class="section" id="watch-tim">
<span id="welfare-watch-tim"></span><h1>watch_tim<a class="headerlink" href="#watch-tim" title="Lien permanent vers ce titre">¶</a></h1>
<p>Diese Seite ist die offizielle Dokumentation der Synchronisierung
von TIM nach Lino, einer Funktionalität, die ausschließlich im
deutschsprachigen Raum Belgiens genutzt wird.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#partner-und-watch-tim" id="id1">Partner und watch_tim</a><ul>
<li><a class="reference internal" href="#partnerattribute" id="id2">Partnerattribute</a></li>
<li><a class="reference internal" href="#anrede" id="id3">Anrede</a></li>
<li><a class="reference internal" href="#die-inss" id="id4">Die INSS</a></li>
<li><a class="reference internal" href="#bearbeitungszustand" id="id5">Bearbeitungszustand</a></li>
<li><a class="reference internal" href="#veraltete-partner" id="id6">Veraltete Partner</a></li>
<li><a class="reference internal" href="#sonstiges" id="id7">Sonstiges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#begleitungen" id="id8">Begleitungen</a><ul>
<li><a class="reference internal" href="#primare-begleitung" id="id9">Primäre Begleitung</a></li>
<li><a class="reference internal" href="#begleitungsdienst" id="id10">Begleitungsdienst</a></li>
<li><a class="reference internal" href="#regeln" id="id11">Regeln</a></li>
</ul>
</li>
<li><a class="reference internal" href="#krankenkassen-und-apotheken-klientenkontakte" id="id12">Krankenkassen und Apotheken (Klientenkontakte)</a></li>
<li><a class="reference internal" href="#technisches" id="id13">Technisches</a><ul>
<li><a class="reference internal" href="#cannot-create-client-0000023756-from-pxs" id="id14">Cannot create Client 0000023756 from PXS</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="partner-und-watch-tim">
<h2><a class="toc-backref" href="#id1">Partner und watch_tim</a><a class="headerlink" href="#partner-und-watch-tim" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sowohl in TIM als auch in Lino gibt es eine Tabelle der <strong>Partner</strong>.
Die Partnernummer ist die Gleiche in TIM wie in Lino.
Im Hintergrund läuft ständig ein Programm namens <cite>watch_tim</cite>,
das alle Änderungen in TIM automatisch nach Lino synchronisiert.</p>
<p>Partner mit einer Nummer zwischen 200000 und 299999
sind <strong>in Lino erstellt</strong> worden und existieren also nicht in TIM.
Alle anderen Partner sind <strong>importierte</strong> Partner, und die haben
die meisten Datenfelder in Lino schreibgeschützt.</p>
<p>Lino <em>unterteilt</em> Partner etwas anders als TIM.</p>
<p>TIM unterscheidet vier &#8220;Partnerarten&#8221;:</p>
<ul class="simple">
<li>S Sozialhilfeempfänger</li>
<li>A APH-Bewohner</li>
<li>V Verschiedene</li>
<li>I Inaktive Partner</li>
</ul>
<p>Bei der Synchronisierung wird nach folgenden Regeln entschieden, wer wo hin kommt:</p>
<ul class="simple">
<li>Wenn mindestens eines der Felder
<cite>PAR-&gt;NB2</cite> (INSS) oder <cite>PAR-&gt;NB1</cite> (Gesdos-Nr)
unleer ist, oder wenn <em>Partnerattribut N (Neuzugang)</em>
gesetzt ist, dann wird es ein
<a class="reference internal" href="clients.html#welfare-pcsw-client"><em>Klient</em></a>.
Wobei zu beachten ist, dass <cite>PAR-&gt;NB2</cite> (INSS) als leer gilt, wenn es
nur eine  Null (&#8220;0&#8221;)  enthält.
Ausnahme:
Wenn <cite>PAR-&gt;NoTva</cite> unleer ist und <cite>PAR-&gt;NB2</cite> (INSS) leer,
dann wird es <em>trotzdem kein</em> Klient
(sondern eine Organisation, s.h. nächster Punkt).</li>
<li><strong>Ansonsten</strong>, wenn <cite>PAR-&gt;NoTva</cite> unleer ist, wird es eine
<a class="reference internal" href="contacts.html#welfare-contacts-company"><em>Organisation</em></a>.</li>
<li><strong>Ansonsten</strong>, wenn <cite>PAR-&gt;Allo</cite> (Anrede) einen der Werte &#8220;Eheleute&#8221;,
&#8220;Herr und Frau&#8221; enthält, dann wird es ein
<a class="reference internal" href="contacts.html#welfare-households-household"><em>Haushalt</em></a></li>
<li>Ansonsten wird es eine <a class="reference internal" href="contacts.html#welfare-contacts-person"><em>Person</em></a>.</li>
</ul>
<p>Zusatzregel:</p>
<ul class="simple">
<li>um Klient oder Person werden zu können, muss ein Partner außerdem
auch einen <em>Vornamen</em> haben, d.h. <cite>PAR-&gt;Firme</cite> muss mindestens ein
Leerzeichen enthalten.
Hat er das nicht, wird er zum einfachen
<a class="reference internal" href="contacts.html#welfare-contacts-partner"><em>Partner</em></a>,
und eventuelle Information in <cite>PAR-&gt;NB1</cite> oder <cite>PAR-&gt;NB2</cite>
werden ignoriert.</li>
</ul>
<p>Ob eine <a class="reference internal" href="contacts.html#welfare-contacts-company"><em>Organisation</em></a> auch
<a class="reference internal" href="courses.html#welfare-courses-courseprovider"><em>Kursanbieter</em></a>
und/oder
<a class="reference internal" href="jobs.html#welfare-jobs-jobprovider"><em>Stellenabieter</em></a>
ist, wird lediglich in Lino
(durch Ankreuzen des antsprechenden Feldes im Detail-Fenster) entschieden.
TIM kennt diese Information nicht.</p>
<div class="section" id="partnerattribute">
<h3><a class="toc-backref" href="#id2">Partnerattribute</a><a class="headerlink" href="#partnerattribute" title="Lien permanent vers ce titre">¶</a></h3>
<p>Hier eine Liste der möglichen Partnerattribute in TIM, und was Lino daraus macht.</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="45%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attrib</th>
<th class="head">Bezeichnung in TIM</th>
<th class="head">in Lino</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>H</td>
<td>Versteckt</td>
<td>wird ignoriert</td>
</tr>
<tr class="row-odd"><td>W</td>
<td>Warnung bei Auswahl</td>
<td><cite>veraltet</cite> im Reiter <cite>Sonstiges</cite></td>
</tr>
<tr class="row-even"><td>R</td>
<td>Schreibgeschützt</td>
<td>wird ignoriert</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>als Nebenpartner ignorieren</td>
<td>wird ignoriert</td>
</tr>
<tr class="row-even"><td>A</td>
<td>Altfall (automatisch)</td>
<td>wird ignoriert</td>
</tr>
<tr class="row-odd"><td>E</td>
<td>Eingeschlafener Debitor (automatisch)</td>
<td>wird ignoriert</td>
</tr>
<tr class="row-even"><td>N</td>
<td>Neuzugang</td>
<td>Klient im Bearbeitungszustand &#8220;Neuantrag&#8221;</td>
</tr>
</tbody>
</table>
<p><strong>Partnerattribut W</strong> bewirkt in Lino das Gleiche
wie <strong>Partnerart &#8220;Inaktive&#8221;</strong>, nämlich dass dieser Partner
das Feld <cite>veraltet</cite> angekreuzt kriegt.</p>
<p>Das <strong>Partnerattribut A</strong> (Altfall) aus TIM ist eine rein buchhalterische
Information (Partner hat seit dd.mm.yyyy keine buchhalterische Bewegung gehabt),
die momentan in Lino nicht importiert wird.
Falls sie mal in Lino sichtbar werden soll,
sollte sie als ein eigenes schreibgeschütztes Ankreuzfeld da stehen.</p>
<p>Hier einige mögliche Überraschungseffekte</p>
<ul class="simple">
<li>Ein existierender Klient kann in Lino verschwunden scheinen,
weil er versehentlich als veraltet  markiert wurde
(siehe <a class="reference internal" href="#veraltete-partner">Veraltete Partner</a>).
(siehe <a class="reference internal" href="#partnerattribute">Partnerattribute</a>).
Also nachprüfen, ob er in TIM das <strong>Partnerattribut W</strong> gesetzt hat.
Oder gar unter Partnerart &#8220;Inaktive&#8221; steht.</li>
<li>&#8220;Ich sehe in &#8220;meiner&#8221; Liste in Lino einen bestimmten aus TIM importierten
Klienten, den ich schon seit Langem nicht mehr begleite.&#8221;
&#8211;&gt; Um einen aus TIM importierten Klienten
nicht mehr &#8220;in meiner Liste&#8221; zu sehen, muss in TIM entweder
das Feld <cite>PAR-&gt;IdUser</cite> geändert,
die Partnerart auf Inaktiv gesetzt
oder das Partnerattribut W eingeschaltet werden.</li>
</ul>
</div>
<div class="section" id="anrede">
<h3><a class="toc-backref" href="#id3">Anrede</a><a class="headerlink" href="#anrede" title="Lien permanent vers ce titre">¶</a></h3>
<p><cite>PAR-&gt;Allo</cite> geht nach <tt class="xref py py-attr docutils literal"><span class="pre">Person.title</span></tt> oder <tt class="xref py py-attr docutils literal"><span class="pre">Company.prefix</span></tt>.
Außer wenn <cite>PAR-&gt;Allo</cite> es einen der Werte &#8220;Eheleute&#8221;,
&#8220;Herr und Frau&#8221; enthält, dann wird es ein Haushalt.</p>
<p><cite>PAR-&gt;Name2</cite> wird ins Feld &#8220;Adresszeile vor Straße&#8221; importiert.</p>
</div>
<div class="section" id="die-inss">
<h3><a class="toc-backref" href="#id4">Die INSS</a><a class="headerlink" href="#die-inss" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li>Es kann Klienten ohne INSS geben.
Die sind dann allerdings &#8220;inoffiziell&#8221; bzw. &#8220;nicht integriert&#8221; bzw. &#8220;ohne Akte beim Ministerium&#8221;.
In TIM haben diese Klienten entweder eine leere INSS oder eine 0 dort stehen.
Die 0 wird als &#8220;leer&#8221; übertragen, denn
in Lino kann es nicht zwei Klienten mit der gleichen INSS geben.</li>
<li>Lino lässt auch ungültige INSS zu.</li>
<li>Ein &#8220;Numéro bis&#8221; ist eine provisorische INSS,
die z.B. auch 680000 formatiert ist.
So eine Bis-Nummer kann also dann auch irgendwann mal ändern.</li>
</ul>
</div>
<div class="section" id="bearbeitungszustand">
<h3><a class="toc-backref" href="#id5">Bearbeitungszustand</a><a class="headerlink" href="#bearbeitungszustand" title="Lien permanent vers ce titre">¶</a></h3>
<p>Der Bearbeitungszustand eines Klienten kann sein:</p>
<ul>
<li><p class="first"><strong>Neuantrag</strong> :
Die Person hat Antrag auf Begleitung gestellt.
Antrag wird überprüft und der Klient muss einem Sachbearbeiter
oder Sozi zugewiesen werden.</p>
<p>Im Detail-Reiter
<tt class="xref std std-screen docutils literal"><span class="pre">Neuanträge</span></tt>
kann man einem Neuzugang
einen <strong>Begleiter zuweisen</strong>, wodurch der Klient ins Stadium &#8220;Begleitet&#8221; wechelt.</p>
</li>
<li><p class="first"><strong>Abgelehnt</strong> :
Die Prüfung des Antrags hat ergeben, dass diese Person kein Anrecht
auf Begleitung durch unser ÖSHZ hat.</p>
</li>
<li><p class="first"><strong>Begleitet</strong> :
Es gibt im ÖSHZ mindestens eine Person, die &#8220;sich um die Person kümmert&#8221;.
Damit ein Klient im Status &#8220;Begleitet&#8221; sein kann, muss mindestens
eine aktive Begleitung existieren.</p>
</li>
<li><p class="first"><strong>Ehemalig</strong> :
War mal begleitet, aber jetzt nicht mehr.
Es existieren Begleitungen, aber keine davon ist <em>aktiv</em>.
Falls es ein importierter Partner ist,
hatte er in TIM entweder das Attribut <cite>W (Warnung bei Auswahl)</cite>
oder die Partnerart <cite>I (Inaktive)</cite>.</p>
</li>
</ul>
<p class="graphviz">
<img src="_images/graphviz-da4a5a3c3ae9964aabca7358b1fa5f5008b8e707.png" alt="digraph foo {
   newcomer -&gt; refused [label=&quot;Neuantrag ablehnen&quot;];
   newcomer -&gt; coached [label=&quot;Begleiter zuweisen&quot;];
   refused -&gt; newcomer [label=&quot;Neuantrag wiederholen&quot;];
   coached -&gt; newcomer [label=&quot;Begleitung abbrechen&quot;];
   coached -&gt; former [label=&quot;Begleitung beenden&quot;];

   newcomer [label=&quot;Neuantrag&quot;];
   refused [label=&quot;Abgelehnt&quot;];
   former [label=&quot;Ehemalig&quot;];
   coached [label=&quot;Begleitet&quot;];
}" />
</p>
<p>Bemerkung:
Wie alle Partner haben auch Klienten (im Reiter &#8220;Sonstiges&#8221;)
ein Ankreuzfeld &#8220;veraltet&#8221;,
das unabhängig vom <a class="reference internal" href="#bearbeitungszustand">Bearbeitungszustand</a> existiert.
Siehe <a class="reference internal" href="#veraltete-partner">Veraltete Partner</a>.</p>
</div>
<div class="section" id="veraltete-partner">
<h3><a class="toc-backref" href="#id6">Veraltete Partner</a><a class="headerlink" href="#veraltete-partner" title="Lien permanent vers ce titre">¶</a></h3>
<p>Bei importierten Partnern ist
das Ankreuzfeld
<em class="xref std std-ref">veraltet</em>
schreibgeschützt.
Es ist eingeschaltet, wenn diese Person in TIM
entweder in <strong>Partnerart &#8220;Inaktive&#8221;</strong> steht oder
das <strong>Partnerattribut W</strong> eingeschaltet hat.</p>
</div>
<div class="section" id="sonstiges">
<h3><a class="toc-backref" href="#id7">Sonstiges</a><a class="headerlink" href="#sonstiges" title="Lien permanent vers ce titre">¶</a></h3>
<p>Im Reiter <em class="guilabel">Sonstiges</em> gibt es drei Ankreuzfelder</p>
<ul class="simple">
<li>Sozialhilfeempfänger (<cite>is_cpas</cite>) : Angekreuzt , wenn in TIM Partnerart S war.</li>
<li>Altenheim (<cite>is_senior</cite>) : Angekreuzt , wenn in TIM Partnerart A war.</li>
<li>veraltet (<cite>is_obsolete</cite>) : Angekreuzt , wenn in TIM Partneraattribut W gesetzt war.</li>
</ul>
</div>
</div>
<div class="section" id="begleitungen">
<h2><a class="toc-backref" href="#id8">Begleitungen</a><a class="headerlink" href="#begleitungen" title="Lien permanent vers ce titre">¶</a></h2>
<p>Eine <strong>Begleitung</strong> ist, wenn sich ein bestimmter Mitarbeiter des ÖSHZ
um einen bestimmten Klienten während einer bestimmten Periode
&#8220;kümmert&#8221;.
Ein Klient kann mehrere Begleitungen auf einmal haben,
z.B. eine im ASD und eine andere im DSBE.</p>
<p>Begleitungen werden entweder manuell erzeugt
durch <cite>Einfügen</cite> in der Tabelle &#8220;Begleitungen&#8221;,
oder indirekt durch das <strong>Zuweisen</strong> eines verfügbaren Begleiters.</p>
<p>Die Felder <strong>von</strong> und <strong>bis</strong> einer Begleitung definieren die <strong>Begleitungsperiode</strong>.
Das Feld <cite>von</cite> einer Begleitung kann nicht leer sein.
Ein leeres Feld <cite>bis</cite> einer Begleitung bedeutet, dass das Ende nicht bekannt ist.
Eine Begleitung ist (an einem gegebenen Datum <cite>heute</cite>) aktiv,
wenn <cite>von</cite> <strong>&lt;=</strong> <cite>heute</cite> und <cite>bis</cite> entweder leer oder <strong>&gt;=</strong> <cite>heute</cite> ist.</p>
<div class="section" id="primare-begleitung">
<h3><a class="toc-backref" href="#id9">Primäre Begleitung</a><a class="headerlink" href="#primare-begleitung" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lino kann pro Klient mehrere Begleitungen haben,
aber in TIM haben wir nur den &#8220;hauptverantwortlichen Sozialarbeiter&#8221; (<cite>PAR-&gt;IdUsr</cite>).
Deshalb gibt es das Konzept der <strong>primären</strong> Begleitung.
In Lino kann pro Klient eine Begleitung primär sein.
Diese entspricht dem Feld <cite>PAR-&gt;IdUsr</cite> aus TIM.</p>
<p>Für die primäre Begleitung eines <em>importierten</em> Klienten gilt:</p>
<ul>
<li><p class="first">Die Felder <cite>primär</cite>, <cite>bis</cite> und <cite>Benutzer</cite> sind schreibgeschützt und wie folgt belegt:</p>
<ul class="simple">
<li><cite>primär</cite> = angekreuzt</li>
<li><cite>Benutzer</cite> : der in TIM angegebene Benutzer</li>
<li><cite>bis</cite> : entweder leer (wenn es eine aktive Begleitung ist)
oder 01.01.1990 (wenn es ein Neuzugang oder ehemaliger Klient ist)</li>
</ul>
<p>Diese Angaben können also nur über TIM verändert werden.</p>
</li>
<li><p class="first">Die Felder <cite>von</cite> und <cite>Dienst</cite> dagegen können manuell geändert werden,
und <cite>watch_tim</cite> geht dann nicht mehr daran.
Beim ersten Erstellen gibt <cite>watch_tim</cite> ihnen folgende Werte:</p>
<ul class="simple">
<li><cite>Dienst</cite> = Begleitdienst des Begleiters zu diesem Zeitpunkt</li>
<li><cite>von</cite> = Erstelldatum des Partners in TIM</li>
</ul>
</li>
</ul>
<p>Also man kann auf importierten Klienten in Lino zusätzliche Begleitungen
erstellen, aber diese können nicht primär sein.
An diese sekundären Begleitungen geht <cite>watch_tim</cite> nicht ran.</p>
</div>
<div class="section" id="begleitungsdienst">
<span id="welfare-clients-coachingtype"></span><h3><a class="toc-backref" href="#id10">Begleitungsdienst</a><a class="headerlink" href="#begleitungsdienst" title="Lien permanent vers ce titre">¶</a></h3>
<p>Jede Begleitung findet zwingend im Rahmen eines bestimmten
<strong>Dienstes</strong> statt.
In der Demo-Datenbank gibt es folgende Begleitungsdienste:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="27%" />
<col width="46%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Description</td>
<td>Description (fr)</td>
<td>Description (de)</td>
</tr>
<tr class="row-even"><td>GSS (General Social Service)</td>
<td>SSG (Service social général)</td>
<td>ASD (Allgemeiner Sozialdienst)</td>
</tr>
<tr class="row-odd"><td>Integration service</td>
<td>Service intégration</td>
<td>DSBE (Dienst für Sozial-Berufliche Eingliederung)</td>
</tr>
<tr class="row-even"><td>Debts mediation</td>
<td>Médiation de dettes</td>
<td>Schuldnerberatung</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="regeln">
<h3><a class="toc-backref" href="#id11">Regeln</a><a class="headerlink" href="#regeln" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li>Ein Neuantrag kann keine Begleitungen haben.
(Ein Klient mit Begleitungen, selbst abgeschlossene,
kann nicht wieder zum Neuantrag werden.
Höchstens zu einem Ehemaligen.)</li>
<li>Wenn ein Klient ins Stadium Ehemalig wechselt, werden automatisch
alle laufenden Begleitungen beendet.
Ein Ehemaliger kann keine <em>laufenden</em> Begleitungen haben.</li>
<li>Nur Benutzer mit einem unleeren Feld
<cite>Begleitungsart (Dienst)</cite> in den Benutzereinstellungen
dürfen manuell Begleitungen erstellen.</li>
<li>Importierte Klienten haben eine importierte primäre
Begleitung, die nicht geändert werden kann.</li>
</ul>
</div>
</div>
<div class="section" id="krankenkassen-und-apotheken-klientenkontakte">
<h2><a class="toc-backref" href="#id12">Krankenkassen und Apotheken (Klientenkontakte)</a><a class="headerlink" href="#krankenkassen-und-apotheken-klientenkontakte" title="Lien permanent vers ce titre">¶</a></h2>
<p>Die Felder PXS-&gt;IdMut (Krankenkasse) und PXS-&gt;Apotheke (Apotheke)
werden nach Lino synchronisiert als <a class="reference internal" href="clients.html#welfare-pcsw-clientcontact"><em>Klientenkontakte</em></a>.</p>
<p><em>Importierte</em> Klienten sollten in ihren
<a class="reference internal" href="clients.html#welfare-pcsw-clientcontact"><em>Klientenkontakten</em></a>
deshalb maximal <em>eine</em> Krankenkasse und <em>eine</em> Apotheke haben.
Sonst findet <cite>watch_tim</cite>, dass er nicht dafür
zuständig ist und synchronisiert nichts
(schreibt lediglich eine Warnung in die <cite>system.log</cite>)</p>
<p>Alle anderen Klientenkontaktarten sind egal,
davon dürfen auch importierte Klienten so viele haben wie sie wollen.</p>
<p>Apotheken sind in TIM normale Partner, aber
Krankenkassen sind Adressen aus <cite>ADR</cite> mit <cite>ADR-&gt;Type == &#8216;MUT&#8217;</cite>.
Sie erscheinen in Lino als Organisation,
werden aber nicht mehr automatisch synchronisiert.
Also falls des eine in TIM erstellt wird, muss die entsprechende
Organisation in Lino manuell erstellt werden.
Dabei ist zu beachten, dass das <cite>id</cite> einer Krankenasse
beim ersten Import (<cite>initdb_tim</cite>)
wie folgt ermittelt wurde:</p>
<blockquote>
<div>id = val(ADR-&gt;IdMut) + 199000</div></blockquote>
<p>Beim Synchronisieren sind folgende Fehlermeldungen denkbar
(die falls sie auftreten per E-Mail an die Administratoren geschickt werden):</p>
<div class="highlight-python"><div class="highlight"><pre>ERROR Client #20475 (u&quot;MUSTERMANN Max (20475)&quot;) : Pharmacy or Health Insurance 199630 doesn&#39;t exist
ERROR Client #20475 (u&quot;MUSTERMANN Max (20475)&quot;) : Pharmacy or Health Insurance 0000086256 doesn&#39;t exist
</pre></div>
</div>
<p>Die erste Meldung bedeutet, dass die Krankenkasse fehlt (Nr. 199xxx sind Krankenkassen), also
dass man in TIM in der ADR.DBF die Nr 630 raussucht und diese manuell in Lino als Organisation
199630 anlegt.</p>
<p>Die zweite Meldung ist eine fehlende Apotheke. Da reicht es, in TIM mal auf diese
Apotheke 86256 zu gehen und irgendwas zu ändern,
um manuell eine Synchronisierung auszulösen.
Kann auch sein, dass es in TIM keinen Partner 86256 gibt
(TIM lässt es fälschlicherweise zu, Apotheken zu löschen die anderswo referenziert werden):
dann muss der Klient 20475 sein Feld PXS-&gt;Apotheke auf
leer gesetzt bekommen (oder auf eine andere existierende
Apotheke).</p>
</div>
<div class="section" id="technisches">
<h2><a class="toc-backref" href="#id13">Technisches</a><a class="headerlink" href="#technisches" title="Lien permanent vers ce titre">¶</a></h2>
<p>In der <a class="reference external" href="http://docs.lino-framework.org/ref/files.html#xfile-settings.py" title="(disponible dans Lino v1.6)"><tt class="xref std std-xfile docutils literal"><span class="pre">settings.py</span></tt></a> gibt es folgende Optionen,
die für die Synchronisierung von Belang sind:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">is_imported_partner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="c">#if obj.id == 3999:</span>
    <span class="c">#    return False</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">200000</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">299999</span>



<span class="k">def</span> <span class="nf">TIM2LINO_LOCAL</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hook for local special treatment on instances</span>
<span class="sd">    that have been imported from TIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span>

<span class="k">def</span> <span class="nf">TIM2LINO_USERNAME</span><span class="p">(</span><span class="n">userid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">userid</span> <span class="o">==</span> <span class="s">&quot;WRITE&quot;</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">userid</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="cannot-create-client-0000023756-from-pxs">
<h3><a class="toc-backref" href="#id14">Cannot create Client 0000023756 from PXS</a><a class="headerlink" href="#cannot-create-client-0000023756-from-pxs" title="Lien permanent vers ce titre">¶</a></h3>
<p>Die Meldung kommt, wenn in TIM in der PXS eines Partners etwas
verändert wurde, und dieser Partner in Lino nicht existiert
(was anormal ist, aber z.B. durch frühere Bugs oder Pannen kommen kann).
Zu tun: manuell für diesen Partner in der PAR etwas verändern, um
eine Synchronisierung zu triggern.</p>
</div>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/lino-logo-2.png" alt="Logo"/>
            </a></p><p align="center">
  <a href="../watch_tim.html">EN</a>
  FR
  <a href="../de/watch_tim.html">DE</a>
  <a href="../nl/watch_tim.html">NL</a> 
</p>
<h3><a href="index.html">Table des Matières</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="whitepaper.html">Lino Welfare &#8211; Fiche technique</a></li>
<li class="toctree-l1"><a class="reference internal" href="screenshots/index.html">Screenshots</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tour.html">Tour of Lino Welfare</a></li>
<li class="toctree-l1"><a class="reference internal" href="general.html">Concepts généraux</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">watch_tim</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="users.html">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="countries.html">Countries</a></li>
<li class="toctree-l1"><a class="reference internal" href="contacts.html">Contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="cal.html">Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="clients.html">Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="beid.html">Read eID cards</a></li>
<li class="toctree-l1"><a class="reference internal" href="aids.html">Aids</a></li>
<li class="toctree-l1"><a class="reference internal" href="newcomers.html">New clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="cbss.html">Banque-carrefour</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv.html">Curriculum vitae</a></li>
<li class="toctree-l1"><a class="reference internal" href="courses.html">Cours de langues</a></li>
<li class="toctree-l1"><a class="reference internal" href="integ.html">Integration service</a></li>
<li class="toctree-l1"><a class="reference internal" href="isip.html">ISIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Insertion socio-professionnelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="debts.html">Médiation de dettes</a></li>
<li class="toctree-l1"><a class="reference internal" href="accounts.html">Comptes</a></li>
<li class="toctree-l1"><a class="reference internal" href="reception.html">Reception</a></li>
<li class="toctree-l1"><a class="reference internal" href="system.html">System</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><p align="center">
<a href="http://code.google.com/p/lino-welfare/" target="_blank">code</a>
<a href="http://pypi.python.org/pypi/lino-welfare" target="_blank">pypi</a>
<br/>
user |
<a href="http://welfare.lino-framework.org" target="_blank">technical</a>


</p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="users.html" title="Users"
             >suivant</a> |</li>
        <li class="right" >
          <a href="general.html" title="Concepts généraux"
             >précédent</a> |</li>
        <li><a href="index.html">documentation Lino-Welfare User Documentation 1.1.11</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2013, Luc Saffre.
      Last updated on Mar 04, 2014.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3a0.    
    <a href="http://code.google.com/p/lino-welfare/source/browse/userdocs/watch_tim.rst"
           rel="nofollow">Show Source</a>.
    <a href="http://welfare-user.lino-framework.org/watch_tim.html">Online Link</a>.
    </div>
  </body>
</html>