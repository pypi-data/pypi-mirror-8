import pybedtools
from pybedtools.parallel import parallel_apply

a = pybedtools.example_bedtool('a.bed')
b = pybedtools.example_bedtool('b.bed')
method = 'intersect'
method_kwargs = dict(b=b, u=True)
def reduce_func(x):
    return sum(1 for _ in open(x.fn))

genome = dict(chr1=(0, 1000))
results = parallel_apply(
    a,
    method,
    genome=genome,
    method_kwargs=method_kwargs,
    iterations=10000,
    processes=8,
    reduce_func=reduce_func,
    report_iterations=True)

results = list(results)
