<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" i18n:domain="ztfy.skin">
<head>
	<tal:var replace="fanstatic:ztfy.skin#ztfy_skin_css" />
	<tal:var replace="fanstatic:ztfy.jqueryui#jquery_progressbar" />
	<script type="text/javascript">

		function updateUploadProgress(uuid) {

			var i = setInterval(function() { 
				$.ajax({
					url: "/progress?X-Progress-ID=" + uuid,
					dataType: 'json',
					success: function(data) {
						if ((data == null) || (data.state == 'done')) {
							clearInterval(i);
						} else if (data.state == 'uploading') {
							var percentage = Math.floor(100 * parseInt(data.received) / parseInt(data.size));
							$("#uploadprogressbar").progressBar(percentage);
						}
					},
					error: function() {
						clearInterval(i);
					}
				});
			}, 1000);
		}

	</script>
</head>
<body class="progressbar">
	<div id="uploadprogressbar" class="progressbar"></div>
</body>
</html>