1 PRINT:PRINT "TEST FLOATS IN FPA0 V0.1"
2 PRINT "(GPL V3 OR ABOVE)"
3 PRINT:PRINT "COPYLEFT (C) 2014 JENS DIEMER":PRINT
11 COUNT=13
20 LA=&H4000			' LOAD / EXECUTE ADDRESS
25 PRINT "POKE MACHINE CODE TO: $";HEX$(LA)
30 PA = LA			' START ADDRESS FOR POKE
50 READ HB$			' HEX CONSTANTS
60 IF HB$="END" THEN 100
65 V=VAL("&H"+HB$)
70 POKE PA,V	                ' POKE VALUE INTO MEMORY
75 'PRINT "POKE $";HEX$(V);" AT $";HEX$(PA)
80 PA = PA + 1			' INCREMENT POKE ADDRESS
90 GOTO 50
100 PRINT "LOADED, END ADDRESS IS: $"; HEX$(PA-1)
110 PRINT:INPUT "INPUT START VALUE (DEZ)";D$
115 IF D$="" THEN 20000 ELSE D=VAL(D$)
130 GOTO 500
140 PRINT "UP/DOWN OR ANYKEY FOR NEW VALUE";
150 I$ = INKEY$:IF I$="" THEN 150
160 IF I$=CHR$(&H5E) THEN D=D2-(COUNT*2) : GOTO 500 ' UP KEYPRESS
170 IF I$=CHR$(&H0A) THEN D=D2 : GOTO 500 ' DOWN KEYPRESS
180 GOTO 110 ' NOT UP/DOWN
500 CLS:PRINT "D=";D
550 FOR I = 0 TO COUNT
551 D2=(D+I) 'AND &HFFFF
552 'PRINT "SET D=";D2
553 POKE &H4500,D2 ' SET START VALUE
554 'PRINT "EXEC MACHINE CODE"
560 EXEC LA
565 'PRINT "GET VALUES FROM FPA0"
570 EX  =PEEK(&H004F) ' FPA0 EXPONENT
580 MP  =PEEK(&H0050) ' FPA0 MS
580 NMS =PEEK(&H0051) ' FPA0 NMS
580 NLS =PEEK(&H0052) ' FPA0 NLS
580 LS  =PEEK(&H0053) ' FPA0 LS
580 SIGN=PEEK(&H0054) ' FPA0 SIGN
690 PRINT "D=";RIGHT$("  "+STR$(D2),4);" FPA0=$"+HEX$(EX)+" $"+HEX$(MS)+" $"+HEX$(NMS)+" $"+HEX$(NLS)+" $"+HEX$(LS)+" $"+HEX$(SIGN)
700 NEXT I
710 GOTO 140
1000 ' MACHINE CODE IN HEX
1010 ' LDD $4500
1020 DATA FC,45,00
1030 ' JSR $8C37 ; ADD D TO FPA0
1050 DATA BD,8C,37
10000 ' RTS
10010 DATA 39
10020 DATA END
20000 PRINT:PRINT "BYE"
