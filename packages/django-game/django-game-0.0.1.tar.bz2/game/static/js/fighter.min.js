var area=null;var fighter=null;var enemy=null;var bulletNumber=1;var fighterGameOver=true;var fighterSpeed=1;var fighterOffset=1;var enemySpeed;var defaultEnemySpeed=50;var lockBullet=false;var fighterScore=0;var explosion=false;function removeAt(b,c){if(c>-1){b.splice(c,1)}}function normalizeY(d){var b=new Array();for(var c=0;c<d.pixelsY.length;c++){b.push(d.pixelsY[c]+d.y)}return b}function normalizeX(e,b){var c=new Array();for(var d=0;d<e.length;d++){c.push(e[d]+b)}return c}function collide(h,g){var r=new Array();var q=normalizeY(h);var p=normalizeY(g);var m=new Array();for(var l=0;l<q.length;l++){for(var k=0;k<p.length;k++){if(q[l]==p[k]){r.push(l);m.push(k)}}}for(var l=0;l<r.length;l++){var o=normalizeX(h.pixels[r[l]],h.x);var n=normalizeX(g.pixels[m[l]],g.x);for(var k=0;k<o.length;k++){if($.inArray(o[k],n)!=-1){return true}}}return false}function Bullet(b,a,g,c){this.PIXEL_COUNT=10;this.bulletInterval=null;this.init=f;this.fire=e;this.destroy=d;this.color=b;this.x=a;this.y=g;this.isEnemy=c;this.id="bullet-"+bulletNumber;this.width=10;this.height=10;this.init();function f(){this.pixels=new Array();this.pixelsY=new Array();for(var h=0;h<10;h++){this.pixelsY.push(h+1);this.pixels.push(new Array(1,2,3,4,5,6,7,8,9,10))}}function e(){var k="top: "+this.y+"px; left: "+this.x+"px;";if(this.color!=null){k+=" background-color: "+this.color+";"}var j=this.isEnemy?"bullet-enemy":"bullet-fighter";area.append('<div id="'+this.id+'" class="bullet '+j+'" style="'+k+'"></div>');var l=this.isEnemy?area.height()-10:10;var i=this.isEnemy?fighter:enemy;var h=this;$("#"+this.id).animate({top:l+"px"},{duration:3000,easing:"linear",step:function(n,q){if($("#"+h.id).length>0){var u=$("#"+h.id).position();var w=u.top;var o=u.left;w=parseInt(w);h.x=o;h.y=w;if(h.isEnemy){for(var s=0;s<fighter.bullets.length;s++){if(collide(h,fighter.bullets[s])){area.append('<div class="bubble bullet-bubble" style="top: '+h.y+"px; left: "+h.x+'px;">+ 500</div>');$(".bullet-bubble").fadeOut({duration:3000});fighterScore+=500;increaseSpeed();$("#fighter-score").html("Score: "+fighterScore);h.destroy();fighter.bullets[s].destroy();var m=$.inArray(h,enemy.bullets);removeAt(enemy.bullets,m);var t=$.inArray(fighter.bullets[s],fighter.bullets);removeAt(fighter.bullets,t)}}}var r=h.isEnemy?h:i;var p=h.isEnemy?i:h;if(collide(r,p)){var v=$.inArray(h,i.bullets);removeAt(i.bullets,v);$("#"+h.id).remove();if(!i.isEnemy){endFighter()}else{fighterScore+=200;increaseSpeed();area.append('<div class="bubble plane-bubble" style="top: '+i.y+"px; left: "+i.x+'px;">+ 200</div>');$(".plane-bubble").fadeOut({duration:3000});$("#fighter-score").html("Score: "+fighterScore);newEnemy()}}}},complete:function(){$("#"+h.id).remove()}});bulletNumber++}function d(){$("#"+this.id).remove()}}function Mirage(d){this.PIXEL_COUNT=224;this.isEnemy=d;this.init=o;this.reverse=i;this.appear=a;this.dissappear=g;this.destroy=l;this.fire=b;this.inBoundsTop=j;this.inBoundsLeft=e;this.inBoundsBottom=p;this.inBoundsRight=c;this.up=h;this.left=f;this.down=n;this.right=m;this.clearMirageInterval=k;this.mirageInterval=null;this.width=101;this.height=180;this.img="mirage.png";this.cls="mirage";this.bullets=new Array();this.init();this.x=Math.floor((Math.random()*(area.width()-this.width*2))+1);this.y=area.height()-this.height;if(this.isEnemy){this.pixels=this.reverse();this.y=0;this.img="enemy.png";this.cls="enemy"}area.append('<img class="'+this.cls+'" style="top: '+this.y+"px; left: "+this.x+'px;" src="/static/img/'+this.img+'" />');this.appear();function a(){var q=this;$("."+q.cls).animate({opacity:1},{duration:2000,complete:function(){if(q.isEnemy){q.fire();q.clearMirageInterval();q.mirageInterval=setInterval("enemy.down()",enemySpeed)}}})}function g(){var q=this;$("."+this.cls).animate({opacity:0},{duration:2000,complete:function(){q.destroy();if(!fighterGameOver){enemy=new Mirage(true)}}})}function b(){var w=this.x+4;var v=this.y+53;var u=this.x+88;var t=this.y+53;var s="red";if(!this.isEnemy){s=null;w=this.x+4;v=this.y+118;u=this.x+88;t=this.y+118}var r=new Bullet(s,w,v,this.isEnemy);this.bullets.push(r);r.fire();var q=new Bullet(s,u,t,this.isEnemy);this.bullets.push(q);q.fire()}function o(){this.pixels=new Array(this.PIXEL_COUNT);this.pixelsY=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,176,177,178,178,178,179,180];this.pixels[0]=new Array(51,51);this.pixels[1]=new Array(51,51);this.pixels[2]=new Array(51,51);this.pixels[3]=new Array(51,51);this.pixels[4]=new Array(51,51);this.pixels[5]=new Array(51,51);this.pixels[6]=new Array(51,51);this.pixels[7]=new Array(51,51);this.pixels[8]=new Array(51,51);this.pixels[9]=new Array(51,51);this.pixels[10]=new Array(51,51);this.pixels[11]=new Array(51,51);this.pixels[12]=new Array(51,51);this.pixels[13]=new Array(51,51);this.pixels[14]=new Array(49,52);this.pixels[15]=new Array(50,53);this.pixels[16]=new Array(49,53);this.pixels[17]=new Array(48,54);this.pixels[18]=new Array(47,55);this.pixels[19]=new Array(47,55);this.pixels[20]=new Array(47,55);this.pixels[21]=new Array(47,55);this.pixels[22]=new Array(47,55);this.pixels[23]=new Array(47,55);this.pixels[24]=new Array(47,55);this.pixels[25]=new Array(47,55);this.pixels[26]=new Array(47,55);this.pixels[27]=new Array(47,55);this.pixels[28]=new Array(47,55);this.pixels[29]=new Array(46,56);this.pixels[30]=new Array(46,56);this.pixels[31]=new Array(46,56);this.pixels[32]=new Array(46,56);this.pixels[33]=new Array(46,56);this.pixels[34]=new Array(46,56);this.pixels[35]=new Array(46,56);this.pixels[36]=new Array(46,56);this.pixels[37]=new Array(46,56);this.pixels[38]=new Array(46,56);this.pixels[39]=new Array(46,56);this.pixels[40]=new Array(46,56);this.pixels[41]=new Array(46,56);this.pixels[42]=new Array(46,56);this.pixels[43]=new Array(46,56);this.pixels[44]=new Array(46,56);this.pixels[45]=new Array(46,56);this.pixels[46]=new Array(46,56);this.pixels[47]=new Array(46,56);this.pixels[48]=new Array(46,56);this.pixels[49]=new Array(46,56);this.pixels[50]=new Array(46,56);this.pixels[51]=new Array(46,56);this.pixels[52]=new Array(46,56);this.pixels[53]=new Array(46,56);this.pixels[54]=new Array(45,57);this.pixels[55]=new Array(45,57);this.pixels[56]=new Array(44,58);this.pixels[57]=new Array(44,58);this.pixels[58]=new Array(43,59);this.pixels[59]=new Array(43,59);this.pixels[60]=new Array(42,60);this.pixels[61]=new Array(42,60);this.pixels[62]=new Array(42,60);this.pixels[63]=new Array(42,60);this.pixels[64]=new Array(42,60);this.pixels[65]=new Array(42,60);this.pixels[66]=new Array(42,60);this.pixels[67]=new Array(42,60);this.pixels[68]=new Array(42,60);this.pixels[69]=new Array(42,60);this.pixels[70]=new Array(42,60);this.pixels[71]=new Array(42,60);this.pixels[72]=new Array(42,60);this.pixels[73]=new Array(42,60);this.pixels[74]=new Array(42,60);this.pixels[75]=new Array(42,60);this.pixels[76]=new Array(42,60);this.pixels[77]=new Array(41,61);this.pixels[78]=new Array(41,61);this.pixels[79]=new Array(41,61);this.pixels[80]=new Array(40,62);this.pixels[81]=new Array(40,62);this.pixels[82]=new Array(39,63);this.pixels[83]=new Array(38,64);this.pixels[84]=new Array(38,64);this.pixels[85]=new Array(38,64);this.pixels[86]=new Array(38,64);this.pixels[87]=new Array(38,64);this.pixels[88]=new Array(37,65);this.pixels[89]=new Array(36,66);this.pixels[90]=new Array(36,66);this.pixels[91]=new Array(35,67);this.pixels[92]=new Array(35,67);this.pixels[93]=new Array(34,68);this.pixels[94]=new Array(34,68);this.pixels[95]=new Array(33,69);this.pixels[96]=new Array(33,69);this.pixels[97]=new Array(32,70);this.pixels[98]=new Array(31,71);this.pixels[99]=new Array(31,71);this.pixels[100]=new Array(30,72);this.pixels[101]=new Array(30,72);this.pixels[102]=new Array(29,73);this.pixels[103]=new Array(29,73);this.pixels[104]=new Array(28,74);this.pixels[105]=new Array(28,74);this.pixels[106]=new Array(27,75);this.pixels[107]=new Array(26,76);this.pixels[108]=new Array(26,76);this.pixels[109]=new Array(25,77);this.pixels[110]=new Array(25,77);this.pixels[111]=new Array(24,78);this.pixels[112]=new Array(24,78);this.pixels[113]=new Array(23,79);this.pixels[114]=new Array(23,79);this.pixels[115]=new Array(22,80);this.pixels[116]=new Array(21,81);this.pixels[117]=new Array(21,81);this.pixels[118]=new Array(20,82);this.pixels[119]=new Array(20,82);this.pixels[120]=new Array(19,83);this.pixels[121]=new Array(19,83);this.pixels[122]=new Array(18,84);this.pixels[123]=new Array(18,84);this.pixels[124]=new Array(17,85);this.pixels[125]=new Array(17,85);this.pixels[126]=new Array(16,86);this.pixels[127]=new Array(15,87);this.pixels[128]=new Array(14,88);this.pixels[129]=new Array(13,89);this.pixels[130]=new Array(13,89);this.pixels[131]=new Array(13,89);this.pixels[132]=new Array(13,89);this.pixels[133]=new Array(13,89);this.pixels[134]=new Array(12,90);this.pixels[135]=new Array(12,90);this.pixels[136]=new Array(11,91);this.pixels[137]=new Array(10,92);this.pixels[138]=new Array(10,92);this.pixels[139]=new Array(9,93);this.pixels[140]=new Array(9,93);this.pixels[141]=new Array(8,94);this.pixels[142]=new Array(8,94);this.pixels[143]=new Array(7,95);this.pixels[144]=new Array(7,95);this.pixels[145]=new Array(6,96);this.pixels[146]=new Array(5,97);this.pixels[147]=new Array(5,97);this.pixels[148]=new Array(4,98);this.pixels[149]=new Array(4,98);this.pixels[150]=new Array(3,99);this.pixels[151]=new Array(3,99);this.pixels[152]=new Array(2,100);this.pixels[153]=new Array(2,100);this.pixels[154]=new Array(1,101);this.pixels[155]=new Array(1,101);this.pixels[156]=new Array(1,101);this.pixels[157]=new Array(2,100);this.pixels[158]=new Array(3,99);this.pixels[159]=new Array(4,98);this.pixels[160]=new Array(5,97);this.pixels[161]=new Array(6,96);this.pixels[162]=new Array(7,95);this.pixels[163]=new Array(8,94);this.pixels[164]=new Array(9,93);this.pixels[165]=new Array(10,92);this.pixels[166]=new Array(11,91);this.pixels[167]=new Array(12,90);this.pixels[168]=new Array(13,89);this.pixels[169]=new Array(14,88);this.pixels[170]=new Array(15,87);this.pixels[171]=new Array(16,86);this.pixels[172]=new Array(17,85);this.pixels[173]=new Array(18,84);this.pixels[174]=new Array(19,83);this.pixels[175]=new Array(20,82);this.pixels[176]=new Array(21,81);this.pixels[177]=new Array(22,80);this.pixels[178]=new Array(23,79);this.pixels[179]=new Array(24,78);this.pixels[180]=new Array(25,77);this.pixels[181]=new Array(26,76);this.pixels[182]=new Array(27,75);this.pixels[183]=new Array(28,74);this.pixels[184]=new Array(29,73);this.pixels[185]=new Array(30,72);this.pixels[186]=new Array(31,71);this.pixels[187]=new Array(32,70);this.pixels[188]=new Array(33,69);this.pixels[189]=new Array(34,68);this.pixels[190]=new Array(35,67);this.pixels[191]=new Array(36,66);this.pixels[192]=new Array(37,65);this.pixels[193]=new Array(38,64);this.pixels[194]=new Array(39,63);this.pixels[195]=new Array(40,62);this.pixels[196]=new Array(41,61);this.pixels[197]=new Array(42,60);this.pixels[198]=new Array(43,59);this.pixels[199]=new Array(43,59);this.pixels[200]=new Array(43,59);this.pixels[201]=new Array(43,59);this.pixels[202]=new Array(43,59);this.pixels[203]=new Array(43,59);this.pixels[204]=new Array(43,59);this.pixels[205]=new Array(44,58);this.pixels[206]=new Array(44,58);this.pixels[207]=new Array(45,57);this.pixels[208]=new Array(45,57);this.pixels[209]=new Array(45,57);this.pixels[210]=new Array(45,57);this.pixels[211]=new Array(45,57);this.pixels[212]=new Array(46,56);this.pixels[213]=new Array(46,56);this.pixels[214]=new Array(46,56);this.pixels[215]=new Array(46,56);this.pixels[216]=new Array(46,56);this.pixels[217]=new Array(47,55);this.pixels[218]=new Array(48,54);this.pixels[219]=new Array(48,54);this.pixels[220]=new Array(49,53);this.pixels[221]=new Array(50,52);this.pixels[222]=new Array(51);this.pixels[223]=new Array(51)}function i(){return this.pixels.reverse()}function j(r,q){if(q-r<0){return false}else{return true}}function e(r,q){if(q-r<0){return false}else{return true}}function p(r,q){if(q+r>area.height()-fighter.height){return false}else{return true}}function c(r,q){if(q+r>area.width()-fighter.width){return false}else{return true}}function h(){if(this.inBoundsTop(fighterOffset,this.y)){this.y-=fighterOffset;$("."+this.cls).css("top",this.y);return true}else{this.clearMirageInterval();return false}}function f(){if(this.inBoundsLeft(fighterOffset,this.x)){this.x-=fighterOffset;$("."+this.cls).css("left",this.x);return true}else{this.clearMirageInterval();return false}}function n(){var q=false;if(this.isEnemy&&collide(this,fighter)){q=true}if(this.isEnemy&&(this.y==area.height()-this.height||q)){if(q){endFighter()}else{newEnemy()}return false}if(this.inBoundsBottom(fighterOffset,this.y)){this.y+=fighterOffset;$("."+this.cls).css("top",this.y);return true}else{this.clearMirageInterval();return false}}function m(){if(this.inBoundsRight(fighterOffset,this.x)){this.x+=fighterOffset;$("."+this.cls).css("left",this.x);return true}else{this.clearMirageInterval();return false}}function k(){if(this.mirageInterval!=null){clearInterval(this.mirageInterval);this.mirageInterval=null}}function l(){$("."+this.cls).remove()}}function unlockBullet(){lockBullet=false}function endFighter(){area.append('<div class="explosion" style="top: '+fighter.y+"px; left: "+fighter.x+'px;"></div>');explosion=true;$(".explosion").fadeOut(5000,function(){explosion=false});enemy.clearMirageInterval();enemy.dissappear();fighter.clearMirageInterval();fighter.dissappear();fighterGameOver=true}function newEnemy(){enemy.clearMirageInterval();enemy.dissappear()}function increaseSpeed(){enemySpeed=defaultEnemySpeed-parseInt(fighterScore/1000)*10;if(enemySpeed<0){enemySpeed=0}}$(document).ready(function(){var a=$(".fighter");area=$("#fighter");$("#start-fighter",a).on("click",function(){if(fighterGameOver&&!explosion){enemySpeed=defaultEnemySpeed;fighter=new Mirage(false);enemy=new Mirage(true);fighterScore=0;$("#fighter-score").html("Score: 0");fighterGameOver=false}});$("#up-fighter",a).on("mousedown",function(){if(!fighterGameOver){fighter.clearMirageInterval();fighter.up();fighter.mirageInterval=setInterval("fighter.up()",fighterSpeed)}});$("#up-fighter",a).on("mouseup",function(){if(!fighterGameOver){fighter.clearMirageInterval()}});$("#left-fighter",a).on("mousedown",function(){if(!fighterGameOver){fighter.clearMirageInterval();fighter.left();fighter.mirageInterval=setInterval("fighter.left()",fighterSpeed)}});$("#left-fighter",a).on("mouseup",function(){if(!fighterGameOver){fighter.clearMirageInterval()}});$("#down-fighter",a).on("mousedown",function(){if(!fighterGameOver){fighter.clearMirageInterval();fighter.down();fighter.mirageInterval=setInterval("fighter.down()",fighterSpeed)}});$("#down-fighter",a).on("mouseup",function(){if(!fighterGameOver){fighter.clearMirageInterval()}});$("#right-fighter",a).on("mousedown",function(){if(!fighterGameOver){fighter.clearMirageInterval();fighter.right();fighter.mirageInterval=setInterval("fighter.right()",fighterSpeed)}});$("#right-fighter",a).on("mouseup",function(){if(!fighterGameOver){fighter.clearMirageInterval()}});$("#fire-fighter",a).on("click",function(){if(!fighterGameOver&&!lockBullet){lockBullet=true;fighter.fire();setTimeout("unlockBullet()",1000)}})});