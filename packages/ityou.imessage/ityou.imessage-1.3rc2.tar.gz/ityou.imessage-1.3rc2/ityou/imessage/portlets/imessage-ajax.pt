<div tal:define="senders view/get_latest_senders | nothing">
    
    <dd class="portletItem odd" tal:condition="senders" >
        <tal:users tal:repeat="s senders">            

            <div class="portrait" 
                tal:attributes="href s/sender_id;">
                <a tal:attributes="href string:${context/absolute_url}/@@messages?sid=${s/sender_id}"><img 
                    tal:attributes="src s/sender_portrait;alt s/sender_id; title s/sender_id" class="small-personal-portrait" />
	            </a>
                <br />
                <div class="sender-message-notify" tal:content="s/count | nothing">0</div>                
                <div class="arrow-top" ></div>
                <div class="imessage-sender-box" tal:attributes="id s/sender_id">
                
	                <tal:messages define="messages python:view.get_sender_latest_messages(s['sender_id'])">
	                    <b tal:content="s/sender_name" />
	                    <span i18n:translate>wrote</span>

	                    <dl tal:repeat="m messages">
	                       <dd tal:attributes="id m/hash">
	                           <i tal:content="m/timestr" ></i>:
	                                                      
	                           <div class="controls">
                                   <div tal:condition="nothing" class="delete"></div>                                  
                                   <div class="read"></div>
                               </div>
                               <div class="message" tal:content="structure python:view.clip(m['message'],40)" />
	                       </dd>
	                    </dl>
	                </tal:messages>
                </div>
            </div>
        </tal:users>        
        <div class="visualClear" ></div>    
    </dd>
</div>


