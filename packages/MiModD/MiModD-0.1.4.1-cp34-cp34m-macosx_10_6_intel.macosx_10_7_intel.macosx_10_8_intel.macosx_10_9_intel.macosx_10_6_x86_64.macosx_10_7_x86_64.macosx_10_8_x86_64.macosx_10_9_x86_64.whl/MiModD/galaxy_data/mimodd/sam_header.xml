<tool id="sam_header" name="NGS Run Annotation">
  <description>Create a SAM format header from run metadata for sample annotation.</description>
  <command>
  	mimodd header

	--rg_id "$rg_id"
	--rg_sm "$rg_sm"
	
	#if $str($rg_cn):
		--rg_cn "$rg_cn"
	#end if
	#if $str($rg_ds):
		--rg_ds "$rg_ds"
	#end if	
	#if $str($anno) and $str($month) and $str($day):
		--rg_dt "$anno-$month-$day"
	#end if
	#if $str($rg_lb):
		--rg_lb "$rg_lb"
	#end if
	#if $str($rg_pl):
		--rg_pl "$rg_pl"
	#end if
	#if $str($rg_ds):
		--rg_pi "$rg_pi"
	#end if
	#if $str($rg_pu):
		--rg_pu "$rg_pu"
	#end if
	
	--outputfile $outputfile

  </command>

  <inputs>
    <param name="rg_id" type="text" size="80" label="read-group ID (mandatory)">
        <sanitizer invalid_char="">
            <valid initial="string.printable">
                <remove value="&quot;" />
            </valid>
            <mapping initial="none">
                <add source="&quot;" target="\&quot;"/>
            </mapping>
        </sanitizer>
    </param>
    <param name="rg_sm" type="text" size="80" label="sample name (mandatory)">
        <sanitizer invalid_char="">
            <valid initial="string.printable">
                <remove value="&quot;" />
            </valid>
            <mapping initial="none">
                <add source="&quot;" target="\&quot;"/>
            </mapping>
        </sanitizer>
    </param>
    <param name="rg_cn" type="text" size="80" label="name of sequencing center">
        <sanitizer invalid_char="">
            <valid initial="string.printable">
                <remove value="&quot;" />
            </valid>
            <mapping initial="none">
                <add source="&quot;" target="\&quot;"/>
            </mapping>
        </sanitizer>
    </param>
    <param name="rg_ds" type="text" size="80" label="description">
        <sanitizer invalid_char="">
            <valid initial="string.printable">
                <remove value="&quot;" />
            </valid>
            <mapping initial="none">
                <add source="&quot;" target="\&quot;"/>
            </mapping>
        </sanitizer>
    </param>
    <param name="anno" type="text" label="year (YYYY) the run was produced" />
    <param name="month" type="text" label="month (MM) the run was produced" />
    <param name="day" type="text" label="day (DD) the run was produced" />
    <param name="rg_lb" type="text" size="80" label="read-group library">
        <sanitizer invalid_char="">
            <valid initial="string.printable">
                <remove value="&quot;" />
            </valid>
            <mapping initial="none">
                <add source="&quot;" target="\&quot;"/>
            </mapping>
        </sanitizer>
    </param>
    <param name="rg_pl" type="text" label="platform/technology used to produce the reads" />
    <param name="rg_pi" type="text" label="predicted median insert size" />
    <param name="rg_pu" type="text" size="80" label="platform unit; unique identifier">
        <sanitizer invalid_char="">
            <valid initial="string.printable">
                <remove value="&quot;" />
            </valid>
            <mapping initial="none">
                <add source="&quot;" target="\&quot;"/>
            </mapping>
        </sanitizer>
    </param>
  </inputs>

  <outputs>
    <data name="outputfile" format="sam" label="${rg_sm} (${rg_id}) header information from MiModd ${tool.name} on ${on_string}"/>
  </outputs>

<help>
.. class:: infomark

   **What it does**

This tool takes the user-provided information about a next-generation sequencing run and constructs a valid header in the SAM file format from it.

The result file can be used by the tools *Convert* and *Reheader* or in the *SNAP Read Alignment* step to add run metadata to sequenced reads files (or to overwrite pre-existing information).

**Note:**

**MiModD requires run metadata for every input file at the Alignment step !**

**Tip:**

While you can do Alignments from fastq file format by providing a custom header file directly to the *SNAP Read Alignment* tool, we **recommend** you to first convert all input files to and archive all datasets in SAM/BAM format with appropriate header information prior to any downstream analysis. Although a bit more time-consuming, this practice protects against information loss and ensures that the input datasets will remain useful for others in the future.

</help>
</tool>
	
