<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="esdrt.content">

  <tal:block metal:fill-slot="style_slot">
    <link rel="stylesheet" type="text/css" href="compare.css"
          tal:attributes="href string:${portal_url}/compare.css"/>
  </tal:block>


  <tal:block metal:fill-slot="javascript_head_slot">
    <script type="text/javascript">

    $(document).ready(function(){

        update_display = function() {
            var style = $(this).attr('value');
            if (! this.checked) {
                return;
            }

            $(".fieldDiff").hide();

            if (style=="visual") {
                $(".inline-diff").show();
            }
            else {
                $(".code-diff").show();
            }
        }

        $(".jsOnly").show();
        version_set = function(){
          $("#versionSelector select").change(function(){
            $('#versionSelector').submit();
          });

          $("#diffTypeSelector input").click(update_display);
          $("#diffTypeSelector input").each(update_display);

          $('#versionSelector').submit(function(e){
            e.preventDefault();
            var data = $(this).serializeArray();
            url = $(this).attr('action');
            $('.changes').load(url + ' .changes >*', data=data, function(){
              version_set();
          });
          });
        }
        version_set();

        $('.deleteButton').prepOverlay(
        {
            subtype: 'ajax',
            filter: common_content_filter,
            formselector: '#delete_confirmation',
            noform: function(el) {return $.plonepopups.noformerrorshow(el, 'redirect');},
            redirect: $.plonepopups.redirectbasehref,
            closeselector: '[name="form.button.Cancel"]',
            width:'50%'
        }
        );

        $('.edit').prepOverlay({
            subtype: 'ajax',
            filter: common_content_filter,
            formselector: '#zc\\.page\\.browser_form',
            noform: function(el) {return $.plonepopups.noformerrorshow(el, 'redirect');},
            redirect: $.plonepopups.redirectbasehref,
            closeselector: '[name="form.buttons.cancel"]',
            width:'50%'
        });

        $('.addfile').prepOverlay({
            subtype: 'ajax',
            filter: common_content_filter,
            formselector: '#edit',
            noform: function(el) {return $.plonepopups.noformerrorshow(el, 'redirect');},
            redirect: $.plonepopups.redirectbasehref,
            closeselector: '[name="form.buttons.cancel"]',
            width:'50%'
          }
        );

        $('#add-question-link').click(function(e){
          e.preventDefault();
          $('#question-add-form').toggle();
        });

        $('#add-comment-link').click(function(e){
          e.preventDefault();
          $('#comment-add-form').toggle();
        });


        $('#add-answer-link').click(function(e){
          e.preventDefault();
          $('#answer-add-form').toggle();
        });


        $('#add-conclusion-link').click(function(e){
          e.preventDefault();
          $('#conclusion-add-form').toggle();
        });

        $('.file .deleteButton').prepOverlay({
            subtype: 'ajax',
            filter: common_content_filter,
            formselector: '#delete_confirmation',
            noform: function(el) {return $.plonepopups.noformerrorshow(el, 'redirect');},
            redirect: $.plonepopups.redirectbasehref,
            closeselector: '[name="form.button.Cancel"]',
            width:'50%'
        });

        $('.file .edit').prepOverlay({
            subtype: 'ajax',
            filter: common_content_filter,
            formselector: '#edit',
            noform: function(el) {return $.plonepopups.noformerrorshow(el, 'redirect');},
            redirect: $.plonepopups.redirectbasehref,
            closeselector: '[name="form.button.Cancel"]',
            width:'50%'
        });






    });



</script>
  </tal:block>


<body>

<metal:main fill-slot="content-core">
  <metal:content-core define-macro="content-core"

      tal:define="toLocalizedTime nocall:here/@@plone/toLocalizedTime">

  <metal:observation define-macro="observation-info"
    tal:define="toLocalizedTime nocall:here/@@plone/toLocalizedTime">
    <div class="backButton">
      <a href=""
        tal:define="pcp here/@@plone_context_state;
                    parent pcp/parent"
        tal:attributes="href parent/absolute_url"
        class="standardButton">
          <span class="eea-icon"><!-- --></span>
            Back to overview list
      </a>
    </div>
    <div class="esdDiv">
      <div class="row">
        <div class="cell position-0 width-1">
          <i class="eea-icon eea-icon-4x observation"></i>
        </div>
        <div class="cell position-1 width-4 esdLabel">Ref. Number</div>
        <div class="cell position-5 width-13 esdLabel">Observation</div>
      </div>
      <div class="row">
        <div class="cell position-1 width-4 value">
          <span tal:content="context/id">
             UK-WAS-13-001
          </span>
        </div>
        <div class="cell position-5 width-13 value">
          <span tal:content="context/title">
             Title
          </span>
        </div>
      </div>
      <div class="row">
        <div class="cell position-1 width-2 esdLabel">Country</div>
        <div class="cell position-3 width-2 esdLabel">Sector</div>
        <div class="cell position-5 width-2 esdLabel">Gases</div>
        <div class="cell position-7 width-3 esdLabel">Inventory year</div>
        <div class="cell position-10 width-3 esdLabel">WF Location</div>
        <div class="cell position-13 width-3">
          <table class="progressbar progress100">
            <tr>
              <td id="progress0">&nbsp;</td>
              <td id="progress25"></td>
              <td id="progress75"></td>
              <td id="progress100"></td>
            </tr>
            <tr>
              <td>0%</td>
              <td></td>
              <td></td>
              <td style="text-align:right">100%</td>
            </tr>
          </table>
        </div>
      </div>
      <div class="row">
        <div class="cell position-1 width-2" tal:content="context/country_value">Country</div>
        <div class="cell position-3 width-2" tal:content="context/ghg_source_sectors_value">Sector</div>
        <div class="cell position-5 width-2" tal:content="context/gas_value">Gas</div>
        <div class="cell position-7 width-3" tal:content="context/year">Year of emission</div>
        <div class="cell position-10 width-3" tal:content="context/wf_location">Review expert</div>
      </div>
    </div>

    <div>
      <div class="row collapsiblePanelTitle collapsed" data-panel="observation-details">
        <div class="cell position-0 width-16">
          Observation details
          <span class="eea-icon eea-icon-left"></span>
        </div>
      </div>
    </div>

    <div class="esdDiv observation-details" style="display:none">
      <div class="row">
        <div class="cell position-0 width-8 esdLabel">GHG source category</div>
        <div class="cell position-8 width-4 esdLabel">CRF code</div>
        <div class="cell position-12 width-4 esdLabel">Parameter</div>
      </div>
      <div class="row">
        <div class="cell position-0 width-8" tal:content="context/ghg_source_category_value">GHG source category</div>
        <div class="cell position-8 width-4" tal:content="context/crf_code_value">CRF code</div>
        <div class="cell position-12 width-4" tal:content="context/parameter_value">Parameter</div>
      </div>
      <div class="row">
        <div class="cell position-0 width-4 esdLabel">Review Year</div>
        <div class="cell position-4 width-4 esdLabel">Key category</div>
        <div class="cell position-8 width-4 esdLabel">Status flag</div>
        <div class="cell position-12 width-4 esdLabel">Last update</div>
      </div>
      <div class="row">
        <div class="cell position-0 width-4" tal:content="context/review_year">Year</div>
        <div class="cell position-4 width-4" tal:content="context/ghg_source_sectors_value">Key category</div>
        <div class="cell position-8 width-4" tal:content="context/highlight_value">Status flag</div>
        <div class="cell position-12 width-4" tal:content="python:toLocalizedTime(context.modified(), True)">Last update</div>
      </div>
    </div>
  </metal:observation>


  <div class="esdDiv description observation-details" style="display:none"
    tal:condition="view/show_description">
    <div class="esdLabel">
      Description
    </div>
    <span
    tal:replace="structure context/text/output">
      Here goes the description
    </span>
  </div>

  <div>
    <div class="row collapsiblePanelTitle collapsed" data-panel="observation-workflow">
      <div class="cell position-0 width-16">
        Observation history
        <span class="eea-icon eea-icon-left"></span>
      </div>
    </div>
  </div>


  <div class="esdDiv observation-workflow" style="display:none">
    <div class="row">
      <div class="cell position-0 width-16" style="overflow-x:auto">
        <table style="table-layout: fixed" id="workflowTable">
          <tr>
            <tal:item tal:repeat="item context/myHistory">
              <td
                tal:define="toLocalizedTime nocall:here/@@plone/toLocalizedTime;">
                  <span class="border"></span>
                  <span class="eea-icon eea-icon-lg wfPoint"></span><br/>
                  <span class="eea-icon eea-icon-lg wfRole"><!-- --></span>
                  <span tal:content="item/role"></span><br/>
                  <a
                    tal:condition="context/is_secretariat"
                    tal:attributes="href python:'http://www.eionet.europa.eu/directory/user?uid='+item['actor']"
                    tal:content="item/author"></a>
                  <br tal:condition="context/is_secretariat"/>
                  <span
                    tal:attributes="class python: ' '.join(['eea-icon eea-icon-lg wfStep', item['object']])"><!-- --></span>
                  <span tal:content="item/state"></span><br/>
                  <span class="eea-icon eea-icon-lg wfTime"><!-- --></span>
                  <span tal:attributes="title python:toLocalizedTime(item['time'], True)" class="datetimeWF">
                    <span tal:replace="item/time"></span>
                  </span><br/>
              </td>
            </tal:item>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <div class="actions" tal:define="actions view/get_menu_actions">

  </div>

  <div class="subscription actions" tal:define="actions view/subscription_options"
    tal:replace="nothing">
    <tal:block  tal:repeat="action actions">
        <a href=""
          tal:attributes="href action/action"
          class="standardButton"
          i18n:translate=""
          tal:content="action/title">
          Action
        </a>
    </tal:block>
  </div>

  <ul class="eea-tabs" tal:condition="view/get_questions">
    <li style="width:165px;max-width:165px"
      tal:condition="python:context.get_status() == 'phase1-close-requested'">Finish observation</li>
    <li style="width:150px;max-width:150px"
      tal:define="conclusion view/get_conclusion"
      tal:condition="nocall:conclusion"
      >Conclusions Phase 1</li>
    <li style="width:200px;max-width:200px">Question chat room</li>
  </ul>

  <div class="eea-tabs-panels" style="overflow:hidden">
    <div class="eea-tabs-panel finish-observation"
      tal:condition="python:context.get_status() == 'phase1-close-requested'">
        <strong>Observation Finish Requested</strong>
        <dl>
          <dt>Reason:</dt>
          <dd><span tal:replace="context/finish_reason_value" /></dd>

          <dt>Comments:</dt>
          <dd><span tal:replace="structure context/closing_comments/output|nothing" /></dd>
        </dl>

        <div class="finish-denied" tal:condition="python:context.closing_deny_comments and context.get_status() == 'phase1-close-requested'" >
          <dl>
            <dt>Observation Finalisation previously denied</dt>
            <dd></dd>
            <dt>Comments:</dt>
            <dd>
              <div tal:replace="structure context/closing_deny_comments/output|nothing">
              Content
              </div>
            </dd>
          </dl>
        </div>

      <div class="actions">
        <tal:block tal:repeat="action view/actions">
          <a href=""
            tal:attributes="href action/action"
            class="standardButton"
            tal:content="action/title">
            Action
          </a>
        </tal:block>
      </div>
    </div>
    <div class="eea-tabs-panel conclusions"
        tal:define="conclusion view/get_conclusion"
        tal:condition="nocall:conclusion">
      <div class="row">
        <div id="conclusions">
          <dl>
            <dt>Reason:</dt>
            <dd><span tal:replace="conclusion/reason_value" /></dd>
            <dt>Comments:</dt>
            <dd><span tal:replace="structure conclusion/text/output|nothing" /></dd>
          </dl>

        </div>

        <div class="finish-denied" tal:condition="context/closing_deny_comments|nothing">
          <dl>
            <dt>Observation Finishing denied</dt>
            <dd></dd>
            <dt>Comments:</dt>
            <dd><span tal:replace="structure context/closing_deny_comments/output|nothing" /></dd>
          </dl>
        </div>

        <div class="files" tal:condition="conclusion/get_files">
          Files:
          <div class="file" tal:repeat="file conclusion/get_files">
            <p>
              <span class="eea-icon eea-icon-lg attachment"></span>
              <a href="" tal:attributes="href string:${file/absolute_url}/@@download/file"
                tal:content="file/file/filename">
              </a>
              <span class="discreet"
                    tal:define="size file/file/getSize;
                                kb python:size/1024">
                    &mdash; <span tal:replace="kb" /> KB</span>
              <a tal:condition="file/can_delete"
                 class="deleteButton"
                 tal:attributes="href string:${file/absolute_url}/delete_confirmation">
                 Delete File
              </a>
            </p>
          </div>
        </div>


        <div id="conclusion-discussion-wrapper"
          tal:define="context nocall:conclusion">
            <div>
              <div class="row collapsiblePanelTitle collapsed" data-panel="conclusion-discussion">
                <div class="cell position-0 width-16">
                  Conclusion comments
                  <span class="eea-icon eea-icon-left"></span>
                </div>
              </div>
              <div id="conclusion-discussion" tal:content="structure provider:esdrt.content.commentmanager" />
            </div>
        </div>
        <div class="actions">
          <a href=""
            tal:condition="conclusion/can_edit"
            tal:attributes="href string:${conclusion/absolute_url}/edit"
            class="edit standardButton">
            Edit conclusion
          </a>
          <a href=""
            tal:condition="conclusion/can_add_files"
            tal:attributes="href string:${conclusion/absolute_url}/++add++ESDRTFile"
            class="addfile standardButton">
            Upload file
          </a>
          <tal:block tal:repeat="action conclusion/get_actions">
              <a href=""
                tal:attributes="href action/action"
                class="standardButton"
                tal:content="action/title">
                Action
              </a>
          </tal:block>
        </div>
      </div>
    </div>
    <div class="eea-tabs-panel questions">
      <div class="actions"
        tal:condition="python:not view.get_questions() and view.can_add_conclusion()">
        <a href=""
            id="add-conclusion-link"
            tal:attributes="href string:${here/absolute_url}/++add++Conclusion"
            class="standardButton">
            Add conclusions
        </a>
      </div>

      <div class="actions" tal:condition="view/can_add_question">
        <a id="add-question-link"
          tal:attributes="href string:${here/absolute_url}/++add++Question"
          class="standardButton">
          Add question
        </a>
        <tal:block condition="view/can_edit">
          <a href=""
              tal:attributes="href string:${here/absolute_url}/modifications"
              class="standardButton">
              Edit observation
          </a>
        </tal:block>
        <tal:block condition="view/can_delete_observation">
          <a href="./delete_confirmation"
            id="observation-delete"
            tal:attributes="href string:${here/absolute_url}/delete_confirmation"
            class="standardButton deleteButton">
            Delete observation
          </a>
        </tal:block>
        <a href="./content_status_modify?workflow_action=close"
          tal:condition="python:not context.get_question() and view.can_add_question()"
          id="observation-finish"
          tal:attributes="href string:${here/absolute_url}/content_status_modify?workflow_action=phase1-draft-conclusions"
          class="standardButton">
          Finish observation
        </a>
      </div>

      <div id="question-add-form" style="display: none" tal:condition="view/can_add_question">
        <span tal:replace="structure view/add_question_form"></span>
      </div>
      <div class="question" tal:repeat="question view/get_chat" tal:attributes="id question/getId; class string:question ${question/portal_type/lower};">
        <tal:block tal:define="portalType question/portal_type/lower"
          tal:condition="python:portalType == 'comment'">
          <div class="arrow-right-border"></div>
          <div class="arrow-right"></div>
        </tal:block>
        <tal:block tal:define="portalType question/portal_type/lower"
          tal:condition="python:portalType == 'commentanswer'">
          <div class="arrow-left-border"></div>
          <div class="arrow-left"></div>
        </tal:block>
        <div class="from"  tal:define="portalType question/portal_type/lower">
          <span class="esdLabel">from</span>
          <span class="value" tal:condition="python:portalType == 'comment'">Review expert</span>
          <span class="value" tal:condition="python:portalType == 'commentanswer'">Member state authority</span>
          <!--span class="value" tal:content="python:view.get_user_name(question.Creator(), question)">John Smith</span-->
          <span class="messageDate">
            <tal:effective condition="question/effective_date">
              Sent on: <span tal:content="python:toLocalizedTime(question.EffectiveDate(), True)">11/12/2013 12:00</span>
            </tal:effective>
            <tal:noteffective condition="not:question/effective_date">
              Created on: <span tal:content="python:toLocalizedTime(question.created(), True)">11/12/2013 12:00</span>
            </tal:noteffective>
         </span>
        </div>
        <h3 tal:condition="question/can_edit">Current text</h3>
        <div tal:content="structure question/text/output|string:">
          Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </div>
        <div class="files" tal:condition="question/get_files">
          Files:
          <div class="file" tal:repeat="file question/get_files">
            <p>
              <span class="eea-icon eea-icon-lg attachment"></span>
              <a href="" tal:attributes="href string:${file/absolute_url}/@@download/file"
                tal:content="file/file/filename">
              </a>
              <span class="discreet"
                    tal:define="size file/file/getSize;
                                kb python:size/1024">
                    &mdash; <span tal:replace="kb" /> KB</span>
              <a tal:condition="file/can_edit"
                 class="edit"
                 tal:replace="nothing"
                 tal:attributes="href string:${file/absolute_url}/edit">
                Edit File
              </a>
              <a tal:condition="file/can_edit"
                 class="deleteButton"
                 tal:attributes="href string:${file/absolute_url}/delete_confirmation">
                 Delete File
              </a>
            </p>
          </div>
        </div>
        <div class="changes" tal:condition="question/can_edit">
          <div class="row collapsiblePanelTitle collapsed" data-panel="question-history">
            <div class="cell position-0 width-16">
              Question history
              <span class="eea-icon eea-icon-left"></span>
            </div>
          </div>
          <div class="question-history" style="display:none">
            <p tal:condition="not:view/history|nothing" i18n:translate="no_history">
              This object has no revision information.
            </p>
            <tal:block condition="view/history|nothing">
              <form id="versionSelector"
                    action="#"
                    tal:attributes="action pps/current_page_url"
                    tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime;
                                 pps here/@@plone_context_state
                    ">
                <fieldset>
                  <legend i18n:translate="legend_revisions">
                    Revisions
                  </legend>
                  <label for="two">
                    <span tal:omit-tag="" i18n:translate="">First revision</span>
                    <select id="two" name="two" tal:define="rev request/form/two|string:current">
                       <option i18n:translate="label_current" value="current" tal:attributes="selected python:rev=='current' and 'yes' or None">Current</option>
                       <option tal:repeat="version view/history"
                               tal:attributes="value version/version_id; selected python:str(rev)==str(version['version_id']) and 'yes' or None"
                               i18n:translate="label_history_version"><tal:version i18n:name="version" content="version/version_id">1</tal:version>
                               (<span tal:replace="version/sys_metadata/review_state"/> <span tal:replace="version/sys_metadata/principal"/> <tal:date i18n:name="date" content="python:toLocalizedTime(version['sys_metadata']['timestamp'])">1975-12-24</tal:date>)</option>
                    </select>
                  </label>
                  <label for="one">
                    <span tal:omit-tag="" i18n:translate="">Second revision</span>
                    <select id="one" name="one" tal:define="rev request/one|string:current">
                       <option i18n:translate="label_current" value="current" tal:attributes="selected python:rev=='current' and 'yes' or None">Current</option>
                       <option tal:repeat="version view/history"
                               tal:attributes="value version/version_id; selected python:str(rev)==str(version['version_id']) and 'yes' or None"
                               i18n:translate="label_history_version"><tal:version i18n:name="version" content="version/version_id">1</tal:version>
                               (<span tal:replace="version/sys_metadata/review_state"/> <span tal:replace="version/sys_metadata/principal"/> <tal:date i18n:name="date" content="python:toLocalizedTime(version['sys_metadata']['timestamp'])">1975-12-24</tal:date>)</option>
                    </select>
                  </label>
                </fieldset>

                <noscript>
                  <input type="submit" i18n:attributes="value label_update" value="Update"/>
                </noscript>
              </form>
              <div metal:use-macro="here/diff_legend/macros/diff_legend"></div>

              <p tal:condition="not:view/changes" i18n:translate="">
                There are no changes between the selected revisions.
              </p>

              <tal:changes condition="view/changes">
                <form method="post" action="">
                  <label for="diffstyle" class="jsOnly" style="display: none" i18n:translate="">Show differences</label>
                  <ul class="radioRow" id="diffTypeSelector">
                    <li>
                      <input id="diffstylevisual" type="radio" name="diffstyle" value="visual" checked="checked" />
                      <label for="diffstylevisual" i18n:translate="">inline</label>
                    </li>
                    <li>
                      <input id="diffstylecode" type="radio" name="diffstyle" value="code" />
                      <label for="diffstylecode" i18n:translate="">as code</label>
                    </li>
                  </ul>
                </form>

                <fieldset class="diff" tal:repeat="diff view/changes">
                  <legend tal:content="diff/label">Body text</legend>

                  <div class="fieldDiff inline-diff" tal:condition="exists:diff/inline_diff"
                      tal:content="structure python:diff.inline_diff()">
                    Inline changes
                  </div>

                  <p class="fieldDiff inline-diff" tal:condition="not:exists:diff/inline_diff" i18n:translate="">
                   This field has no inline difference view.
                  </p>

                  <div class="fieldDiff code-diff" style="display: none">
                    <pre tal:condition="exists:diff/html_diff" tal:content="structure python:diff.html_diff(wrapcolumn=80)">
                     HTML formatted differences
                    </pre>

                    <pre class="fieldDiff code-diff" tal:condition="python:not exists('diff/html_diff') and exists('diff/ndiff')" tal:content="diff/ndiff">
                     ndiff formatted differences
                    </pre>
                    <p class="fieldDiff" tal:condition="python:not exists('diff/html_diff') and not exists('diff/ndiff')">
                     This field has no code difference view.
                    </p>
                  </div>
                </fieldset>
              </tal:changes>
            </tal:block>
          </div>
        </div>
        <div id="comment-discussion-wrapper"
          tal:define="context nocall:question">
            <tal:block tal:define="portalType question/portal_type/lower">
              <tal:block tal:condition="python:portalType == 'comment' and question.can_see_comment_discussion()">
                <div class="row collapsiblePanelTitle collapsed" data-panel="question-comments">
                  <div class="cell position-0 width-16">
                    Question comments
                    <span class="eea-icon eea-icon-left"></span>
                  </div>
                </div>
                <div class="question-comments" tal:content="structure provider:esdrt.content.commentmanager" style="display:none" />
              </tal:block>
              <tal:block tal:condition="python:portalType == 'commentanswer' and question.can_see_answer_discussion()">
                <div class="row collapsiblePanelTitle collapsed" data-panel="answer-comments">
                  <div class="cell position-0 width-16">
                    Answer comments
                    <span class="eea-icon eea-icon-left"></span>
                  </div>
                </div>
                <div class="answer-comments" tal:content="structure provider:esdrt.content.commentmanager" style="display:none" />
              </tal:block>
            </tal:block>
        </div>
        <div class="actions" tal:condition="repeat/question/end">
          <!--tal:block condition="view/can_edit">
            <a href=""
                tal:attributes="href string:${here/absolute_url}/modifications"
                class="standardButton">
                Edit Observation
            </a>
          </tal:block-->

          <tal:block condition="view/can_delete_observation">
            <a href="./delete_confirmation"
              id="observation-delete"
              tal:attributes="href string:${here/absolute_url}/delete_confirmation"
              class="deleteButton standardButton">
              Delete observation
            </a>
          </tal:block>

          <a href=""
            tal:condition="view/can_add_conclusion"
            id="add-conclusion-link"
            tal:attributes="href string:${here/absolute_url}/++add++Conclusion"
            class="standardButton">
            Add conclusions
          </a>

          <tal:block  tal:define="portalType question/portal_type/lower"
            tal:condition="python:portalType == 'comment'">
            <a href=""
                  tal:condition="question/can_edit"
                  tal:attributes="href string:${question/absolute_url}/edit"
                  class="edit standardButton">
                    Edit question
            </a>
            <a href=""
                  tal:replace="nothing"
                  tal:condition="question/can_delete"
                  tal:attributes="href string:${question/absolute_url}/../delete_confirmation"
                  class="deleteButton standardButton">
                    Delete question
            </a>
          </tal:block>

          <tal:block  tal:define="portalType question/portal_type/lower"
            tal:condition="python:portalType == 'commentanswer'">
            <a href=""
                  tal:condition="question/can_edit"
                  tal:attributes="href string:${question/absolute_url}/edit"
                  class="edit standardButton">
                    Edit answer
            </a>
            <a href=""
                  tal:condition="question/can_delete"
                  tal:attributes="href string:${question/absolute_url}/delete_confirmation"
                  class="deleteButton standardButton">
                    Delete answer
            </a>
          </tal:block>

          <a href=""
                tal:condition="question/can_add_files"
                tal:attributes="href string:${question/absolute_url}/++add++ESDRTFile"
                class="standardButton addfile">
                  Upload file
          </a>

          <tal:block tal:repeat="action view/actions">
            <a href=""
              tal:attributes="href string:${action/action}&amp;comment=${question/getId}"
              class="standardButton"
              tal:content="action/title">
              Action
            </a>
          </tal:block>
        </div>
      </div>
      <div class="actions" tal:condition="view/can_add_comment">
        <a href="./++add++Comment"
          id="add-comment-link"
          tal:attributes="href string:${here/absolute_url}/++add++Comment"
          class="standardButton">
            Add follow up question
        </a>
      </div>
      <div class="actions" tal:condition="view/can_add_answer">
        <a href="./++add++CommentAnswer"
          id="add-answer-link"
          tal:attributes="href string:${here/absolute_url}/++add++CommentAnswer"
          title="To draft an answer and save it.You can request comments on your draft answer from your Member States expert(s) if needed or send your answer back to the review team without consulting your experts."
          class="standardButton">
            Create answer
        </a>
        <a href="./add-answer-and-request-comments"
          id="no-answer-link"
          tal:attributes="href string:${here/absolute_url}/add-answer-and-request-comments"
          title="To consult your Member States expert(s) without drafting an answer first. You ask your Member states experts to suggest an answer and you draft the answer after your discussions."
          class="standardButton">
            Request help for answer
        </a>

      </div>

      <div id="comment-add-form" style="display: none" tal:condition="view/can_add_comment">
        <span tal:replace="structure view/add_comment_form" />
      </div>

      <div id="answer-add-form" style="display: none" tal:condition="view/can_add_answer">
        <span tal:replace="structure view/add_answer_form" />
      </div>


      <div id="conclusion-add-form" style="display: none" tal:condition="view/can_add_conclusion">
        <span tal:replace="structure view/add_conclusion_form" />
      </div>
    </div>
  </div>
  </metal:content-core>
</metal:main>
</body>
</html>

