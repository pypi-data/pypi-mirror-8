

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The low-level API &mdash; mosaik 2.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../',
        VERSION:'2.0',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="mosaik 2.0 documentation" href="../index.html"/>
        <link rel="up" title="The mosaik API" href="index.html"/>
        <link rel="next" title="The high-level API" href="high-level.html"/>
        <link rel="prev" title="How mosaik communicates with a simulator" href="overview.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> mosaik</a>
        <form class="wy-form" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#linux">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#os-x">OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#what-s-mosaik-supposed-to-do">What&#8217;s mosaik supposed to do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#mosaik-s-main-components">Mosaik&#8217;s main components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystem.html">The mosaik ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/examplesim.html">Integrating a simulation model into the mosaik ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/demo1.html">Creating and running simple simulation scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/examplectrl.html">Adding a control mechanism to a scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/demo2.html">Integrating a control mechanism</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The mosaik API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">How mosaik communicates with a simulator</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">The low-level API</a></li>
<li class="toctree-l2"><a class="reference internal" href="high-level.html">The high-level API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scenario-definition.html">Scenario definition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#the-setup">The setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#starting-simulators">Starting simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#instantiating-simulation-models">Instantiating simulation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#connecting-entities">Connecting entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#running-the-simulation">Running the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-achieve-bi-directional-data-flows">How to achieve bi-directional data-flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-filter-entity-sets">How to filter entity sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-create-user-defined-connection-rules">How to create user-defined connection rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-retrieve-static-data-from-entities">How to retrieve static data from entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-access-topology-and-data-flow-information">How to access topology and data-flow information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-destroy-a-world">How to destroy a world</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-to-real-time-simulations">How to to real-time simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scenario-definition.html#how-to-call-extra-methods-of-a-simulator">How to call extra methods of a simulator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simmanager.html">The simulator manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler.html">Scheduling and simulation execution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html#anatomy-of-a-step">Anatomy of a step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html#synchronization-and-data-flows">Synchronization and data-flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html#cyclic-data-flows">Cyclic data-flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html#stepping-and-simulation-duration">Stepping and simulation duration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#general-questions">General questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#coupling-models-with-mosaik">Coupling models with mosaik</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#the-mosaik-demo">The mosaik demo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Developer&#8217;s Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/setup.html">Development setup and tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/release_process.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/requirements.html">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/design-decisions.html">Discussion of design decisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/logo-ci.html">Logo and corporate identity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/mosaik.html"><tt class="docutils literal"><span class="pre">mosaik</span></tt> &#8212; The ende-user API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/mosaik.exceptions.html"><tt class="docutils literal"><span class="pre">mosaik.exceptions</span></tt> &#8212; mosaik specific error types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/mosaik.scenario.html"><tt class="docutils literal"><span class="pre">mosaik.scenario</span></tt> &#8212; Classes related to the scenario creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/mosaik.scheduler.html"><tt class="docutils literal"><span class="pre">mosaik.scheduler</span></tt> &#8212; Coordinate and execute simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/mosaik.simmanager.html"><tt class="docutils literal"><span class="pre">mosaik.simmanager</span></tt> &#8212; Management of external processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/mosaik.util.html"><tt class="docutils literal"><span class="pre">mosaik.util</span></tt> &#8212; Utility classes and functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About mosaik</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/history.html">The history of mosaik</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">mosaik</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="../index.html">Docs</a> &raquo;</li>
  <li><a href="">The low-level API</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="the-low-level-api">
<span id="low-level-api"></span><h1>The low-level API<a class="headerlink" href="#the-low-level-api" title="Permalink to this headline">¶</a></h1>
<p>The low-level API uses standard TCP sockets. If mosaik starts a simulator, that
simulator needs to connect to mosaik. If mosaik connects to a running instance
of a simulator, that simulator obviously needs to provide a server socket that
mosaik can connect to.</p>
<p>Network messages consists of a four bytes long <em>header</em> and a <em>payload</em> of
arbitrary length. The header is an unsigned integer (<a class="reference external" href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/stdint.h.html#tag_13_47_03_01">uint32</a>)
in network byte order (big-endian) and stores the number of bytes in the
payload. The payload itself is a UTF-8 encoded <a class="reference external" href="http://www.json.org/">JSON</a>
list containing the message type, a message ID and the actual content:</p>
<a class="reference internal image-reference" href="../_images/network-messages.svg"><div align="center" class="align-center"><img alt="Messages consist of a header and a payload. The payload is a JSON list containing a message type, ID and the actual content." src="../_images/network-messages.svg" width="500" /></div>
</a>
<p>Messages send between mosaik and a simulator must follow the <a class="reference external" href="http://en.wikipedia.org/wiki/Request-response">request-reply
pattern</a>. That means, that
every request that one party makes must be responded by the other party.
Request use the message type <tt class="docutils literal"><span class="pre">0</span></tt>, replies uses <tt class="docutils literal"><span class="pre">1</span></tt> for success or <tt class="docutils literal"><span class="pre">2</span></tt> to
indicate a failure. The message ID is an integer that is unique for every
request that a network socket makes. Replies (no matter if successful or
failed) need to use the message ID of the corresponding request.</p>
<p>The content of a request roughly map to a Python function call:</p>
<div class="highlight-json"><div class="highlight"><pre>[function, [arg0, arg1, ...], {kwarg0: val0, kwar1: val1}]
</pre></div>
</div>
<p>Thereby, <em>function</em> is always a string. The type of the <a class="reference external" href="https://docs.python.org/3/glossary.html#term-argument">arguments and keyword
arguments</a> may vary
depending on the function.</p>
<p>The content of replies is either the return value of the request, or an error
message or stack trace. Error messages and stack traces should always be
strings. The return value for successful requests depends on the function.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>We want to perform the following function call on the remote site:
<tt class="docutils literal"><span class="pre">my_func('hello',</span> <span class="pre">'world',</span> <span class="pre">times=23)</span> <span class="pre">--&gt;</span> <span class="pre">'the</span> <span class="pre">return</span> <span class="pre">value'</span></tt>. This would map
to the following message payload:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">],</span> <span class="p">{</span><span class="nt">&quot;times&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">}]]</span>
</pre></div>
</div>
<p>Our message is a request (message type <tt class="docutils literal"><span class="pre">0</span></tt>), the message ID is <tt class="docutils literal"><span class="pre">1</span></tt> and the
content is a JSON list containing the function name as well as its arguments
and keyword arguments.</p>
<p>The complete message sent via the network will be:</p>
<div class="highlight-python"><div class="highlight"><pre>\x00\x00\x00\x36[1, 1, [&quot;my_func&quot;, [&quot;hello&quot;, &quot;world&quot;], {&quot;times&quot;: 23}]]
</pre></div>
</div>
<p>In case of success, the reply&#8217;s payload to this request could look like this:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;the return value&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>In case of error, this could be the reply&#8217;s payload:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Error in your code line 23: ...&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The actual network messages would be:</p>
<div class="highlight-python"><div class="highlight"><pre>\x00\x00\x00\x1a[1, 1, &quot;the return value&quot;]
\x00\x00\x00\x29[2, 1, &quot;Error in your code line 23: ...&quot;]
</pre></div>
</div>
<p>All commands that mosaik may send to a simulator are described in-depth in the
<a class="reference internal" href="#api-calls"><em>next section</em></a>. All asynchronous requests that a simulator may
make are described in <a class="reference internal" href="#asynchronous-requests"><em>Asynchronous requests</em></a>.</p>
<p>API calls:</p>
<ul class="simple">
<li><a class="reference internal" href="#api-init"><em>init</em></a></li>
<li><a class="reference internal" href="#api-create"><em>create</em></a></li>
<li><a class="reference internal" href="#api-step"><em>step</em></a></li>
<li><a class="reference internal" href="#api-get-data"><em>get_data</em></a></li>
<li><a class="reference internal" href="#api-stop"><em>stop</em></a></li>
</ul>
<p>Async. requests:</p>
<ul class="simple">
<li><a class="reference internal" href="#rpc-get-progress"><em>get_progress</em></a></li>
<li><a class="reference internal" href="#rpc-get-related-entities"><em>get_related_entities</em></a></li>
<li><a class="reference internal" href="#rpc-get-data"><em>get_data</em></a></li>
<li><a class="reference internal" href="#rpc-set-data"><em>set_data</em></a></li>
</ul>
</div>
<div class="section" id="api-calls">
<span id="id1"></span><h2>API calls<a class="headerlink" href="#api-calls" title="Permalink to this headline">¶</a></h2>
<p>This section decribes the five API calls <tt class="docutils literal"><span class="pre">init()</span></tt>, <tt class="docutils literal"><span class="pre">create()</span></tt>, <tt class="docutils literal"><span class="pre">step()</span></tt>,
<tt class="docutils literal"><span class="pre">get_data()</span></tt> and <tt class="docutils literal"><span class="pre">stop()</span></tt>. In addition to these, a simulator may
<em>optionally</em> expose additonal functions (referred to as <em>extra methods</em>). These
methods can be called at composition time (when you create your scenario).</p>
<div class="section" id="init">
<span id="api-init"></span><h3>init<a class="headerlink" href="#init" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;init&quot;, [sim_id], {**sim_params}] -&gt; meta
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">init</span></tt> call is made once to initialize the simulator. It has one
positional argument, the simulator ID, and an arbitrary amount of keyword
arguments (<em>sim_params</em>).</p>
<p>The return value <em>meta</em> is an object with meta data about the simulator:</p>
<div class="highlight-python"><div class="highlight"><pre>{
    &quot;api_version&quot;: &quot;x.y.z&quot;,
    &quot;models&quot;: {
        &quot;ModelName&quot;: {
            &quot;public&quot;: true|false,
            &quot;params&quot;: [&quot;param_1&quot;, ...],
            &quot;attrs&quot;: [&quot;attr_1&quot;, ...],
            &quot;any_inputs&quot;: true|false,
        },
        ...
    },
    &quot;extra_methods&quot;: [
        &quot;do_cool_stuff&quot;,
        &quot;set_static_data&quot;
    ]
}
</pre></div>
</div>
<p>The <em>api_version</em> is a string that defines which version of the mosaik API the
simulator implements. The simulator&#8217;s <a class="reference external" href="http://semver.org/">major versions</a>
(&#8220;x&#8221;, in the snippet above) has to be the same as mosaik&#8217;s. Mosaik will cancel
the simulation if a version mismatch occurs.</p>
<p><em>models</em> is an object describing the models provided by this simulator. The
entry <em>public</em> determines whether a model can be instantiated by a user
(<tt class="docutils literal"><span class="pre">true</span></tt>) or if it is a sub-model that cannot be created directly (<tt class="docutils literal"><span class="pre">false</span></tt>).
<em>params</em> is a list of parameter names that can be passed to the model when
creating it. <em>attrs</em> is a list of attribute names that can be accessed (reading
or writing). If the optional <em>any_inputs</em> flag is set to <tt class="docutils literal"><span class="pre">true</span></tt>, any
attributes can be connected to the model, even if they are not <em>attrs</em>. This
may, for example, be useful for databases that don&#8217;t know in advance which
attributes of an entity they&#8217;ll receive.</p>
<p><em>extra_methods</em> is an optional list of methods that a simulator provides in
addition to the standard API calls (<tt class="docutils literal"><span class="pre">init()</span></tt>, <tt class="docutils literal"><span class="pre">create()</span></tt> and so on). These
methods can be called while the scenario is being created and can be used for
operations that don&#8217;t really belong into <tt class="docutils literal"><span class="pre">init()</span></tt> or <tt class="docutils literal"><span class="pre">create()</span></tt>.</p>
<div class="section" id="id2">
<h4>Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;init&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;PowerGridSim-0&quot;</span><span class="p">],</span> <span class="p">{</span><span class="nt">&quot;step_size&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">}]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
   <span class="nt">&quot;api_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
   <span class="nt">&quot;models&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Grid&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;public&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;topology_file&quot;</span><span class="p">],</span>
            <span class="nt">&quot;attrs&quot;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">},</span>
        <span class="nt">&quot;Node&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;public&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="nt">&quot;attrs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="nt">&quot;Branch&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;public&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nt">&quot;params&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="nt">&quot;attrs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;I_max&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create">
<span id="api-create"></span><h3>create<a class="headerlink" href="#create" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;create&quot;, [num, model], {**model_params}] -&gt; entity_list
</pre></div>
</div>
<p>Create <em>num</em> instances of <em>model</em> using the provided <em>model_params</em></p>
<p><em>num</em> is an integer for the number of model instances to create.</p>
<p><em>model</em> needs to be a public entry in the simulator&#8217;s <tt class="docutils literal"><span class="pre">meta['models']</span></tt> (see
<a class="reference internal" href="#api-init"><em>init</em></a>).</p>
<p><em>model_params</em> is an object mapping parameters (from
<tt class="docutils literal"><span class="pre">meta['models'][model]['params']</span></tt>, see <a class="reference internal" href="#api-init"><em>init</em></a>) to their values.</p>
<p>Return a (nested) list of objects describing the created model instances
(entities). The root list must contain exactly <em>num</em> elements. The number of
objects in sub-lists is not constrained:</p>
<div class="highlight-python"><div class="highlight"><pre>[
      {
         &quot;eid&quot;: &quot;eid_1&quot;,
         &quot;type&quot;: &quot;model_name&quot;,
         &quot;rel&quot;: [&quot;eid_2&quot;, ...],
         &quot;children&quot;: &lt;entity_list&gt;,
      },
      ...
]
</pre></div>
</div>
<p>The entity ID (<em>eid</em>) of an object must be unique within a simulator instance.
For entities in the root list, <em>type</em> must be the same as the <em>model</em>
parameter. The type for objects in sub-lists may be anything that can be found
in <tt class="docutils literal"><span class="pre">meta['models']</span></tt> (see <a class="reference internal" href="#api-init"><em>init</em></a>).  <em>rel</em> is an optional list of
related entities; &#8220;related&#8221; means that two entities are somehow connect within
the simulator, either logically or via a real <a class="reference internal" href="../glossary.html#term-data-flow"><em class="xref std std-term">data-flow</em></a> (e.g., grid
nodes are related to their adjacent branches). The <em>children</em> entry is optional
and may contain a sub-list of entities.</p>
<div class="section" id="id3">
<h4>Example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;create&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span> <span class="p">{</span><span class="nt">&quot;topology_file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/grid.json&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;eid&quot;</span><span class="p">:</span> <span class="s2">&quot;Grid_1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Grid&quot;</span><span class="p">,</span>
        <span class="nt">&quot;rel&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="nt">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;eid&quot;</span><span class="p">:</span> <span class="s2">&quot;node_0&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Node&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;eid&quot;</span><span class="p">:</span> <span class="s2">&quot;node_1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Node&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;eid&quot;</span><span class="p">:</span> <span class="s2">&quot;branch_0&quot;</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Branch&quot;</span><span class="p">,</span>
                <span class="nt">&quot;rel&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;node_0&quot;</span><span class="p">,</span> <span class="s2">&quot;node_1&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="step">
<span id="api-step"></span><h3>step<a class="headerlink" href="#step" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;step&quot;, [time, inputs], {}] -&gt; time_next_step
</pre></div>
</div>
<p>Perform the next simulation step from time <em>time</em> using input values from
<em>inputs</em> and return the new simulation time (the time at which <em>step</em> should
be called again).</p>
<p><em>time</em> and the time retuned are integers. Their unit is <em>seconds</em> (counted from
simulation start).</p>
<p><em>inputs</em> is a dict of dicts mapping entity IDs to attributes and dicts of
values (each simulator has do decide on its own how to reduce the values (e.g.,
as its sum, average or maximum):</p>
<div class="highlight-python"><div class="highlight"><pre>{
    &quot;eid_1&quot;: {
        &quot;attr_1&quot;: {&#39;src_full_id_1&#39;: val_1_1, &#39;src_full_id_2&#39;: val_1_2, ...},
        &quot;attr_2&quot;: {&#39;src_full_id_1&#39;: val_2_1, &#39;src_full_id_2&#39;: val_2_2, ...},
        ...
    },
    ...
}
</pre></div>
</div>
<div class="section" id="id4">
<h4>Example<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span>
    <span class="s2">&quot;step&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="mi">60</span><span class="p">,</span>
        <span class="p">{</span>
              <span class="nt">&quot;node_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;P&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span> <span class="nt">&quot;Q&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">-2.5</span><span class="p">]},</span>
              <span class="nt">&quot;node_2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;P&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">42</span><span class="p">],</span> <span class="nt">&quot;Q&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">-23.2</span><span class="p">]},</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="p">{}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="mi">120</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-data">
<span id="api-get-data"></span><h3>get_data<a class="headerlink" href="#get-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;get_data&quot;, [outputs], {}] -&gt; data
</pre></div>
</div>
<p>Return the data for the requested attributes in <em>outputs</em></p>
<p><em>outputs</em> is an object mapping entity IDs to lists of attribute names whose
values are requested:</p>
<div class="highlight-python"><div class="highlight"><pre>{
    &quot;eid_1&quot;: [&quot;attr_1&quot;, &quot;attr_2&quot;, ...],
    ...
}
</pre></div>
</div>
<p>The return value needs to be an object of objects mapping entity IDs and
attribute names to their values:</p>
<div class="highlight-python"><div class="highlight"><pre>{
    &quot;eid_1: {
       &quot;attr_1&quot;: &quot;val_1&quot;,
       &quot;attr_2&quot;: &quot;val_2&quot;,
       ...
    },
    ...
}
</pre></div>
</div>
<div class="section" id="id5">
<h4>Example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;get_data&quot;</span><span class="p">,</span> <span class="p">[{</span><span class="nt">&quot;branch_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]}],</span> <span class="p">{}]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;branch_0&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;I&quot;</span><span class="p">:</span> <span class="mf">42.5</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stop">
<span id="api-stop"></span><h3>stop<a class="headerlink" href="#stop" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;stop&quot;, [], {}] -&gt;
</pre></div>
</div>
<p>Immediately stop the simulation and terminate.</p>
<p>This call has no parameters and no reply is required.</p>
<div class="section" id="id6">
<h4>Example<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;stop&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{}]</span>
</pre></div>
</div>
<p>Reply:</p>
<blockquote>
<div><em>no reply required</em></div></blockquote>
</div>
</div>
</div>
<div class="section" id="asynchronous-requests">
<span id="id7"></span><h2>Asynchronous requests<a class="headerlink" href="#asynchronous-requests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-progress">
<span id="rpc-get-progress"></span><h3>get_progress<a class="headerlink" href="#get-progress" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;get_progress&quot;, [], {}] -&gt; progress
</pre></div>
</div>
<p>Return the current overall simulation progress in percent.</p>
<div class="section" id="id8">
<h4>Example<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;get_progress&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{}]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="mf">23.42</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-related-entities">
<span id="rpc-get-related-entities"></span><h3>get_related_entities<a class="headerlink" href="#get-related-entities" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;get_related_entities&quot;, [entities], {}] -&gt; related_entities
</pre></div>
</div>
<p>Return information about the related entities of <em>entities</em>.</p>
<p>If <em>entitites</em> omitted (or <tt class="docutils literal"><span class="pre">null</span></tt>), return the complete entity graph, e.g.:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;sid_0.eid_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
        <span class="nt">&quot;sid_0.eid_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
        <span class="nt">&quot;sid_1.eid_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="nt">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;sid_0.eid_0&quot;</span><span class="p">,</span> <span class="s2">&quot;sid_1.eid0&quot;</span><span class="p">,</span> <span class="p">{}],</span>
        <span class="p">[</span><span class="s2">&quot;sid_0.eid_1&quot;</span><span class="p">,</span> <span class="s2">&quot;sid_1.eid0&quot;</span><span class="p">,</span> <span class="p">{}],</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If <em>entities</em> is a single string (e.g., <tt class="docutils literal"><span class="pre">sid_1.eid_0</span></tt>), return an object
containing all entities related to that entity:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;sid_0.eid_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">},</span>
    <span class="nt">&quot;sid_0.eid_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If <em>entities</em> is a list of entity IDs (e.g., <tt class="docutils literal"><span class="pre">[&quot;sid_0.eid_0&quot;,</span>
<span class="pre">&quot;sid_0.eid_1&quot;]</span></tt>), return an object mapping each entity to an object of related
entities:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;sid_0.eid_0&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;sid_0.eid_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="nt">&quot;sid_0.eid_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;sid_0.eid_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="id9">
<h4>Example<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;get_related_entities&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;grid_sim_0.node_0&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_sim_0.node_1&quot;</span><span class="p">]]</span> <span class="p">{}]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;grid_sim_0.node_0&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;grid_sim_0.branch_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Branch&quot;</span><span class="p">},</span>
        <span class="nt">&quot;pv_sim_0.pv_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;PV&quot;</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;grid_sim_0.node_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;grid_sim_0.branch_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Branch&quot;</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rpc-get-data">
<span id="id10"></span><h3>get_data<a class="headerlink" href="#rpc-get-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;get_data&quot;, [attrs], {}] -&gt; data
</pre></div>
</div>
<p>Get the data for the requested attributes in <em>attrs</em>.</p>
<p><em>attrs</em> is an object of (fully qualified) entity IDs mapping to lists of
attribute names:</p>
<div class="highlight-python"><div class="highlight"><pre>{
    &quot;sim_id.eid_1&quot;: [&quot;attr_1&quot;, &quot;attr_2&quot;, ...],
    ...
}
</pre></div>
</div>
<p>The return value is an object mapping the input entity IDs to data objects
mapping attribute names to there respective values:</p>
<div class="highlight-python"><div class="highlight"><pre>{
    &quot;sim_id.eid_1: {
        &quot;attr_1&quot;: &quot;val_1&quot;,
        &quot;attr_2&quot;: &quot;val_2&quot;,
        ...
    },
     ...
}
</pre></div>
</div>
<div class="section" id="id11">
<h4>Example<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;get_data&quot;</span><span class="p">,</span> <span class="p">[{</span><span class="nt">&quot;grid_sim_0.branch_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">]}],</span> <span class="p">{}]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;grid_sim_0.branch_0&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;I&quot;</span><span class="p">:</span> <span class="mf">42.5</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-data">
<span id="rpc-set-data"></span><h3>set_data<a class="headerlink" href="#set-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>[&quot;set_data&quot;, [data], {}] -&gt; null
</pre></div>
</div>
<p>Set <em>data</em> as input data for all affected simulators.</p>
<p><em>data</em> is an object mapping source entity IDs to objects which in turn map
destination entity IDs to objects of attributes and values
(<tt class="docutils literal"><span class="pre">{&quot;src_full_id&quot;:</span> <span class="pre">{&quot;dest_full_id&quot;:</span> <span class="pre">{&quot;attr1&quot;:</span> <span class="pre">&quot;val1&quot;,</span> <span class="pre">&quot;attr2&quot;:</span> <span class="pre">&quot;val2&quot;}}}</span></tt>)</p>
<div class="section" id="id12">
<h4>Example<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>Request:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">[</span>
    <span class="s2">&quot;set_data&quot;</span><span class="p">,</span>
    <span class="p">[{</span>
        <span class="nt">&quot;mas_0.agent_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;pvsim_0.pv_0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;P_target&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                                           <span class="nt">&quot;Q_target&quot;</span><span class="p">:</span> <span class="mf">3.14</span><span class="p">}},</span>
        <span class="nt">&quot;mas_0.agent_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;pvsim_0.pv_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;P_target&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
                                           <span class="nt">&quot;Q_target&quot;</span><span class="p">:</span> <span class="mf">2.718</span><span class="p">}}</span>
    <span class="p">}],</span>
    <span class="p">{}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Reply:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="kc">null</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="high-level.html" class="btn btn-neutral float-right" title="The high-level API"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral" title="How mosaik communicates with a simulator"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright 2013, Stefan Scherfke.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>