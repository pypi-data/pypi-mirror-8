

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The simulator manager &mdash; mosaik 2.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'2.0',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="mosaik 2.0 documentation" href="index.html"/>
        <link rel="next" title="Scheduling and simulation execution" href="scheduler.html"/>
        <link rel="prev" title="Scenario definition" href="scenario-definition.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> mosaik</a>
        <form class="wy-form" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#linux">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#os-x">OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#what-s-mosaik-supposed-to-do">What&#8217;s mosaik supposed to do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#mosaik-s-main-components">Mosaik&#8217;s main components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ecosystem.html">The mosaik ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/examplesim.html">Integrating a simulation model into the mosaik ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/demo1.html">Creating and running simple simulation scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/examplectrl.html">Adding a control mechanism to a scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/demo2.html">Integrating a control mechanism</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mosaik-api/index.html">The mosaik API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mosaik-api/overview.html">How mosaik communicates with a simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="mosaik-api/low-level.html">The low-level API</a></li>
<li class="toctree-l2"><a class="reference internal" href="mosaik-api/high-level.html">The high-level API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scenario-definition.html">Scenario definition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#the-setup">The setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#starting-simulators">Starting simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#instantiating-simulation-models">Instantiating simulation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#connecting-entities">Connecting entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#running-the-simulation">Running the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-achieve-bi-directional-data-flows">How to achieve bi-directional data-flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-filter-entity-sets">How to filter entity sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-create-user-defined-connection-rules">How to create user-defined connection rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-retrieve-static-data-from-entities">How to retrieve static data from entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-access-topology-and-data-flow-information">How to access topology and data-flow information</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-destroy-a-world">How to destroy a world</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-to-real-time-simulations">How to to real-time simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenario-definition.html#how-to-call-extra-methods-of-a-simulator">How to call extra methods of a simulator</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">The simulator manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduler.html">Scheduling and simulation execution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html#anatomy-of-a-step">Anatomy of a step</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html#synchronization-and-data-flows">Synchronization and data-flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html#cyclic-data-flows">Cyclic data-flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html#stepping-and-simulation-duration">Stepping and simulation duration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#general-questions">General questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#coupling-models-with-mosaik">Coupling models with mosaik</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#the-mosaik-demo">The mosaik demo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev/index.html">Developer&#8217;s Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev/setup.html">Development setup and tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/release_process.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/requirements.html">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/design-decisions.html">Discussion of design decisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/logo-ci.html">Logo and corporate identity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_reference/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_reference/mosaik.html"><tt class="docutils literal"><span class="pre">mosaik</span></tt> &#8212; The ende-user API</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference/mosaik.exceptions.html"><tt class="docutils literal"><span class="pre">mosaik.exceptions</span></tt> &#8212; mosaik specific error types</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference/mosaik.scenario.html"><tt class="docutils literal"><span class="pre">mosaik.scenario</span></tt> &#8212; Classes related to the scenario creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference/mosaik.scheduler.html"><tt class="docutils literal"><span class="pre">mosaik.scheduler</span></tt> &#8212; Coordinate and execute simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference/mosaik.simmanager.html"><tt class="docutils literal"><span class="pre">mosaik.simmanager</span></tt> &#8212; Management of external processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference/mosaik.util.html"><tt class="docutils literal"><span class="pre">mosaik.util</span></tt> &#8212; Utility classes and functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="about/index.html">About mosaik</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about/acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="about/history.html">The history of mosaik</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">mosaik</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="index.html">Docs</a> &raquo;</li>
  <li><a href="">The simulator manager</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="the-simulator-manager">
<h1>The simulator manager<a class="headerlink" href="#the-simulator-manager" title="Permalink to this headline">¶</a></h1>
<p>The simulator manager (or just <em>sim manager</em>) is responsible for starting and
handling the external simulator processes involved in a simulation as well as
for the communication with them.</p>
<p>Usually, these simulators will be started as separate sub-processes which will
then connect to mosaik via network sockets. This has two benefits:</p>
<ol class="arabic simple">
<li>Simulators can be written in any language.</li>
<li>Simulation steps can be performed in parallel, if two processes don&#8217;t depend
on each others data.</li>
</ol>
<p>Simulators written in Python 3 can, for performance reasons, be imported and
executed like normal Python modules. This way, all Sim API calls will be plain
functions calls without the overhead of network communication and message
(de)serialization. However, since Python only runs in one thread at a time,
this will also prevent parallel execution of simulators.</p>
<p>When a (Python 3) simulator is computationally inexpensive, running it
in-process may give you good results. If it performs a lot of expensive
computations, it may be better to start separate processes which can then do
these computations in parallel. In practice, you should try and profile both
ways in order to get the maximum performance out of it.</p>
<p>Sometimes, both ways won&#8217;t work because you simply cannot start the simulator
process by yourself. This might be the reason for hardware-in-the-loop or if
a simulator needs to run on a separate machine. In these cases, you can simply
let mosaik connect to a running instance of such a simulator.</p>
<p>Internally, all three kinds of simulator processes (in-process with mosaik,
started by mosaik, connected to by mosaik) are represented by <em>SimProxy</em>
objects so that they all look the same to the other components of mosaik:</p>
<a class="reference internal image-reference" href="_images/simmanager.svg"><div align="center" class="align-center"><img alt="The sim manager can import Python simulators, can start simulators as sub-processes and can connect to running instances of a simulator." src="_images/simmanager.svg" width="530" /></div>
</a>
<p>The sim manager gets its configuration via the <a class="reference internal" href="api_reference/mosaik.scenario.html#mosaik.scenario.World" title="mosaik.scenario.World"><tt class="xref py py-class docutils literal"><span class="pre">World</span></tt></a>’s <em>sim_config</em> argument. The <em>sim_config</em> is a dictionary containing simulator
names and description of how to start them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mosaik</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_config</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s">&#39;SimA&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;python&#39;</span><span class="p">:</span> <span class="s">&#39;package.module:SimClass&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s">&#39;SimB&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;cmd&#39;</span><span class="p">:</span> <span class="s">&#39;java -jar simB.jar </span><span class="si">%(addr)s</span><span class="s">&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;cwd&#39;</span><span class="p">:</span> <span class="s">&#39;simB/dist/&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s">&#39;SimC&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;connect&#39;</span><span class="p">:</span> <span class="s">&#39;localhost:5678&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span><span class="p">}</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">world</span> <span class="o">=</span> <span class="n">mosaik</span><span class="o">.</span><span class="n">World</span><span class="p">(</span><span class="n">sim_config</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above, we declare three different simulators. You can freely
choose a name for a simulator. Its configuration should either contain
a <em>python</em>, <em>cmd</em> or <em>connect</em> entry:</p>
<dl class="docutils">
<dt><em>python</em></dt>
<dd>This tells mosaik to run the simulator in process. As a value, you need to
specify the module and class name of the simulator separated by a colon.
In the example, mosaik will <tt class="docutils literal"><span class="pre">import</span> <span class="pre">package.module</span></tt> and instantiate <tt class="docutils literal"><span class="pre">sim</span>
<span class="pre">=</span> <span class="pre">package.module.SimClass()</span></tt>. This only works for simulators written in
Python 3.</dd>
<dt><em>cmd</em></dt>
<dd><p class="first">This tells mosaik to execute the specified command <em>cmd</em> in order to start a
new sub-process for the simulator.</p>
<p>In order to create a socket connection to mosaik the simulator needs to know
the address of mosaik&#8217;s server socket. Mosaik will pass this address (in the
form <tt class="docutils literal"><span class="pre">host:port</span></tt>) as a command line argument, so you need to include the
placeholder <tt class="docutils literal"><span class="pre">%(addr)s</span></tt> in your command. Mosaik will replace this with the
actual address.</p>
<p>You can optionally specify a current working directory <em>(cwd)</em>. If it is
present, mosaik will change to that directory before executing <em>cmd</em>. Its
default value is <tt class="docutils literal"><span class="pre">'.'</span></tt>.</p>
<p>In our example, mosaik would execute:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>simB/java
<span class="nv">$ </span>java -jar simB.jar localhost:5555
</pre></div>
</div>
<p class="last">in order to start <em>SimB</em>.</p>
</dd>
<dt><em>connect</em></dt>
<dd>This tells mosaik to establish a network connection to a running simulator
instance. It will simply connect to <tt class="docutils literal"><span class="pre">host:port</span></tt> – <tt class="docutils literal"><span class="pre">localhost:5678</span></tt> for
<em>SimC</em></dd>
</dl>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="scheduler.html" class="btn btn-neutral float-right" title="Scheduling and simulation execution"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="scenario-definition.html" class="btn btn-neutral" title="Scenario definition"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright 2013, Stefan Scherfke.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>