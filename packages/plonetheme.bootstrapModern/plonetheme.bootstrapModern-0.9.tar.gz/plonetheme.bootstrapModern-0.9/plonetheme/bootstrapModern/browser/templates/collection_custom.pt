<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
<body>

  <div metal:fill-slot="content-core"  tal:define="showall python:True"> 
    <metal:block define-macro="content-core"
                 tal:define="kssClassesView context/@@kss_field_decorator_view;
                             getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                             templateId template/getId">

    <div class="tileColumns container-fluid">
      <div class="row-fluid">
      
        <metal:listingmacro define-macro="listing">
        <tal:results define="b_start python:request.get('b_start', 0);
                 batch python:view.results(b_start=b_start, pagesize=30, only_documented=not showall);
                 site_properties context/portal_properties/site_properties;
                 use_view_action site_properties/typesUseViewActionInListings|python:();
                 isAnon context/@@plone_portal_state/anonymous;
                 normalizeString nocall: context/plone_utils/normalizeString;
                 toLocalizedTime nocall: context/@@plone/toLocalizedTime;
                 show_about python:not isAnon or site_properties.allowAnonymousViewAbout;
                 navigation_root_url context/@@plone_portal_state/navigation_root_url;
                 pas_member context/@@pas_member;">
        <tal:listing condition="batch">

        <metal:block metal:define-slot="entries">
            <tal:entry tal:repeat="item batch" metal:define-macro="entries">
            <tal:block tal:define="item_id item/getId;
                       item_description item/Description;
                       item_type item/Type;
                       item_url python:item_type == 'Media Event' and '%s'%item.getURL() or item.getURL();
                       item_modified item/ModificationDate;
                       item_created item/CreationDate;
                       item_icon item/getIcon;
                       item_wf_state_class python:'state-' + normalizeString(item.review_state);
                       item_creator item/Creator;
                       item_start python:(item.start or item.StartDate) if item_type == 'Media Event' else None;
                       item_end python:(item.end) if item_type == 'Media Event' else None;
                       item_modified item/ModificationDate;
                       odd repeat/item/odd;
                       even repeat/item/even;
                       first repeat/item/start;
                       number repeat/item/number;
                       item_link python: (item_type == 'Press Kit' and not view.checkPermission(item, 'Add portal content')) and item_url + '/download_zip' or (item_type in use_view_action and item_url+'/view' or item_url);">
            
            <metal:block define-slot="entry">
            <!-- ITEM -->
              <tal:nospace condition="python: (number-1) % 3 == 0">
              <div class="span4 no-space" metal:define-macro="listitemnspace">
                <div class="thumbnail">
                  <a class="thumb-image" tal:condition="python: item.hasMedia or item.portal_type == 'Image'" href="" tal:attributes="href item_link">
                    <tal:image replace="structure python:view.getLeadMediaTag(item, scale='collection')"></tal:image>
                  </a>
                  
                  
                  <div class="caption">
                    <h3><a href="#"
                       tal:attributes="href item_link"
                       tal:content="python:item.Title">
                    Title
                    </a></h3>
                    <p>
                      <span tal:condition="python:item.Description != '' " tal:replace="python:view.trimText(item.Description, 200, strip=False)"></span>
                      
                      <tal:bodyfallback condition="python:item.Description == '' and item_type != 'Image' and item_type != 'File' and item_type != 'Folder' and item_type != 'Press Kit'">
                      <span tal:condition="python: getattr(item.getObject(), 'text', False)" tal:replace="python:view.trimText(item.getObject().text, 200, strip=True)"></span>
                      </tal:bodyfallback>
                    </p> 
                  </div>
                </div>
               
            </div>
            </tal:nospace> 

            <tal:space condition="python: (number-1) % 3 != 0">
              <div class="span4" metal:define-macro="listitem">
                <div class="thumbnail">
                  <a class="thumb-image" tal:condition="python: item.hasMedia or item.portal_type == 'Image'" href="" tal:attributes="href item_link">
                    <tal:image replace="structure python:view.getLeadMediaTag(item, scale='collection')"></tal:image>
                  </a>
                  
                  
                  <div class="caption">
                    <h3><a href="#"
                       tal:attributes="href item_link"
                       tal:content="python:item.Title">
                    Title
                    </a></h3>
                    <p>
                      <span tal:condition="python:item.Description != '' " tal:replace="python:view.trimText(item.Description, 200, strip=False)"></span>
                      
                      <tal:bodyfallback condition="python:item.Description == '' and item_type != 'Image' and item_type != 'File' and item_type != 'Folder' and item_type != 'Press Kit'">
                      <span tal:condition="python: getattr(item.getObject(), 'text', False)" tal:replace="python:view.trimText(item.getObject().text, 200, strip=True)"></span>
                      </tal:bodyfallback>
                    </p> 
                  </div>
                </div>
            </div>
            </tal:space> 

            <tal:clearfix condition="python: number % 3 == 0">
              <div class="clearfix"></div>
            </tal:clearfix> 
            
            </metal:block>
            </tal:block>
            </tal:entry>

        </metal:block>
        
        <div metal:use-macro="context/batch_macros/macros/navigation" />
    
        </tal:listing>
        <metal:empty metal:define-slot="no_items_in_listing">
        <p class="discreet"
           tal:condition="not: batch">
            There is currently no content in this section.
        </p>
        </metal:empty>
    
        </tal:results>
        </metal:listingmacro>

    </div>
  </div>
    
    </metal:block>
  </div>

</body>
</html>
