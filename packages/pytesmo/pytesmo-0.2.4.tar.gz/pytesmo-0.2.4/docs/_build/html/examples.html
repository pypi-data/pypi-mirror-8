

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; pytesmo 0.2.4 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="pytesmo 0.2.4 documentation" href="index.html"/>
        <link rel="next" title="pytesmo package" href="_rst/pytesmo.html"/>
        <link rel="prev" title="Introduction to pytesmo a python Toolbox for the Evaluation of Soil Moisture Observations" href="introduction.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> pytesmo</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to pytesmo a python Toolbox for the Evaluation of Soil Moisture Observations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#supported-datasets">Supported Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#contribute">Contribute</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-plotting-ascat-h25-data-from-netcdf-format">Reading and plotting ASCAT H25 data from netCDF format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-plotting-h-saf-images">Reading and plotting H-SAF images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-h-saf-images">Reading H-SAF images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-the-h07-product">Reading the H07 product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-the-h08-product">Reading the H08 product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-the-h14-product">Reading the H14 product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-plotting-data-from-the-ismn">Reading and plotting data from the ISMN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculating-anomalies-and-climatologies">Calculating anomalies and climatologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-ascat-and-insitu-data-from-the-ismn">Comparing ASCAT and insitu data from the ISMN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-plotting-ascat-data-from-binary-format">Reading and plotting ASCAT data from binary format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="_rst/pytesmo.html">pytesmo package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#module-pytesmo.df_metrics">pytesmo.df_metrics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#module-pytesmo.metrics">pytesmo.metrics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#module-pytesmo.scaling">pytesmo.scaling module</a></li>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#module-pytesmo.temporal_matching">pytesmo.temporal_matching module</a></li>
<li class="toctree-l2"><a class="reference internal" href="_rst/pytesmo.html#module-contents">Module contents</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">pytesmo</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Examples</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/examples.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="examples">
<span id="examples-page"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="reading-and-plotting-ascat-h25-data-from-netcdf-format">
<h2>Reading and plotting ASCAT H25 data from netCDF format<a class="headerlink" href="#reading-and-plotting-ascat-h25-data-from-netcdf-format" title="Permalink to this headline">¶</a></h2>
<p>This Example script reads and plots ASCAT H25 SSM data with different masking options
and also converts the data to absolute values using the included porosity data.
It can be found in the /examples folder of the pytesmo package under the name read_ASCAT_H25.py</p>
<p>If the standard file names assumed by the script have changed this can be specified during initialization of the AscatH25_SSM object.
Please see the documentation of <a class="reference internal" href="_rst/pytesmo.io.sat.html#pytesmo.io.sat.ascat.AscatH25_SSM" title="pytesmo.io.sat.ascat.AscatH25_SSM"><tt class="xref py py-class docutils literal"><span class="pre">pytesmo.io.sat.ascat.AscatH25_SSM</span></tt></a></p>
<p>In[1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pytesmo.io.sat.ascat</span> <span class="kn">as</span> <span class="nn">ascat</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">ascat_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;R:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;Datapool_processed&#39;</span><span class="p">,</span><span class="s">&#39;WARP&#39;</span><span class="p">,</span><span class="s">&#39;WARP5.5&#39;</span><span class="p">,</span>
                                         <span class="s">&#39;ASCAT_WARP5.5_R1.2&#39;</span><span class="p">,</span><span class="s">&#39;080_ssm&#39;</span><span class="p">,</span><span class="s">&#39;netcdf&#39;</span><span class="p">)</span>
<span class="n">ascat_grid_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;R:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;Datapool_processed&#39;</span><span class="p">,</span><span class="s">&#39;WARP&#39;</span><span class="p">,</span><span class="s">&#39;ancillary&#39;</span><span class="p">,</span><span class="s">&#39;warp5_grid&#39;</span><span class="p">)</span>
<span class="c">#init the ASCAT_SSM reader with the paths</span>

<span class="c">#ascat_folder is the path in which the cell files are located e.g. TUW_METOP_ASCAT_WARP55R12_0600.nc</span>
<span class="c">#ascat_grid_folder is the path in which the file TUW_WARP5_grid_info_2_1.nc is located</span>

<span class="c">#let&#39;s not include the orbit direction since it is saved as &#39;A&#39;</span>
<span class="c">#or &#39;D&#39; it can not be plotted</span>

<span class="c"># the AscatH25_SSM class automatically detects the version of data that you have in your</span>
<span class="c"># ascat_folder. Please do not mix files of different versions in one folder</span>
<span class="n">ascat_SSM_reader</span> <span class="o">=</span> <span class="n">ascat</span><span class="o">.</span><span class="n">AscatH25_SSM</span><span class="p">(</span><span class="n">ascat_folder</span><span class="p">,</span><span class="n">ascat_grid_folder</span><span class="p">,</span>
                                      <span class="n">include_in_df</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;sm&#39;</span><span class="p">,</span> <span class="s">&#39;sm_noise&#39;</span><span class="p">,</span> <span class="s">&#39;ssf&#39;</span><span class="p">,</span> <span class="s">&#39;proc_flag&#39;</span><span class="p">])</span>

<span class="n">gpi</span> <span class="o">=</span> <span class="mi">2329253</span>
<span class="n">ascat_ts</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="n">gpi</span><span class="p">)</span>

<span class="n">ascat_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/read_ASCAT_H25_0_0.png" src="_images/read_ASCAT_H25_0_0.png" />
<p>In[2]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#the ASCATTimeSeries object also contains metadata</span>

<span class="k">print</span> <span class="s">&quot;Topographic complexity&quot;</span><span class="p">,</span> <span class="n">ascat_ts</span><span class="o">.</span><span class="n">topo_complex</span>
<span class="k">print</span> <span class="s">&quot;Wetland fraction&quot;</span><span class="p">,</span> <span class="n">ascat_ts</span><span class="o">.</span><span class="n">wetland_frac</span>
<span class="k">print</span> <span class="s">&quot;Porosity from GLDAS model&quot;</span><span class="p">,</span> <span class="n">ascat_ts</span><span class="o">.</span><span class="n">porosity_gldas</span>
<span class="k">print</span> <span class="s">&quot;Porosity from Harmonized World Soil Database&quot;</span><span class="p">,</span> <span class="n">ascat_ts</span><span class="o">.</span><span class="n">porosity_hwsd</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Topographic complexity 14
Wetland fraction 0
Porosity from GLDAS model 0.542222
Porosity from Harmonized World Soil Database 0.430234
</pre></div>
</div>
<p>In[3]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#It is also possible to automatically convert the soil moisture to absolute values using</span>

<span class="n">ascat_ts_absolute</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="n">gpi</span><span class="p">,</span> <span class="n">absolute_values</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c">#this introduces 4 new columns in the returned data</span>
<span class="c">#scaled sm and sm_noise with porosity_gldas</span>
<span class="c">#scaled sm and sm_noise with porosity_hwsd</span>
<span class="k">print</span> <span class="n">ascat_ts_absolute</span><span class="o">.</span><span class="n">data</span>

<span class="c">#select relevant columns and plot</span>
<span class="n">ascat_ts_absolute</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ascat_ts_absolute</span><span class="o">.</span><span class="n">data</span><span class="p">[[</span><span class="s">&#39;sm_por_gldas&#39;</span><span class="p">,</span><span class="s">&#39;sm_por_hwsd&#39;</span><span class="p">]]</span>
<span class="n">ascat_ts_absolute</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 2292 entries, 2007-01-01 09:39:39 to 2013-07-12 20:39:08
Data columns (total 10 columns):
proc_flag             2292  non-null values
sm                    2285  non-null values
sm_noise              2285  non-null values
ssf                   2292  non-null values
sm_por_gldas          2285  non-null values
sm_noise_por_gldas    2285  non-null values
sm_por_hwsd           2285  non-null values
sm_noise_por_hwsd     2285  non-null values
frozen_prob           2285  non-null values
snow_prob             2285  non-null values
dtypes: float64(8), int16(1), int8(1)
</pre></div>
</div>
<img alt="_images/read_ASCAT_H25_2_1.png" src="_images/read_ASCAT_H25_2_1.png" />
<p>In[4]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#We can also automatically mask the data during reading</span>
<span class="c">#In this example all measurements where the Surface State Flag</span>
<span class="c">#shows frozen or where the frozen or snow probabilities are more</span>
<span class="c">#than 10 percent are removed from the time series</span>
<span class="n">ascat_ts</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="n">gpi</span><span class="p">,</span> <span class="n">mask_ssf</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                     <span class="n">mask_frozen_prob</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                     <span class="n">mask_snow_pro</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">ascat_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/read_ASCAT_H25_3_0.png" src="_images/read_ASCAT_H25_3_0.png" />
</div>
<div class="section" id="reading-and-plotting-h-saf-images">
<h2>Reading and plotting H-SAF images<a class="headerlink" href="#reading-and-plotting-h-saf-images" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://hsaf.meteoam.it/soil-moisture.php">H-SAF</a> provides three different image products:</p>
<ul class="simple">
<li>SM OBS 1 - H07 - Large scale surface soil moisture by radar scatterometer in BUFR format over Europe</li>
<li>SM OBS 2 - H08 - Small scale surface soil moisture by radar scatterometer in BUFR format over Europe</li>
<li>SM DAS 2 - H14 - Profile index in the roots region by scatterometer data assimilation in GRIB format, global</li>
</ul>
<p>The following example will show how to read and plot each of them.
It can be found in the /examples folder of the pytesmo package under the name Read_H_SAF_images.py</p>
</div>
<div class="section" id="reading-h-saf-images">
<h2>Reading H-SAF images<a class="headerlink" href="#reading-h-saf-images" title="Permalink to this headline">¶</a></h2>
<p>In this Example we will read and plot images of the H-SAF products H07, H08 and H14.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytesmo.io.sat.h_saf</span> <span class="kn">as</span> <span class="nn">h_saf</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c">#set the paths to the image files</span>
<span class="c">#I&#39;m using the test images included in the pytesmo package</span>

<span class="n">test_data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="s">&#39;home&#39;</span><span class="p">,</span><span class="s">&#39;pydev&#39;</span><span class="p">,</span><span class="s">&#39;pytesmo&#39;</span><span class="p">,</span><span class="s">&#39;tests&#39;</span><span class="p">,</span><span class="s">&#39;test_sat&#39;</span><span class="p">,</span><span class="s">&#39;test_data&#39;</span><span class="p">,</span><span class="s">&#39;h_saf&#39;</span><span class="p">)</span>
<span class="n">h07_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_data_path</span><span class="p">,</span> <span class="s">&#39;h07&#39;</span><span class="p">)</span>
<span class="n">h08_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_data_path</span><span class="p">,</span> <span class="s">&#39;h08&#39;</span><span class="p">)</span>
<span class="n">h14_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_data_path</span><span class="p">,</span> <span class="s">&#39;h14&#39;</span><span class="p">)</span>

<span class="c">#initialize the readers with the path</span>
<span class="n">h07_reader</span> <span class="o">=</span> <span class="n">h_saf</span><span class="o">.</span><span class="n">H07img</span><span class="p">(</span><span class="n">h07_path</span><span class="p">)</span>
<span class="n">h08_reader</span> <span class="o">=</span> <span class="n">h_saf</span><span class="o">.</span><span class="n">H08img</span><span class="p">(</span><span class="n">h08_path</span><span class="p">)</span>
<span class="n">h14_reader</span> <span class="o">=</span> <span class="n">h_saf</span><span class="o">.</span><span class="n">H14img</span><span class="p">(</span><span class="n">h14_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-the-h07-product">
<h2>Reading the H07 product<a class="headerlink" href="#reading-the-h07-product" title="Permalink to this headline">¶</a></h2>
<p>pytesmo includes one h07 image with the timestamp 2010-05-01 08:33:01
We can either read this image alone if we know the timestamp or iterate over all images on 2010-05-01.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#the reader returns not only the data but also metadata and the longitudes and latitudes</span>
<span class="n">h07_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">time_var</span> <span class="o">=</span> <span class="n">h07_reader</span><span class="o">.</span><span class="n">read_img</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>let&#8217;s inspect the data</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">h07_data</span><span class="p">)</span>
<span class="c"># the data is a dictionary, each dictionary key contains the array of one variable</span>
<span class="k">print</span> <span class="s">&quot;The following variables are in this image&quot;</span><span class="p">,</span> <span class="n">h07_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;type &#39;dict&#39;&gt;
The following variables are in this image [&#39;snow_cover&#39;, &#39;topo_complex&#39;, &#39;ssm&#39;, &#39;jd&#39;, &#39;ssm_noise&#39;, &#39;frozen_prob&#39;]
</pre></div>
</div>
<p>let&#8217;s inspect surface soil moisture (ssm)</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">h07_data</span><span class="p">[</span><span class="s">&#39;ssm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="c"># it is only a 1D array to plot the data we also need latitude and logitude information</span>
<span class="k">print</span> <span class="n">lons</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">lats</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">1017</span><span class="p">,)</span>
<span class="p">(</span><span class="mi">1017</span><span class="p">,)</span>
<span class="p">(</span><span class="mi">1017</span><span class="p">,)</span>
</pre></div>
</div>
<p>let&#8217;s resample and plot the ssm data
H07 data is not that easy to plot because it comes in orbit geometry and not on a fixed grid.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="kn">import</span> <span class="nn">pytesmo.colormaps.load_cmap</span> <span class="kn">as</span> <span class="nn">smcolormaps</span>
<span class="kn">import</span> <span class="nn">pytesmo.grid.resample</span> <span class="kn">as</span> <span class="nn">resample</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="c">#lets resample to a 0.1 degree grid</span>
<span class="c">#define the grid points in latitude and logitude</span>
<span class="n">lats_dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">lons_dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c">#make 2d grid out the 1D grid spacings</span>
<span class="n">lons_grid</span><span class="p">,</span> <span class="n">lats_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons_dim</span><span class="p">,</span><span class="n">lats_dim</span><span class="p">)</span>

<span class="n">resampled_data</span> <span class="o">=</span> <span class="n">resample</span><span class="o">.</span><span class="n">resample_to_grid</span><span class="p">(</span><span class="n">h07_data</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span>
                                           <span class="n">lons_grid</span><span class="p">,</span> <span class="n">lats_grid</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
<span class="c"># setup of basemap for europe</span>
<span class="c"># simple mercator projection</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=-</span><span class="mf">25.0</span><span class="p">,</span><span class="n">llcrnrlat</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span><span class="n">urcrnrlon</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span><span class="n">urcrnrlat</span><span class="o">=</span><span class="mf">75.0</span><span class="p">,</span>\
            <span class="n">resolution</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span><span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;merc&#39;</span><span class="p">,</span>\
            <span class="n">lat_ts</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c"># make a pseudocolor plot using the ASCAT SWI colormap</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lons_grid</span><span class="p">,</span> <span class="n">lats_grid</span><span class="p">,</span> <span class="n">resampled_data</span><span class="p">[</span><span class="s">&#39;ssm&#39;</span><span class="p">],</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="n">cmap</span><span class="o">=</span><span class="n">smcolormaps</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;SWI_ASCAT&#39;</span><span class="p">))</span>

<span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>
<span class="c"># draw parallels and meridians.</span>
<span class="c"># label on left and bottom of map.</span>
<span class="n">parallels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="c"># add colorbar</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="s">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s">&#39;2%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;H07 Soil Moisture in %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/Read_H_SAF_images_11_0.png" src="_images/Read_H_SAF_images_11_0.png" />
</div>
<div class="section" id="reading-the-h08-product">
<h2>Reading the H08 product<a class="headerlink" href="#reading-the-h08-product" title="Permalink to this headline">¶</a></h2>
<p>H08 data has a much higher resolution and comes on a 0.00416 degree grid.</p>
<p>The sample data included in pytesmo was observed on the same time as the included H07 product.</p>
<p>Instead of read_img you can also use the daily_images iterator.</p>
<p>You just specify a day and it will read all the images that are in your folder for this day.</p>
<p>This also works for the other H07 and H14 reader.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#the reader returns not only the data but also metadata and the longitudes and latitudes</span>
<span class="k">for</span> <span class="n">h08_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">time_var</span> <span class="ow">in</span> <span class="n">h08_reader</span><span class="o">.</span><span class="n">daily_images</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)):</span>
    <span class="c"># this tells you the exact timestamp of the read image</span>
    <span class="k">print</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

    <span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">h08_data</span><span class="p">)</span>
    <span class="c"># the data is a dictionary, each dictionary key contains the array of one variable</span>
    <span class="k">print</span> <span class="s">&quot;The following variables are in this image&quot;</span><span class="p">,</span> <span class="n">h08_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">h08_data</span><span class="p">[</span><span class="s">&#39;ssm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">print</span> <span class="n">lons</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">print</span> <span class="n">lats</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>2010-05-01T08:33:01
&lt;type &#39;dict&#39;&gt;
The following variables are in this image [&#39;ssm&#39;, &#39;proc_flag&#39;, &#39;ssm_noise&#39;, &#39;corr_flag&#39;]
(3120, 7680)
(3120, 7680)
(3120, 7680)
</pre></div>
</div>
<p>In our case only one image is in the folder so the loop exits after this image is read.</p>
<p>The data has higher resolution but it already comes as a 2D image.</p>
<p>Let&#8217;s plot it.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
<span class="c"># setup of basemap for europe but zoomed in little bit</span>
<span class="c"># simple mercator projection</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">llcrnrlat</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span><span class="n">urcrnrlon</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span><span class="n">urcrnrlat</span><span class="o">=</span><span class="mf">75.0</span><span class="p">,</span>\
            <span class="n">resolution</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span><span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;merc&#39;</span><span class="p">,</span>\
            <span class="n">lat_ts</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c"># make a pseudocolor plot using the ASCAT SWI colormap</span>
<span class="c"># latitudes and data have to be flipped upside down because the latitudes</span>
<span class="c"># have to be in ascending order to be plotted correctly</span>
<span class="c"># mask values &gt; 100 so that they are not plotted</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">h08_data</span><span class="p">[</span><span class="s">&#39;ssm&#39;</span><span class="p">]),</span><span class="mi">100</span><span class="p">),</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">smcolormaps</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;SWI_ASCAT&#39;</span><span class="p">))</span>

<span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>
<span class="c"># draw parallels and meridians.</span>
<span class="c"># label on left and bottom of map.</span>
<span class="n">parallels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="c"># add colorbar</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="s">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s">&#39;2%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;H08 Soil Moisture in %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/Read_H_SAF_images_16_0.png" src="_images/Read_H_SAF_images_16_0.png" />
<div class="section" id="reading-only-area-of-interest">
<h3>Reading only area of interest<a class="headerlink" href="#reading-only-area-of-interest" title="Permalink to this headline">¶</a></h3>
<p>H08 has a very high resolution, so most people will only want to read it for their area of interest. This can be done using the lat_lon_bbox keyword</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#the reader returns not only the data but also metadata and the longitudes and latitudes</span>
<span class="n">h08_roi</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">time_var</span> <span class="o">=</span> <span class="n">h08_reader</span><span class="o">.</span><span class="n">read_img</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                                                                         <span class="n">lat_lon_bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
<span class="c"># setup of basemap for europe but zoomed in little bit</span>
<span class="c"># simple mercator projection</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">llcrnrlat</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span><span class="n">urcrnrlon</span><span class="o">=</span><span class="mf">45.0</span><span class="p">,</span><span class="n">urcrnrlat</span><span class="o">=</span><span class="mf">75.0</span><span class="p">,</span>\
            <span class="n">resolution</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span><span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;merc&#39;</span><span class="p">,</span>\
            <span class="n">lat_ts</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c"># make a pseudocolor plot using the ASCAT SWI colormap</span>
<span class="c"># latitudes and data have to be flipped upside down because the latitudes</span>
<span class="c"># have to be in ascending order to be plotted correctly</span>
<span class="c"># mask values &gt; 100 so that they are not plotted</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">h08_roi</span><span class="p">[</span><span class="s">&#39;ssm&#39;</span><span class="p">]),</span><span class="mi">100</span><span class="p">),</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
         <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">smcolormaps</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;SWI_ASCAT&#39;</span><span class="p">))</span>

<span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>
<span class="c"># draw parallels and meridians.</span>
<span class="c"># label on left and bottom of map.</span>
<span class="n">parallels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="c"># add colorbar</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="s">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s">&#39;2%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;H08 Soil Moisture in %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/Read_H_SAF_images_19_0.png" src="_images/Read_H_SAF_images_19_0.png" />
</div>
</div>
<div class="section" id="reading-the-h14-product">
<h2>Reading the H14 product<a class="headerlink" href="#reading-the-h14-product" title="Permalink to this headline">¶</a></h2>
<p>The H14 product is a global product on a reduced gaussian grid with a resolution of approx. 25km.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#the reader returns not only the data but also metadata and the longitudes and latitudes</span>
<span class="n">h14_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">time_var</span> <span class="o">=</span> <span class="n">h14_reader</span><span class="o">.</span><span class="n">read_img</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">h14_data</span><span class="p">)</span>
<span class="c"># the data is a dictionary, each dictionary key contains the array of one variable</span>
<span class="k">print</span> <span class="s">&quot;The following variables are in this image&quot;</span><span class="p">,</span> <span class="n">h14_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;type &#39;dict&#39;&gt;
The following variables are in this image [&#39;SM_layer1_0-7cm&#39;, &#39;SM_layer2_7-28cm&#39;, &#39;SM_layer3_28-100cm&#39;, &#39;SM_layer4_100-289cm&#39;]
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">h14_data</span><span class="p">[</span><span class="s">&#39;SM_layer1_0-7cm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">lons</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">lats</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">)</span>
<span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">)</span>
<span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">)</span>
</pre></div>
</div>
<p>The data comes as a 2D array. If the keyword expand_grid is set to False during reader initialization then only 1D arrays would be returned.</p>
<p>This can be good for working with the data but for plotting the expanded grid is easier to handle.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">h14_reader_1d</span> <span class="o">=</span> <span class="n">h_saf</span><span class="o">.</span><span class="n">H14img</span><span class="p">(</span><span class="n">h14_path</span><span class="p">,</span> <span class="n">expand_grid</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c">#the reader returns not only the data but also metadata and the longitudes and latitudes</span>
<span class="n">h14_data_1d</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">lons_1d</span><span class="p">,</span> <span class="n">lats_1d</span><span class="p">,</span> <span class="n">time_var</span> <span class="o">=</span> <span class="n">h14_reader_1d</span><span class="o">.</span><span class="n">read_img</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">print</span> <span class="n">h14_data_1d</span><span class="p">[</span><span class="s">&#39;SM_layer1_0-7cm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">lons_1d</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">lats_1d</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">843490</span><span class="p">,)</span>
<span class="p">(</span><span class="mi">843490</span><span class="p">,)</span>
<span class="p">(</span><span class="mi">843490</span><span class="p">,)</span>
</pre></div>
</div>
<p>Let&#8217;s plot all layers in the H14 image</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">h14_data</span><span class="p">:</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
    <span class="c"># setup of basemap for the world</span>
    <span class="c"># Robinson projection</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&#39;robin&#39;</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c"># make a pseudocolor plot using the ASCAT SWI colormap</span>
    <span class="c"># latitudes and data have to be flipped upside down because the latitudes</span>
    <span class="c"># have to be in ascending order to be plotted correctly</span>
    <span class="c"># mask values &gt; 100 so that they are not plotted</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">h14_data</span><span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
             <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">smcolormaps</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;SWI_ASCAT&#39;</span><span class="p">))</span>

    <span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>
    <span class="c"># draw parallels and meridians.</span>
    <span class="c"># label on left and bottom of map.</span>
    <span class="n">parallels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mf">30.</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mf">40.</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="c"># add colorbar</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="s">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s">&#39;2%&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;H14 {:}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">layer</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/Read_H_SAF_images_28_0.png" src="_images/Read_H_SAF_images_28_0.png" />
<img alt="_images/Read_H_SAF_images_28_1.png" src="_images/Read_H_SAF_images_28_1.png" />
<img alt="_images/Read_H_SAF_images_28_2.png" src="_images/Read_H_SAF_images_28_2.png" />
<img alt="_images/Read_H_SAF_images_28_3.png" src="_images/Read_H_SAF_images_28_3.png" />
</div>
<div class="section" id="reading-and-plotting-data-from-the-ismn">
<h2>Reading and plotting data from the ISMN<a class="headerlink" href="#reading-and-plotting-data-from-the-ismn" title="Permalink to this headline">¶</a></h2>
<p>This example program chooses a random Network and Station and plots the first variable,depth,sensor
combination. To see how to get data for a variable from all stations see the next example.</p>
<p>It can be found in the /examples folder of the pytesmo package under the name plot_ISMN_data.py.</p>
<p>In[1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytesmo.io.ismn.interface</span> <span class="kn">as</span> <span class="nn">ismn</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
<p>In[2]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#path unzipped file downloaded from the ISMN web portal</span>
<span class="c">#on windows the first string has to be your drive letter</span>
<span class="c">#like &#39;C:\\&#39;</span>
<span class="n">path_to_ismn_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;small_projects&#39;</span><span class="p">,</span><span class="s">&#39;cpa_2013_07_ISMN_userformat_reader&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;header_values_parser_test&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In[3]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#initialize interface, this can take up to a few minutes the first</span>
<span class="c">#time, since all metadata has to be collected</span>
<span class="n">ISMN_reader</span> <span class="o">=</span> <span class="n">ismn</span><span class="o">.</span><span class="n">ISMN_Interface</span><span class="p">(</span><span class="n">path_to_ismn_data</span><span class="p">)</span>

<span class="c">#plot available station on a map</span>
<span class="n">ISMN_reader</span><span class="o">.</span><span class="n">plot_station_locations</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ISMN_2_0.png" src="_images/plot_ISMN_2_0.png" />
<p>In[4]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#select random network and station to plot</span>
<span class="n">networks</span> <span class="o">=</span> <span class="n">ISMN_reader</span><span class="o">.</span><span class="n">list_networks</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&quot;Available Networks:&quot;</span>
<span class="k">print</span> <span class="n">networks</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Available Networks:
[&#39;OZNET&#39;]
</pre></div>
</div>
<p>In[5]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">network</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">networks</span><span class="p">)</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">ISMN_reader</span><span class="o">.</span><span class="n">list_stations</span><span class="p">(</span><span class="n">network</span> <span class="o">=</span> <span class="n">network</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Available Stations in Network </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">network</span>
<span class="k">print</span> <span class="n">stations</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Available Stations in Network OZNET
[&#39;Alabama&#39; &#39;Balranald-Bolton_Park&#39; &#39;Banandra&#39; &#39;Benwerrin&#39; &#39;Bundure&#39;
 &#39;Canberra_Airport&#39; &#39;Cheverelis&#39; &#39;Cooma_Airfield&#39; &#39;Cootamundra_Aerodrome&#39;
 &#39;Cox&#39; &#39;Crawford&#39; &#39;Dry_Lake&#39; &#39;Eulo&#39; &#39;Evergreen&#39; &#39;Ginninderra_K4&#39;
 &#39;Ginninderra_K5&#39; &#39;Griffith_Aerodrome&#39; &#39;Hay_AWS&#39; &#39;Keenan&#39; &#39;Kyeamba_Downs&#39;
 &#39;Kyeamba_Mouth&#39; &#39;Kyeamba_Station&#39; &#39;Rochedale&#39; &#39;S_Coleambally&#39; &#39;Samarra&#39;
 &#39;Silver_Springs&#39; &#39;Spring_Bank&#39; &#39;Strathvale&#39; &#39;Uri_Park&#39; &#39;Waitara&#39;
 &#39;Weeroona&#39; &#39;West_Wyalong_Airfield&#39; &#39;Widgiewa&#39; &#39;Wollumbi&#39; &#39;Wynella&#39;
 &#39;Yamma_Road&#39; &#39;Yammacoona&#39; &#39;Yanco_Research_Station&#39;]
</pre></div>
</div>
<p>In[6]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">station</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">stations</span><span class="p">)</span>
<span class="n">station_obj</span> <span class="o">=</span> <span class="n">ISMN_reader</span><span class="o">.</span><span class="n">get_station</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Available Variables at Station </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">station</span>
<span class="c">#get the variables that this station measures</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">station_obj</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()</span>
<span class="k">print</span> <span class="n">variables</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Available Variables at Station Evergreen
[&#39;precipitation&#39; &#39;soil moisture&#39; &#39;soil temperature&#39;]
</pre></div>
</div>
<p>In[7]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#to make sure the selected variable is not measured</span>
<span class="c">#by different sensors at the same depths</span>
<span class="c">#we also select the first depth and the first sensor</span>
<span class="c">#even if there is only one</span>
<span class="n">depths_from</span><span class="p">,</span><span class="n">depths_to</span> <span class="o">=</span> <span class="n">station_obj</span><span class="o">.</span><span class="n">get_depths</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">sensors</span> <span class="o">=</span> <span class="n">station_obj</span><span class="o">.</span><span class="n">get_sensors</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">depths_from</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">depths_to</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c">#read the data of the variable, depth, sensor combination</span>
<span class="n">time_series</span> <span class="o">=</span> <span class="n">station_obj</span><span class="o">.</span><span class="n">read_variable</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">depth_from</span><span class="o">=</span><span class="n">depths_from</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">depth_to</span><span class="o">=</span><span class="n">depths_to</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sensor</span><span class="o">=</span><span class="n">sensors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c">#print information about the selected time series</span>
<span class="k">print</span> <span class="s">&quot;Selected time series is:&quot;</span>
<span class="k">print</span> <span class="n">time_series</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Selected time series is:
OZNET Evergreen -0.50 m - -0.50 m precipitation measured with TB4-0.2-mm-tipping-bucket-raingauge
</pre></div>
</div>
<p>In[8]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#plot the data</span>
<span class="n">time_series</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c">#with pandas 0.12 time_series.plot() also works</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ISMN_7_0.png" src="_images/plot_ISMN_7_0.png" />
<p>In[9]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#we also want to see soil moisture</span>
<span class="n">sm_depht_from</span><span class="p">,</span><span class="n">sm_depht_to</span> <span class="o">=</span> <span class="n">station_obj</span><span class="o">.</span><span class="n">get_depths</span><span class="p">(</span><span class="s">&#39;soil moisture&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">sm_depht_from</span><span class="p">,</span><span class="n">sm_depht_to</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[ 0.   0.   0.3  0.6] [ 0.05  0.3   0.6   0.9 ]
</pre></div>
</div>
<p>In[10]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#read sm data measured in first layer 0-0.05m</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">station_obj</span><span class="o">.</span><span class="n">read_variable</span><span class="p">(</span><span class="s">&#39;soil moisture&#39;</span><span class="p">,</span><span class="n">depth_from</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">depth_to</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ISMN_9_0.png" src="_images/plot_ISMN_9_0.png" />
</div>
<div class="section" id="calculating-anomalies-and-climatologies">
<h2>Calculating anomalies and climatologies<a class="headerlink" href="#calculating-anomalies-and-climatologies" title="Permalink to this headline">¶</a></h2>
<p>This Example script reads and plots ASCAT H25 SSM data. The <a class="reference internal" href="_rst/pytesmo.time_series.html#module-pytesmo.time_series.anomaly" title="pytesmo.time_series.anomaly"><tt class="xref py py-mod docutils literal"><span class="pre">pytesmo.time_series.anomaly</span></tt></a> module
is then used to calculate anomalies and climatologies of the time series.
It can be found in the /examples folder of the pytesmo package under the name anomalies.py</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytesmo.io.sat.ascat</span> <span class="kn">as</span> <span class="nn">ascat</span>
<span class="kn">import</span> <span class="nn">pytesmo.time_series</span> <span class="kn">as</span> <span class="nn">ts</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ascat_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;R:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;Datapool_processed&#39;</span><span class="p">,</span><span class="s">&#39;WARP&#39;</span><span class="p">,</span><span class="s">&#39;WARP5.5&#39;</span><span class="p">,</span>
                                         <span class="s">&#39;ASCAT_WARP5.5_R1.2&#39;</span><span class="p">,</span><span class="s">&#39;080_ssm&#39;</span><span class="p">,</span><span class="s">&#39;netcdf&#39;</span><span class="p">)</span>
<span class="n">ascat_grid_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;R:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;Datapool_processed&#39;</span><span class="p">,</span><span class="s">&#39;WARP&#39;</span><span class="p">,</span><span class="s">&#39;ancillary&#39;</span><span class="p">,</span><span class="s">&#39;warp5_grid&#39;</span><span class="p">)</span>
<span class="c">#init the ASCAT_SSM reader with the paths</span>

<span class="n">ascat_SSM_reader</span> <span class="o">=</span> <span class="n">ascat</span><span class="o">.</span><span class="n">AscatH25_SSM</span><span class="p">(</span><span class="n">ascat_folder</span><span class="p">,</span><span class="n">ascat_grid_folder</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ascat_ts</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="c">#plot soil moisture</span>
<span class="n">ascat_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;sm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.axes.AxesSubplot at 0x22ee3550&gt;
</pre></div>
</div>
<img alt="_images/anomalies_2_1.png" src="_images/anomalies_2_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#calculate anomaly based on moving +- 17 day window</span>
<span class="n">anomaly</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">anomaly</span><span class="o">.</span><span class="n">calc_anomaly</span><span class="p">(</span><span class="n">ascat_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;sm&#39;</span><span class="p">],</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<span class="n">anomaly</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.axes.AxesSubplot at 0x269109e8&gt;
</pre></div>
</div>
<img alt="_images/anomalies_3_1.png" src="_images/anomalies_3_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#calculate climatology</span>
<span class="n">climatology</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">anomaly</span><span class="o">.</span><span class="n">calc_climatology</span><span class="p">(</span><span class="n">ascat_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;sm&#39;</span><span class="p">])</span>
<span class="n">climatology</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.axes.AxesSubplot at 0x1bc54ef0&gt;
</pre></div>
</div>
<img alt="_images/anomalies_4_1.png" src="_images/anomalies_4_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#calculate anomaly based on climatology</span>
<span class="n">anomaly_clim</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">anomaly</span><span class="o">.</span><span class="n">calc_anomaly</span><span class="p">(</span><span class="n">ascat_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;sm&#39;</span><span class="p">],</span> <span class="n">climatology</span><span class="o">=</span><span class="n">climatology</span><span class="p">)</span>
<span class="n">anomaly_clim</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>&lt;matplotlib.axes.AxesSubplot at 0x1bc76860&gt;
</pre></div>
</div>
<img alt="_images/anomalies_5_1.png" src="_images/anomalies_5_1.png" />
</div>
<div class="section" id="comparing-ascat-and-insitu-data-from-the-ismn">
<h2>Comparing ASCAT and insitu data from the ISMN<a class="headerlink" href="#comparing-ascat-and-insitu-data-from-the-ismn" title="Permalink to this headline">¶</a></h2>
<p>This example program loops through all insitu stations that measure soil moisture with a depth between 0 and 0.1m
it then finds the nearest ASCAT grid point and reads the ASCAT data. After temporal matching and scaling using linear CDF matching it computes
several metrics, like the correlation coefficients(Pearson&#8217;s, Spearman&#8217;s and Kendall&#8217;s), Bias, RMSD as well as the Nash–Sutcliffe model efficiency coefficient.</p>
<p>It also shows the usage of the <a class="reference internal" href="_rst/pytesmo.html#module-pytesmo.df_metrics" title="pytesmo.df_metrics"><tt class="xref py py-mod docutils literal"><span class="pre">pytesmo.df_metrics</span></tt></a> module.</p>
<p>It is stopped after 2 stations to not take to long to run and produce a lot of plots</p>
<p>It can be found in the /examples folder of the pytesmo package under the name compare_ISMN_ASCAT.py.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytesmo.io.ismn.interface</span> <span class="kn">as</span> <span class="nn">ismn</span>
<span class="kn">import</span> <span class="nn">pytesmo.io.sat.ascat</span> <span class="kn">as</span> <span class="nn">ascat</span>
<span class="kn">import</span> <span class="nn">pytesmo.temporal_matching</span> <span class="kn">as</span> <span class="nn">temp_match</span>
<span class="kn">import</span> <span class="nn">pytesmo.scaling</span> <span class="kn">as</span> <span class="nn">scaling</span>
<span class="kn">import</span> <span class="nn">pytesmo.df_metrics</span> <span class="kn">as</span> <span class="nn">df_metrics</span>
<span class="kn">import</span> <span class="nn">pytesmo.metrics</span> <span class="kn">as</span> <span class="nn">metrics</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ascat_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;R:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;Datapool_processed&#39;</span><span class="p">,</span><span class="s">&#39;WARP&#39;</span><span class="p">,</span><span class="s">&#39;WARP5.5&#39;</span><span class="p">,</span>
                                         <span class="s">&#39;ASCAT_WARP5.5_R1.2&#39;</span><span class="p">,</span><span class="s">&#39;080_ssm&#39;</span><span class="p">,</span><span class="s">&#39;netcdf&#39;</span><span class="p">)</span>
<span class="n">ascat_grid_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;R:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;Datapool_processed&#39;</span><span class="p">,</span><span class="s">&#39;WARP&#39;</span><span class="p">,</span><span class="s">&#39;ancillary&#39;</span><span class="p">,</span><span class="s">&#39;warp5_grid&#39;</span><span class="p">)</span>
<span class="c">#init the ASCAT_SSM reader with the paths</span>

<span class="c">#let&#39;s not include the orbit direction since it is saved as &#39;A&#39;</span>
<span class="c">#or &#39;D&#39; it can not be plotted</span>
<span class="n">ascat_SSM_reader</span> <span class="o">=</span> <span class="n">ascat</span><span class="o">.</span><span class="n">AscatH25_SSM</span><span class="p">(</span><span class="n">ascat_folder</span><span class="p">,</span><span class="n">ascat_grid_folder</span><span class="p">,</span>
                                      <span class="n">include_in_df</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;sm&#39;</span><span class="p">,</span> <span class="s">&#39;sm_noise&#39;</span><span class="p">,</span> <span class="s">&#39;ssf&#39;</span><span class="p">,</span> <span class="s">&#39;proc_flag&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#set path to ISMN data</span>
<span class="n">path_to_ismn_data</span> <span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;small_projects&#39;</span><span class="p">,</span><span class="s">&#39;cpa_2013_07_ISMN_userformat_reader&#39;</span><span class="p">,</span><span class="s">&#39;header_values_parser_test&#39;</span><span class="p">)</span>
<span class="c">#Initialize reader</span>
<span class="n">ISMN_reader</span> <span class="o">=</span> <span class="n">ismn</span><span class="o">.</span><span class="n">ISMN_Interface</span><span class="p">(</span><span class="n">path_to_ismn_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">label_ascat</span><span class="o">=</span><span class="s">&#39;sm&#39;</span>
<span class="n">label_insitu</span><span class="o">=</span><span class="s">&#39;insitu_sm&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#this loops through all stations that measure soil moisture</span>
<span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">ISMN_reader</span><span class="o">.</span><span class="n">stations_that_measure</span><span class="p">(</span><span class="s">&#39;soil moisture&#39;</span><span class="p">):</span>

    <span class="c">#this loops through all time series of this station that measure soil moisture</span>
    <span class="c">#between 0 and 0.1 meters</span>
    <span class="k">for</span> <span class="n">ISMN_time_series</span> <span class="ow">in</span> <span class="n">station</span><span class="o">.</span><span class="n">data_for_variable</span><span class="p">(</span><span class="s">&#39;soil moisture&#39;</span><span class="p">,</span><span class="n">min_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>

        <span class="n">ascat_time_series</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="n">ISMN_time_series</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
                                                      <span class="n">ISMN_time_series</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
                                                      <span class="n">mask_ssf</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                                      <span class="n">mask_frozen_prob</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                                                      <span class="n">mask_snow_prob</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>


        <span class="c">#drop nan values before doing any matching</span>
        <span class="n">ascat_time_series</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ascat_time_series</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="n">ISMN_time_series</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ISMN_time_series</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c">#rename the soil moisture column in ISMN_time_series.data to insitu_sm</span>
        <span class="c">#to clearly differentiate the time series when they are plotted together</span>
        <span class="n">ISMN_time_series</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;soil moisture&#39;</span><span class="p">:</span><span class="n">label_insitu</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c">#get ISMN data that was observerd within +- 1 hour(1/24. day) of the ASCAT observation</span>
        <span class="c">#do not include those indexes where no observation was found</span>
        <span class="n">matched_data</span> <span class="o">=</span> <span class="n">temp_match</span><span class="o">.</span><span class="n">matching</span><span class="p">(</span><span class="n">ascat_time_series</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">ISMN_time_series</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                <span class="n">window</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">24.</span><span class="p">)</span>
        <span class="c">#matched ISMN data is now a dataframe with the same datetime index</span>
        <span class="c">#as ascat_time_series.data and the nearest insitu observation</span>

        <span class="c">#continue only with relevant columns</span>
        <span class="n">matched_data</span> <span class="o">=</span> <span class="n">matched_data</span><span class="p">[[</span><span class="n">label_ascat</span><span class="p">,</span><span class="n">label_insitu</span><span class="p">]]</span>

        <span class="c">#the plot shows that ISMN and ASCAT are observed in different units</span>
        <span class="n">matched_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">secondary_y</span><span class="o">=</span><span class="p">[</span><span class="n">label_ascat</span><span class="p">],</span>
                          <span class="n">title</span><span class="o">=</span><span class="s">&#39;temporally merged data&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c">#this takes the matched_data DataFrame and scales all columns to the</span>
        <span class="c">#column with the given reference_index, in this case in situ</span>
        <span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaling</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">matched_data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;lin_cdf_match&#39;</span><span class="p">,</span>
                                         <span class="n">reference_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c">#now the scaled ascat data and insitu_sm are in the same space</span>
        <span class="n">scaled_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;scaled data&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">[</span><span class="n">label_ascat</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">scaled_data</span><span class="p">[</span><span class="n">label_insitu</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">label_ascat</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">label_insitu</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c">#calculate correlation coefficients, RMSD, bias, Nash Sutcliffe</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">scaled_data</span><span class="p">[</span><span class="n">label_ascat</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">scaled_data</span><span class="p">[</span><span class="n">label_insitu</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">print</span> <span class="s">&quot;ISMN time series:&quot;</span><span class="p">,</span><span class="n">ISMN_time_series</span>
        <span class="k">print</span> <span class="s">&quot;compared to&quot;</span>
        <span class="k">print</span> <span class="n">ascat_time_series</span>
        <span class="k">print</span> <span class="s">&quot;Results:&quot;</span>

        <span class="c">#df_metrics takes a DataFrame as input and automatically</span>
        <span class="c">#calculates the metric on all combinations of columns</span>
        <span class="c">#returns a named tuple for easy printing</span>
        <span class="k">print</span> <span class="n">df_metrics</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Spearman&#39;s (rho,p_value)&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Kendalls&#39;s (tau,p_value)&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">kendalltau</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">df_metrics</span><span class="o">.</span><span class="n">kendalltau</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">df_metrics</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Bias&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">bias</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Nash Sutcliffe&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">nash_sutcliffe</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>


    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c">#only show the first 2 stations, otherwise this program would run a long time</span>
    <span class="c">#and produce a lot of plots</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
<img alt="_images/compare_ASCAT_ISMN_5_0.png" src="_images/compare_ASCAT_ISMN_5_0.png" />
<img alt="_images/compare_ASCAT_ISMN_5_1.png" src="_images/compare_ASCAT_ISMN_5_1.png" />
<img alt="_images/compare_ASCAT_ISMN_5_2.png" src="_images/compare_ASCAT_ISMN_5_2.png" />
<div class="highlight-python"><div class="highlight"><pre>ISMN time series: OZNET Alabama 0.00 m - 0.05 m soil moisture measured with Stevens-Hydra-Probe
compared to
ASCAT time series gpi:1884359 lat:-35.342 lon:147.541
Results:
(Pearsons_r(sm_and_insitu_sm=0.61607679781575175), p_value(sm_and_insitu_sm=3.1170801211098453e-65))
Spearman&#39;s (rho,p_value) (0.64651747115098912, 1.0057610194056589e-73)
Kendalls&#39;s (tau,p_value) (0.4685441550995097, 2.4676437876515864e-67)
(Kendall_tau(sm_and_insitu_sm=0.4685441550995097), p_value(sm_and_insitu_sm=2.4676437876515864e-67))
rmsd(sm_and_insitu_sm=0.078018684719599857)
Bias 0.00168114697282
Nash Sutcliffe 0.246416864767
</pre></div>
</div>
<img alt="_images/compare_ASCAT_ISMN_5_4.png" src="_images/compare_ASCAT_ISMN_5_4.png" />
<img alt="_images/compare_ASCAT_ISMN_5_5.png" src="_images/compare_ASCAT_ISMN_5_5.png" />
<img alt="_images/compare_ASCAT_ISMN_5_6.png" src="_images/compare_ASCAT_ISMN_5_6.png" />
<div class="highlight-python"><div class="highlight"><pre>ISMN time series: OZNET Balranald-Bolton_Park 0.00 m - 0.08 m soil moisture measured with CS615
compared to
ASCAT time series gpi:1821003 lat:-33.990 lon:146.381
Results:
(Pearsons_r(sm_and_insitu_sm=0.66000287576696759), p_value(sm_and_insitu_sm=1.3332742454781072e-126))
Spearman&#39;s (rho,p_value) (0.65889275747696652, 4.890533231776912e-126)
Kendalls&#39;s (tau,p_value) (0.48653686844813893, 6.6517671082477896e-118)
(Kendall_tau(sm_and_insitu_sm=0.48653686844813893), p_value(sm_and_insitu_sm=6.6517671082477896e-118))
rmsd(sm_and_insitu_sm=0.028314835540753237)
Bias 4.56170862568e-05
Nash Sutcliffe 0.316925662899
</pre></div>
</div>
</div>
<div class="section" id="reading-and-plotting-ascat-data-from-binary-format">
<h2>Reading and plotting ASCAT data from binary format<a class="headerlink" href="#reading-and-plotting-ascat-data-from-binary-format" title="Permalink to this headline">¶</a></h2>
<p>This example program reads and plots ASCAT SSM and SWI data with different masking options.
It can be found in the /examples folder of the pytesmo package under the name plot_ASCAT_data.py.</p>
<p>In[1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pytesmo.io.sat.ascat</span> <span class="kn">as</span> <span class="nn">ascat</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<hr class="docutils" />
<p>In[2]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#I&#39;ve downloaded my ASCAT data to a folder on my D drive</span>
<span class="n">path_to_ascat_ssm_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;small_projects&#39;</span><span class="p">,</span><span class="s">&#39;cpa_2013_07_userformat_reader&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;data&#39;</span><span class="p">,</span><span class="s">&#39;ASCAT_SSM_25km_ts_WARP5.5_R0.1&#39;</span><span class="p">,</span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="n">path_to_ascat_swi_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;small_projects&#39;</span><span class="p">,</span><span class="s">&#39;cpa_2013_07_userformat_reader&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;data&#39;</span><span class="p">,</span><span class="s">&#39;ASCAT_SWI_25km_ts_WARP5.5_R0.1&#39;</span><span class="p">,</span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="c">#path to grid definition file, default name TUW_W54_01_lonlat-ld-land.txt</span>
<span class="n">path_to_grid_definition</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;small_projects&#39;</span><span class="p">,</span><span class="s">&#39;cpa_2013_07_userformat_reader&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;data&#39;</span><span class="p">,</span><span class="s">&#39;auxiliary_data&#39;</span><span class="p">,</span><span class="s">&#39;grid_info&#39;</span><span class="p">)</span>
<span class="c">#path to advisory flags from FTP Server</span>
<span class="n">path_to_adv_flags</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;small_projects&#39;</span><span class="p">,</span><span class="s">&#39;cpa_2013_07_userformat_reader&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;data&#39;</span><span class="p">,</span><span class="s">&#39;auxiliary_data&#39;</span><span class="p">,</span><span class="s">&#39;advisory_flags&#39;</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>In[3]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#init the ASCAT_SSM reader with the paths</span>
<span class="n">ascat_SSM_reader</span> <span class="o">=</span> <span class="n">ascat</span><span class="o">.</span><span class="n">Ascat_SSM</span><span class="p">(</span><span class="n">path_to_ascat_ssm_data</span><span class="p">,</span><span class="n">path_to_grid_definition</span><span class="p">,</span>
                                   <span class="n">advisory_flags_path</span> <span class="o">=</span> <span class="n">path_to_adv_flags</span><span class="p">)</span>
</pre></div>
</div>
<p>In[4]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">48</span>

<span class="c">#reads ssm data nearest to this lon,lat coordinates</span>
<span class="n">ssm_data_raw</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">)</span>

<span class="c">#plot the data using pandas builtin plot functionality</span>
<span class="n">ssm_data_raw</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ascat_data_3_0.png" src="_images/plot_ascat_data_3_0.png" />
<p>In[5]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#read the same data but mask observations where the SSF shows frozen</span>
<span class="c">#and where frozen and snow probabilty are greater than 20%</span>
<span class="n">ssm_data_masked</span> <span class="o">=</span> <span class="n">ascat_SSM_reader</span><span class="o">.</span><span class="n">read_ssm</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">mask_ssf</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">mask_frozen_prob</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">mask_snow_prob</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c">#plot the data using pandas builtin plot functionality</span>
<span class="c">#this time using a subplot for each variable in the DataFrame</span>
<span class="n">ssm_data_masked</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ascat_data_4_0.png" src="_images/plot_ascat_data_4_0.png" />
<p>In[6]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#plot raw and masked SSM data in one plot to compare them</span>

<span class="n">ssm_data_raw</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;SSM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;raw SSM data&#39;</span><span class="p">)</span>
<span class="n">ssm_data_masked</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;SSM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;masked SSM data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ascat_data_5_0.png" src="_images/plot_ascat_data_5_0.png" />
<p>In[7]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ascat_SWI_reader</span> <span class="o">=</span> <span class="n">ascat</span><span class="o">.</span><span class="n">Ascat_SWI</span><span class="p">(</span><span class="n">path_to_ascat_swi_data</span><span class="p">,</span><span class="n">path_to_grid_definition</span><span class="p">,</span>
                                   <span class="n">advisory_flags_path</span> <span class="o">=</span> <span class="n">path_to_adv_flags</span><span class="p">)</span>


<span class="c">#reads swi data nearest to this lon,lat coordinates</span>
<span class="c">#without any additional keywords all unmasked T values and</span>
<span class="c">#Quality flags will be read</span>
<span class="n">swi_data_raw</span> <span class="o">=</span> <span class="n">ascat_SWI_reader</span><span class="o">.</span><span class="n">read_swi</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">)</span>

<span class="c">#plot the data using pandas builtin plot functionality</span>
<span class="n">swi_data_raw</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ascat_data_6_0.png" src="_images/plot_ascat_data_6_0.png" />
<p>In[8]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#read the same data but this time only SWI with a T value</span>
<span class="c">#of 20 is returned</span>
<span class="n">swi_data_T_20</span> <span class="o">=</span> <span class="n">ascat_SWI_reader</span><span class="o">.</span><span class="n">read_swi</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c">#plot the data using pandas builtin plot functionality</span>
<span class="c">#this time using a subplot for each variable in the DataFrame</span>
<span class="n">swi_data_T_20</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ascat_data_7_0.png" src="_images/plot_ascat_data_7_0.png" />
<p>In[9]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#you can also mask manually if you prefer</span>
<span class="n">swi_data_T_20</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">swi_data_T_20</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">swi_data_T_20</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;frozen_prob&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">swi_data_T_20</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_ascat_data_8_0.png" src="_images/plot_ascat_data_8_0.png" />
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="_rst/pytesmo.html" class="btn btn-neutral float-right" title="pytesmo package"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction to pytesmo a python Toolbox for the Evaluation of Soil Moisture Observations"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Christoph Paulik.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>