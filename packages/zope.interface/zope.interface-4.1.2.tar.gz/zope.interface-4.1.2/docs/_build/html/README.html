<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Interfaces &mdash; zope.interface 4.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="zope.interface 4.0.1 documentation" href="index.html" />
    <link rel="next" title="Adapter Registry" href="adapter.html" />
    <link rel="prev" title="Welcome to zope.interface’s documentation!" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="adapter.html" title="Adapter Registry"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to zope.interface’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">zope.interface 4.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="interfaces">
<h1>Interfaces<a class="headerlink" href="#interfaces" title="Permalink to this headline">¶</a></h1>
<p>Interfaces are objects that specify (document) the external behavior
of objects that &#8220;provide&#8221; them.  An interface specifies behavior
through:</p>
<ul class="simple">
<li>Informal documentation in a doc string</li>
<li>Attribute definitions</li>
<li>Invariants, which are conditions that must hold for objects that
provide the interface</li>
</ul>
<p>Attribute definitions specify specific attributes. They define the
attribute name and provide documentation and constraints of attribute
values.  Attribute definitions can take a number of forms, as we&#8217;ll
see below.</p>
<div class="section" id="defining-interfaces">
<h2>Defining interfaces<a class="headerlink" href="#defining-interfaces" title="Permalink to this headline">¶</a></h2>
<p>Interfaces are defined using Python class statements:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zope.interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IFoo</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>   <span class="sd">&quot;&quot;&quot;Foo blah blah&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="n">x</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;X blah blah&quot;&quot;&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>       <span class="sd">&quot;&quot;&quot;bar blah blah&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>In the example above, we&#8217;ve created an interface, <cite>IFoo</cite>.  We
subclassed <cite>zope.interface.Interface</cite>, which is an ancestor interface for
all interfaces, much as <cite>object</cite> is an ancestor of all new-style
classes <a class="footnote-reference" href="#create" id="id1">[1]</a>.   The interface is not a class, it&#8217;s an Interface,
an instance of <cite>InterfaceClass</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="go">&lt;class &#39;zope.interface.interface.InterfaceClass&#39;&gt;</span>
</pre></div>
</div>
<p>We can ask for the interface&#8217;s documentation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;Foo blah blah&#39;</span>
</pre></div>
</div>
<p>and its name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">__name__</span>
<span class="go">&#39;IFoo&#39;</span>
</pre></div>
</div>
<p>and even its module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">__module__</span>
<span class="go">&#39;__builtin__&#39;</span>
</pre></div>
</div>
<p>The interface defined two attributes:</p>
<dl class="docutils">
<dt><cite>x</cite></dt>
<dd>This is the simplest form of attribute definition.  It has a name
and a doc string.  It doesn&#8217;t formally specify anything else.</dd>
<dt><cite>bar</cite></dt>
<dd><p class="first">This is a method.  A method is defined via a function definition.  A
method is simply an attribute constrained to be a callable with a
particular signature, as provided by the function definition.</p>
<p class="last">Note that <cite>bar</cite> doesn&#8217;t take a <cite>self</cite> argument.  Interfaces document
how an object is <em>used</em>.  When calling instance methods, you don&#8217;t
pass a <cite>self</cite> argument, so a <cite>self</cite> argument isn&#8217;t included in the
interface signature.  The <cite>self</cite> argument in instance methods is
really an implementation detail of Python instances. Other objects,
besides instances can provide interfaces and their methods might not
be instance methods. For example, modules can provide interfaces and
their methods are usually just functions.  Even instances can have
methods that are not instance methods.</p>
</dd>
</dl>
<p>You can access the attributes defined by an interface using mapping
syntax:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">IFoo</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;zope.interface.interface.Attribute&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">__name__</span>
<span class="go">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;X blah blah&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>
<span class="go">&#39;x&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use <cite>in</cite> to determine if an interface defines a name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">IFoo</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You can iterate over interfaces to get the names they define:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span>
<span class="go">[&#39;bar&#39;, &#39;x&#39;]</span>
</pre></div>
</div>
<p>Remember that interfaces aren&#8217;t classes. You can&#8217;t access attribute
definitions as attributes of interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">x</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;InterfaceClass&#39; object has no attribute &#39;x&#39;</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;InterfaceClass&#39; object has no attribute &#39;x&#39;</span>
</pre></div>
</div>
<p>Methods provide access to the method signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">bar</span> <span class="o">=</span> <span class="n">IFoo</span><span class="p">[</span><span class="s">&#39;bar&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bar</span><span class="o">.</span><span class="n">getSignatureString</span><span class="p">()</span>
<span class="go">&#39;(q, r=None)&#39;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>TODO</dt>
<dd>Methods really should have a better API.  This is something that
needs to be improved.</dd>
</dl>
</div>
<div class="section" id="declaring-interfaces">
<h2>Declaring interfaces<a class="headerlink" href="#declaring-interfaces" title="Permalink to this headline">¶</a></h2>
<p>Having defined interfaces, we can <em>declare</em> that objects provide
them.  Before we describe the details, lets define some terms:</p>
<dl class="docutils">
<dt><em>provide</em></dt>
<dd>We say that objects <em>provide</em> interfaces.  If an object provides an
interface, then the interface specifies the behavior of the
object. In other words, interfaces specify the behavior of the
objects that provide them.</dd>
<dt><em>implement</em></dt>
<dd><p class="first">We normally say that classes <em>implement</em> interfaces.  If a class
implements an interface, then the instances of the class provide
the interface.  Objects provide interfaces that their classes
implement <a class="footnote-reference" href="#factory" id="id2">[2]</a>.  (Objects can provide interfaces directly,
in addition to what their classes implement.)</p>
<p>It is important to note that classes don&#8217;t usually provide the
interfaces that they implement.</p>
<p class="last">We can generalize this to factories.  For any callable object we
can declare that it produces objects that provide some interfaces
by saying that the factory implements the interfaces.</p>
</dd>
</dl>
<p>Now that we&#8217;ve defined these terms, we can talk about the API for
declaring interfaces.</p>
<div class="section" id="declaring-implemented-interfaces">
<h3>Declaring implemented interfaces<a class="headerlink" href="#declaring-implemented-interfaces" title="Permalink to this headline">¶</a></h3>
<p>The most common way to declare interfaces is using the implements
function in a class statement:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Foo(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<p>In this example, we declared that <cite>Foo</cite> implements <cite>IFoo</cite>. This means
that instances of <cite>Foo</cite> provide <cite>IFoo</cite>.  Having made this declaration,
there are several ways we can introspect the declarations.  First, we
can ask an interface whether it is implemented by a class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And we can ask whether an interface is provided by an object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Of course, <cite>Foo</cite> doesn&#8217;t provide <cite>IFoo</cite>, it implements it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We can also ask what interfaces are implemented by an object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>It&#8217;s an error to ask for interfaces implemented by a non-callable
object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;ImplementedBy called for non-factory&#39;, Foo(None))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;ImplementedBy called for non-factory&#39;, Foo(None))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;ImplementedBy called for non-factory&#39;, Foo(None))</span>
</pre></div>
</div>
<p>Similarly, we can ask what interfaces are provided by an object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>We can declare interfaces implemented by other factories (besides
classes).  We do this using a Python-2.4-style decorator named
<cite>implementer</cite>.  In versions of Python before 2.4, this looks like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">yfoo</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">foo</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">foo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yfoo</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementer</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)(</span><span class="n">yfoo</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">yfoo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>Note that the implementer decorator may modify it&#8217;s argument. Callers
should not assume that a new object is created.</p>
<p>Using implementer also works on callable objects. This is used by
zope.formlib, as an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">yfactory</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">foo</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">foo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yfoo</span> <span class="o">=</span> <span class="n">yfactory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yfoo</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementer</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)(</span><span class="n">yfoo</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">yfoo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>XXX: Double check and update these version numbers:</p>
<p>In zope.interface 3.5.2 and lower, the implementer decorator can not
be used for classes, but in 3.6.0 and higher it can:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Foo</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementer</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)(</span><span class="n">Foo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">()))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>Note that class decorators using the &#64;implementer(IFoo) syntax are only
supported in Python 2.6 and later.</p>
</div>
<div class="section" id="declaring-provided-interfaces">
<h3>Declaring provided interfaces<a class="headerlink" href="#declaring-provided-interfaces" title="Permalink to this headline">¶</a></h3>
<p>We can declare interfaces directly provided by objects.  Suppose that
we want to document what the <cite>__init__</cite> method of the <cite>Foo</cite> class
does.  It&#8217;s not <em>really</em> part of <cite>IFoo</cite>.  You wouldn&#8217;t normally call
the <cite>__init__</cite> method on Foo instances.  Rather, the <cite>__init__</cite> method
is part of the <cite>Foo</cite>&#8216;s <cite>__call__</cite> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IFooFactory</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Create foos&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Create a foo</span>
<span class="gp">...</span><span class="sd"></span>
<span class="gp">... </span><span class="sd">        The argument provides the initial value for x ...</span>
<span class="gp">... </span><span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>It&#8217;s the class that provides this interface, so we declare the
interface on the class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">directlyProvides</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span> <span class="n">IFooFactory</span><span class="p">)</span>
</pre></div>
</div>
<p>And then, we&#8217;ll see that Foo provides some interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFooFactory&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFooFactory</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Declaring class interfaces is common enough that there&#8217;s a special
declaration function for it, <cite>classProvides</cite>, that allows the
declaration from within a class statement:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo2</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">classProvides</span><span class="p">(</span><span class="n">IFooFactory</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Foo(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo2</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFooFactory&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFooFactory</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Foo2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>There&#8217;s a similar function, <cite>moduleProvides</cite>, that supports interface
declarations from within module definitions.  For example, see the use
of <cite>moduleProvides</cite> call in <cite>zope.interface.__init__</cite>, which declares that
the package <cite>zope.interface</cite> provides <cite>IInterfaceDeclaration</cite>.</p>
<p>Sometimes, we want to declare interfaces on instances, even though
those instances get interfaces from their classes.  Suppose we create
a new interface, <cite>ISpecial</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISpecial</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">reason</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Reason why we&#39;re special&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">brag</span><span class="p">():</span>
<span class="gp">... </span>        <span class="s">&quot;Brag about being special&quot;</span>
</pre></div>
</div>
<p>We can make an existing foo instance special by providing <cite>reason</cite>
and <cite>brag</cite> attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="s">&#39;I just am&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">brag</span><span class="p">():</span>
<span class="gp">... </span>     <span class="k">return</span> <span class="s">&quot;I&#39;m special!&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">brag</span> <span class="o">=</span> <span class="n">brag</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">reason</span>
<span class="go">&#39;I just am&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">brag</span><span class="p">()</span>
<span class="go">&quot;I&#39;m special!&quot;</span>
</pre></div>
</div>
<p>and by declaring the interface:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">directlyProvides</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">ISpecial</span><span class="p">)</span>
</pre></div>
</div>
<p>then the new interface is included in the provided interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ISpecial</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;, &lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>We can find out what interfaces are directly provided by an object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">directlyProvidedBy</span><span class="p">(</span><span class="n">foo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">newfoo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">directlyProvidedBy</span><span class="p">(</span><span class="n">newfoo</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="inherited-declarations">
<h3>Inherited declarations<a class="headerlink" href="#inherited-declarations" title="Permalink to this headline">¶</a></h3>
<p>Normally, declarations are inherited:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SpecialFoo</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">ISpecial</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">reason</span> <span class="o">=</span> <span class="s">&#39;I just am&#39;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">brag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;I&#39;m special because </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">reason</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">SpecialFoo</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;, &lt;InterfaceClass __builtin__.IFoo&gt;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">SpecialFoo</span><span class="p">()))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;, &lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>Sometimes, you don&#8217;t want to inherit declarations.  In that case, you
can use <cite>implementsOnly</cite>, instead of <cite>implements</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Special</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementsOnly</span><span class="p">(</span><span class="n">ISpecial</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">reason</span> <span class="o">=</span> <span class="s">&#39;I just am&#39;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">brag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;I&#39;m special because </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">reason</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Special</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">Special</span><span class="p">()))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;]</span>
</pre></div>
</div>
</div>
<div class="section" id="external-declarations">
<h3>External declarations<a class="headerlink" href="#external-declarations" title="Permalink to this headline">¶</a></h3>
<p>Normally, we make implementation declarations as part of a class
definition. Sometimes, we may want to make declarations from outside
the class definition. For example, we might want to declare interfaces
for classes that we didn&#8217;t write.  The function <cite>classImplements</cite> can
be used for this purpose:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">classImplements</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">IFoo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
<p>We can use <cite>classImplementsOnly</cite> to exclude inherited interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">classImplementsOnly</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ISpecial</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.ISpecial&gt;]</span>
</pre></div>
</div>
</div>
<div class="section" id="declaration-objects">
<h3>Declaration Objects<a class="headerlink" href="#declaration-objects" title="Permalink to this headline">¶</a></h3>
<p>When we declare interfaces, we create <em>declaration</em> objects.  When we
query declarations, declaration objects are returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Special</span><span class="p">))</span>
<span class="go">&lt;class &#39;zope.interface.declarations.Implements&#39;&gt;</span>
</pre></div>
</div>
<p>Declaration objects and interface objects are similar in many ways. In
fact, they share a common base class.  The important thing to realize
about them is that they can be used where interfaces are expected in
declarations. Here&#8217;s a silly example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Special2</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementsOnly</span><span class="p">(</span>
<span class="gp">... </span>         <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Foo</span><span class="p">),</span>
<span class="gp">... </span>         <span class="n">ISpecial</span><span class="p">,</span>
<span class="gp">... </span>         <span class="p">)</span>
<span class="gp">... </span>    <span class="n">reason</span> <span class="o">=</span> <span class="s">&#39;I just am&#39;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">brag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;I&#39;m special because </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">reason</span>
</pre></div>
</div>
<p>The declaration here is almost the same as
<code class="docutils literal"><span class="pre">zope.interface.implements(ISpecial)</span></code>, except that the order of
interfaces in the resulting declaration is different:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Special2</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;, &lt;InterfaceClass __builtin__.ISpecial&gt;]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interface-inheritance">
<h2>Interface Inheritance<a class="headerlink" href="#interface-inheritance" title="Permalink to this headline">¶</a></h2>
<p>Interfaces can extend other interfaces. They do this simply by listing
the other interfaces as base interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IBlat</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Blat blah blah&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">y</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;y blah blah&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">eek</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;eek blah blah&quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IBlat</span><span class="o">.</span><span class="n">__bases__</span>
<span class="go">(&lt;InterfaceClass zope.interface.Interface&gt;,)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IBaz</span><span class="p">(</span><span class="n">IFoo</span><span class="p">,</span> <span class="n">IBlat</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Baz blah&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">eek</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;eek in baz blah&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IBaz</span><span class="o">.</span><span class="n">__bases__</span>
<span class="go">(&lt;InterfaceClass __builtin__.IFoo&gt;, &lt;InterfaceClass __builtin__.IBlat&gt;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">IBaz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span>
<span class="go">[&#39;bar&#39;, &#39;eek&#39;, &#39;x&#39;, &#39;y&#39;]</span>
</pre></div>
</div>
<p>Note that <cite>IBaz</cite> overrides eek:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IBlat</span><span class="p">[</span><span class="s">&#39;eek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;eek blah blah&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IBaz</span><span class="p">[</span><span class="s">&#39;eek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;eek in baz blah&#39;</span>
</pre></div>
</div>
<p>We were careful to override eek in a compatible way.  When extending
an interface, the extending interface should be compatible <a class="footnote-reference" href="#compat" id="id3">[3]</a>
with the extended interfaces.</p>
<p>We can ask whether one interface extends another:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IBaz</span><span class="o">.</span><span class="n">extends</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IBlat</span><span class="o">.</span><span class="n">extends</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that interfaces don&#8217;t extend themselves:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IBaz</span><span class="o">.</span><span class="n">extends</span><span class="p">(</span><span class="n">IBaz</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Sometimes we wish they did, but we can, instead use <cite>isOrExtends</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IBaz</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IBaz</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IBaz</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IBaz</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>When we iterate over an interface, we get all of the names it defines,
including names defined by base interfaces. Sometimes, we want <em>just</em>
the names defined by the interface directly. We bane use the <cite>names</cite>
method for that:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">IBaz</span><span class="o">.</span><span class="n">names</span><span class="p">())</span>
<span class="go">[&#39;eek&#39;]</span>
</pre></div>
</div>
<div class="section" id="inheritance-of-attribute-specifications">
<h3>Inheritance of attribute specifications<a class="headerlink" href="#inheritance-of-attribute-specifications" title="Permalink to this headline">¶</a></h3>
<p>An interface may override attribute definitions from base interfaces.
If two base interfaces define the same attribute, the attribute is
inherited from the most specific interface. For example, with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IBase</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>        <span class="s">&quot;base foo doc&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IBase1</span><span class="p">(</span><span class="n">IBase</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IBase2</span><span class="p">(</span><span class="n">IBase</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>        <span class="s">&quot;base2 foo doc&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISub</span><span class="p">(</span><span class="n">IBase1</span><span class="p">,</span> <span class="n">IBase2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>ISub&#8217;s definition of foo is the one from IBase2, since IBase2 is more
specific that IBase:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ISub</span><span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;base2 foo doc&#39;</span>
</pre></div>
</div>
<p>Note that this differs from a depth-first search.</p>
<p>Sometimes, it&#8217;s useful to ask whether an interface defines an
attribute directly.  You can use the direct method to get a directly
defined definitions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IBase</span><span class="o">.</span><span class="n">direct</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">__doc__</span>
<span class="go">&#39;base foo doc&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ISub</span><span class="o">.</span><span class="n">direct</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="specifications">
<h3>Specifications<a class="headerlink" href="#specifications" title="Permalink to this headline">¶</a></h3>
<p>Interfaces and declarations are both special cases of specifications.
What we described above for interface inheritance applies to both
declarations and specifications.  Declarations actually extend the
interfaces that they declare:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Baz</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">IBaz</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">baz_implements</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Baz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baz_implements</span><span class="o">.</span><span class="n">__bases__</span>
<span class="go">(&lt;InterfaceClass __builtin__.IBaz&gt;, &lt;implementedBy ...object&gt;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">baz_implements</span><span class="o">.</span><span class="n">extends</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">baz_implements</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baz_implements</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">baz_implements</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Specifications (interfaces and declarations) provide an <cite>__sro__</cite>
that lists the specification and all of it&#8217;s ancestors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">baz_implements</span><span class="o">.</span><span class="n">__sro__</span><span class="p">)</span>
<span class="go">(&lt;implementedBy __builtin__.Baz&gt;,</span>
<span class="go"> &lt;InterfaceClass __builtin__.IBaz&gt;,</span>
<span class="go"> &lt;InterfaceClass __builtin__.IFoo&gt;,</span>
<span class="go"> &lt;InterfaceClass __builtin__.IBlat&gt;,</span>
<span class="go"> &lt;InterfaceClass zope.interface.Interface&gt;,</span>
<span class="go"> &lt;implementedBy ...object&gt;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tagged-values">
<h2>Tagged Values<a class="headerlink" href="#tagged-values" title="Permalink to this headline">¶</a></h2>
<p>Interfaces and attribute descriptions support an extension mechanism,
borrowed from UML, called &#8220;tagged values&#8221; that lets us store extra
data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">setTaggedValue</span><span class="p">(</span><span class="s">&#39;date-modified&#39;</span><span class="p">,</span> <span class="s">&#39;2004-04-01&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">setTaggedValue</span><span class="p">(</span><span class="s">&#39;author&#39;</span><span class="p">,</span> <span class="s">&#39;Jim Fulton&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">getTaggedValue</span><span class="p">(</span><span class="s">&#39;date-modified&#39;</span><span class="p">)</span>
<span class="go">&#39;2004-04-01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">queryTaggedValue</span><span class="p">(</span><span class="s">&#39;date-modified&#39;</span><span class="p">)</span>
<span class="go">&#39;2004-04-01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IFoo</span><span class="o">.</span><span class="n">queryTaggedValue</span><span class="p">(</span><span class="s">&#39;datemodified&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">IFoo</span><span class="o">.</span><span class="n">getTaggedValueTags</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span>
<span class="go">[&#39;author&#39;, &#39;date-modified&#39;]</span>
</pre></div>
</div>
<p>Function attributes are converted to tagged values when method
attribute definitions are created:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IBazFactory</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">():</span>
<span class="gp">... </span>        <span class="s">&quot;create one&quot;</span>
<span class="gp">... </span>    <span class="n">__call__</span><span class="o">.</span><span class="n">return_type</span> <span class="o">=</span> <span class="n">IBaz</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IBazFactory</span><span class="p">[</span><span class="s">&#39;__call__&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getTaggedValue</span><span class="p">(</span><span class="s">&#39;return_type&#39;</span><span class="p">)</span>
<span class="go">&lt;InterfaceClass __builtin__.IBaz&gt;</span>
</pre></div>
</div>
<p>Tagged values can also be defined from within an interface definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IWithTaggedValues</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">taggedValue</span><span class="p">(</span><span class="s">&#39;squish&#39;</span><span class="p">,</span> <span class="s">&#39;squash&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IWithTaggedValues</span><span class="o">.</span><span class="n">getTaggedValue</span><span class="p">(</span><span class="s">&#39;squish&#39;</span><span class="p">)</span>
<span class="go">&#39;squash&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="invariants">
<h2>Invariants<a class="headerlink" href="#invariants" title="Permalink to this headline">¶</a></h2>
<p>Interfaces can express conditions that must hold for objects that
provide them. These conditions are expressed using one or more
invariants.  Invariants are callable objects that will be called with
an object that provides an interface. An invariant raises an <cite>Invalid</cite>
exception if the condition doesn&#8217;t hold.  Here&#8217;s an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">RangeError</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Invalid</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A range has invalid limits&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;RangeError(</span><span class="si">%r</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">range_invariant</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">ob</span><span class="o">.</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">ob</span><span class="o">.</span><span class="n">min</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="n">RangeError</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span>
</pre></div>
</div>
<p>Given this invariant, we can use it in an interface definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IRange</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">min</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Lower bound&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">max</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Upper bound&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span><span class="n">range_invariant</span><span class="p">)</span>
</pre></div>
</div>
<p>Interfaces have a method for checking their invariants:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Range</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">IRange</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Range(</span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IRange</span><span class="o">.</span><span class="n">validateInvariants</span><span class="p">(</span><span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IRange</span><span class="o">.</span><span class="n">validateInvariants</span><span class="p">(</span><span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IRange</span><span class="o">.</span><span class="n">validateInvariants</span><span class="p">(</span><span class="n">Range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RangeError</span>: <span class="n">Range(2, 1)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RangeError</span>: <span class="n">Range(2, 1)</span>
</pre></div>
</div>
<p>If you have multiple invariants, you may not want to stop checking
after the first error.  If you pass a list to <cite>validateInvariants</cite>,
then a single <cite>Invalid</cite> exception will be raised with the list of
exceptions as it&#8217;s argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface.exceptions</span> <span class="kn">import</span> <span class="n">Invalid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">IRange</span><span class="o">.</span><span class="n">validateInvariants</span><span class="p">(</span><span class="n">Range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">errors</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">Invalid</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">&#39;[RangeError(Range(2, 1))]&#39;</span>
</pre></div>
</div>
<p>And the list will be filled with the individual exceptions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">errors</span>
<span class="go">[RangeError(Range(2, 1))]</span>


<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">errors</span><span class="p">[:]</span>
</pre></div>
</div>
</div>
<div class="section" id="adaptation">
<h2>Adaptation<a class="headerlink" href="#adaptation" title="Permalink to this headline">¶</a></h2>
<p>Interfaces can be called to perform adaptation.</p>
<p>The semantics are based on those of the PEP 246 adapt function.</p>
<p>If an object cannot be adapted, then a TypeError is raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;Could not adapt&#39;, 0, &lt;InterfaceClass __builtin__.I&gt;)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;Could not adapt&#39;, 0, &lt;InterfaceClass __builtin__.I&gt;)</span>
</pre></div>
</div>
<p>unless an alternate value is provided as a second positional argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;bob&#39;</span><span class="p">)</span>
<span class="go">&#39;bob&#39;</span>
</pre></div>
</div>
<p>If an object already implements the interface, then it will be returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">obj</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If an object implements __conform__, then it will be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__conform__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proto</span><span class="p">):</span>
<span class="gp">... </span>         <span class="k">return</span> <span class="mi">0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">(</span><span class="n">C</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Adapter hooks (see __adapt__) will also be used, if present:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface.interface</span> <span class="kn">import</span> <span class="n">adapter_hooks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">adapt_0_to_42</span><span class="p">(</span><span class="n">iface</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">obj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">42</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter_hooks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adapt_0_to_42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">42</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter_hooks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">adapt_0_to_42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;Could not adapt&#39;, 0, &lt;InterfaceClass __builtin__.I&gt;)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;Could not adapt&#39;, 0, &lt;InterfaceClass __builtin__.I&gt;)</span>
</pre></div>
</div>
<div class="section" id="adapt">
<h3>__adapt__<a class="headerlink" href="#adapt" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>Interfaces implement the PEP 246 __adapt__ method.</p>
<p>This method is normally not called directly. It is called by the PEP
246 adapt framework and by the interface __call__ operator.</p>
<p>The adapt method is responsible for adapting an object to the
reciever.</p>
<p>The default version returns None:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">.</span><span class="n">__adapt__</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>unless the object given provides the interface:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">.</span><span class="n">__adapt__</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">obj</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Adapter hooks can be provided (or removed) to provide custom
adaptation. We&#8217;ll install a silly hook that adapts 0 to 42.
We install a hook by simply adding it to the adapter_hooks
list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface.interface</span> <span class="kn">import</span> <span class="n">adapter_hooks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">adapt_0_to_42</span><span class="p">(</span><span class="n">iface</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">obj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">42</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">adapter_hooks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adapt_0_to_42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">.</span><span class="n">__adapt__</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
<p>Hooks must either return an adapter, or None if no adapter can
be found.</p>
<p>Hooks can be uninstalled by removing them from the list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adapter_hooks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">adapt_0_to_42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">.</span><span class="n">__adapt__</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="create" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><p class="first">The main reason we subclass <cite>Interface</cite> is to cause the
Python class statement to create an interface, rather
than a class.</p>
<p class="last">It&#8217;s possible to create interfaces by calling a special
interface class directly.  Doing this, it&#8217;s possible
(and, on rare occasions, useful) to create interfaces
that don&#8217;t descend from <cite>Interface</cite>.  Using this
technique is beyond the scope of this document.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="factory" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Classes are factories.  They can be called to create
their instances.  We expect that we will eventually
extend the concept of implementation to other kinds of
factories, so that we can declare the interfaces
provided by the objects created.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="compat" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><p class="first">The goal is substitutability.  An object that provides an
extending interface should be substitutable for an object
that provides the extended interface.  In our example, an
object that provides IBaz should be usable whereever an
object that provides IBlat is expected.</p>
<p class="last">The interface implementation doesn&#8217;t enforce this.
but maybe it should do some checks.</p>
</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Interfaces</a><ul>
<li><a class="reference internal" href="#defining-interfaces">Defining interfaces</a></li>
<li><a class="reference internal" href="#declaring-interfaces">Declaring interfaces</a><ul>
<li><a class="reference internal" href="#declaring-implemented-interfaces">Declaring implemented interfaces</a></li>
<li><a class="reference internal" href="#declaring-provided-interfaces">Declaring provided interfaces</a></li>
<li><a class="reference internal" href="#inherited-declarations">Inherited declarations</a></li>
<li><a class="reference internal" href="#external-declarations">External declarations</a></li>
<li><a class="reference internal" href="#declaration-objects">Declaration Objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#interface-inheritance">Interface Inheritance</a><ul>
<li><a class="reference internal" href="#inheritance-of-attribute-specifications">Inheritance of attribute specifications</a></li>
<li><a class="reference internal" href="#specifications">Specifications</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tagged-values">Tagged Values</a></li>
<li><a class="reference internal" href="#invariants">Invariants</a></li>
<li><a class="reference internal" href="#adaptation">Adaptation</a><ul>
<li><a class="reference internal" href="#adapt">__adapt__</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to zope.interface&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="adapter.html"
                        title="next chapter">Adapter Registry</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/README.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="adapter.html" title="Adapter Registry"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to zope.interface’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">zope.interface 4.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012, Zope Foundation contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b2.
    </div>
  </body>
</html>