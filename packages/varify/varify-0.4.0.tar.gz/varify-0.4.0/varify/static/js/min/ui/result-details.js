define(["jquery","underscore","marionette","../models","./variant"],function(e,t,n,r,i){var s=n.Layout.extend({className:"result-details",template:"varify/result-details",maxExpandableHeight:360,showLessText:"Show Less...",showMoreText:"Show More...",ui:{expandableRows:"[data-target=expandable-row]",expandableItems:".expandable-item",expandCollapseLinks:"[data-target=expand-collapse-link]",linkContainers:".expand-collapse-container"},regions:{summary:"[data-target=summary]",effects:"[data-target=effects]",phenotypes:"[data-target=phenotypes]",scores:"[data-target=prediction-scores]",cohorts:"[data-target=cohorts]",frequencies:"[data-target=frequencies]",articles:"[data-target=articles]",clinvar:"[data-target=clinvar]",assessmentMetrics:"[data-target=assessment-metrics]"},events:{"click @ui.expandCollapseLinks":"toggleExpandedState"},initialize:function(){if(!(this.model=this.options.result))throw new Error("A valid result object must be supplied")},_checkForOverflow:function(){t.each(this.ui.expandableItems,function(t){var n,r=!1;for(var i=0;i<t.children.length;i++){n=t.children[i];if(n.offsetTop+n.offsetHeight>this.maxExpandableHeight){r=!0;break}}r?e(t).find(this.ui.linkContainers).show():e(t).find(this.ui.linkContainers).hide()},this)},toggleExpandedState:function(t){var n,r;n=e(t.target),r=n.closest(this.ui.expandableRows),n.text()===this.showMoreText?(r.find(this.ui.expandCollapseLinks).text(this.showLessText),r.css({height:"auto",overflow:"visible"})):(r.find(this.ui.expandCollapseLinks).text(this.showMoreText),r.css({height:this.maxExpandableHeight,overflow:"hidden"}))},onDomRefresh:function(){this._checkForOverflow()},onRender:function(){var e=new r.Variant(this.model.get("variant"));this.summary.show(new i.Summary({model:this.model})),this.effects.show(new i.Effects({collection:e.effects})),this.phenotypes.show(new i.Phenotypes({collection:e.phenotypes})),this.scores.show(new i.PredictionScores({model:e})),this.cohorts.show(new i.Cohorts({collection:e.cohorts})),this.frequencies.show(new i.Frequencies({model:e})),this.articles.show(new i.Articles({collection:e.articles})),this.clinvar.show(new i.Clinvar({collection:e.clinvarResults})),this.assessmentMetrics.show(new i.AssessmentMetrics({variantId:e.id})),this.bindUIElements(),this.ui.expandableRows.css("height",""+this.maxExpandableHeight+"px").css("overflow","hidden"),this.ui.expandCollapseLinks.text(this.showMoreText)}});return{ResultDetails:s}})