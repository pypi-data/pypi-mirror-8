define(["underscore","backbone","marionette","jquery","loglevel","./core","./ui"],function(e,t,n,o,i,a,r){function c(e){e=e||window.event;var t;t=e.type in f?f[e.type]:!this[s],t===!0?a.trigger("visible"):t===!1&&a.trigger("hidden")}a.templates.set(a.config.get("templates",{})),a.controls.set(a.config.get("controls",{}));var u=n.TemplateCache.prototype.loadTemplate,l=n.TemplateCache.prototype.compileTemplate;n.TemplateCache.prototype.loadTemplate=function(e){var t=a.templates.get(e);return t||(t=u.call(this,e)),t},n.TemplateCache.prototype.compileTemplate=function(e){return"function"!=typeof e&&(e=l(e)),e},e.exists=function(t){return!e.isUndefined(t)&&!e.isNull(t)};var d=new r.Notifications({id:"cilantro-notifications"});o("body").append(d.render().el),a.notify=d.notify,o.ajaxPrefilter(function(e){e.xhrFields={withCredentials:!0}}),a.config.get("debug")&&(i.setLevel("debug"),a.on("all",function(){i.info.apply(i.info,[].slice.call(arguments,0))})),o(window).on("beforeunload",function(){return a.config.get("debug")||!o.hasPendingRequest()?void o(document).off("ajaxError"):"Wow, you're quick! Your data is being saved. It will only take a moment."}),o(document).ajaxError(function(e,t,n,o){if("abort"!==t.statusText){var i="";i=0===t.status&&""===o?"The application is no longer responding.":'There is a communication problem with the server. <a href="#" onclick="location.reload()">Refreshing</a> the page may help.',a.notify({timeout:null,dismissable:!1,level:"error",header:"Uh oh.",message:i})}}),o(document).on("click","a",function(e){if(a.router){var n=this.pathname;"/"!==n.charAt(0)&&(n="/"+n);var o=t.history.root||"/";n.slice(0,o.length)===o&&(n=n.slice(o.length)),a.router.hasRoute(n)&&(e.preventDefault(),a.router.navigate(n,{trigger:!0}))}}),o(document).on("click","[data-route]",function(e){if(a.router){var t=o(e.target).attr("data-route");a.router.isNavigable(t)&&(e.preventDefault(),a.router.navigate(t,{trigger:!0}))}});var s="hidden",f={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};s in document?document.addEventListener("visibilitychange",c):(s="mozHidden")in document?document.addEventListener("mozvisibilitychange",c):(s="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",c):(s="msHidden")in document?document.addEventListener("msvisibilitychange",c):"onfocusin"in document?document.onfocusin=document.onfocusout=c:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=c});
//# sourceMappingURL=setup.js.map