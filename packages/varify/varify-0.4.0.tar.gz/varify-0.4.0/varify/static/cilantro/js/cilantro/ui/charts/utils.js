define(["underscore","highcharts"],function(t,e){var s,r,a,i,n;return r=function(t){var s;return s=e.getOptions().colors,s[t%s.length]},s=/\d{4}-\d{2]-\d{2]/,i=function(t){var e,s,r;return r=parseInt(t.substr(0,4)),s=parseInt(t.substr(5,2))-1,e=parseInt(t.substr(8,2)),Date.UTC(r,s,e)},n=function(t,s,a){var n,o,u,l,h,p,c,m,b,x,d,g,y,f,F,v,A,S,w,I,M,O,_,C,T,k,E,q,z,B,D,L,R,U,W,j,G,H;if(s.length>2)throw new Error("3-dimensional charts are not supported. Specify which field the series applies to.");if(!s)throw new Error("The field instances must be supplied");for(O=[],z=[],M=s[0],q=s[1],_=M.get("name"),I=M.get("enumerable")||"boolean"===M.get("simple_type"),C="date"===M.get("simple_type")?"datetime":"linear",q?(B=q.get("name"),E=q.get("enumerable")||"boolean"===q.get("simple_type"),D="date"===q.get("simple_type")?"datetime":"linear"):(B="Frequency",E=!1,D="linear"),I&&E?(o="scatter",O.push(" "),z.push(" ")):o=!q||I||E?E?"scatter":"column":"scatter",F={},u=t.clustered,G=t.data,p=R=0,W=G.length;W>R;p=++R)y=G[p],S=null!=a?y.values.slice(a,a+1)[0]:"",(f=F[S])?(f.data.push(y),f.stats.min=Math.min(f.stats.min,y.count),f.stats.max=Math.max(f.stats.max,y.count),f.stats.sum+=y.count):(f=F[S]={name:S,stats:{min:y.count,max:y.count,sum:y.count}},f.data=I&&E?[{x:0,y:0,radius:0,sentinel:!0},y]:[y]),w=y.values[0],null===w&&(w="(no data)"),I?(-1===(c=O.indexOf(w.toString()))&&(c=O.push(w.toString())-1),w=c):"datetime"===C&&(w=i(w)),q?(k=y.values[1],null===k&&(k="(no data)"),E?(-1===(c=z.indexOf(k.toString()))&&(c=z.push(k.toString())-1),k=c):"datetime"===D&&(k=i(k))):k=y.count,y.x=w,y.y=k;v=[],I&&E&&(T=O.push(" ")-1,L=z.push(" ")-1),A=0;for(b in F){if(f=F[b],I&&E&&(f.data.push({x:0,y:L,radius:0,sentinel:!0}),f.data.push({x:T,y:L,radius:0,sentinel:!0}),f.data.push({x:T,y:L,radius:0,sentinel:!0})),v.push(f),n=f.stats.avg=f.stats.sum/parseFloat(f.data.length,10),m=f.stats.max,"scatter"===o)for(H=f.data,U=0,j=H.length;j>U;U++)g=H[U],g.sentinel||(x=Math.min(Math.max(parseInt(parseFloat(g.count,10)/n*5)/10,.05),1),l=e.Color(r(A)).setOpacity(x),g.marker={fillColor:l.get()},I&&(g.marker.radius=7));A++}return h="scatter"===o&&I?v[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+_+":</b> "+this.series.xAxis.categories[this.point.x]+"<br /><b>"+B+":</b> "+this.series.yAxis.categories[this.point.y]}:function(){return"<b>"+_+":</b> "+this.series.xAxis.categories[this.point.x]+"<br /><b>"+B+":</b> "+this.series.yAxis.categories[this.point.y]}:"column"===o&&I?v[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+_+":</b> "+this.series.xAxis.categories[this.point.x]+"<br /><b>"+B+":</b> "+e.numberFormat(parseFloat(this.y))}:function(){return"<b>"+_+":</b> "+this.series.xAxis.categories[this.point.x]+"<br /><b>"+B+":</b> "+e.numberFormat(parseFloat(this.y))}:v[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+_+":</b> "+e.numberFormat(parseFloat(this.x))+"<br /><b>"+B+":</b> "+e.numberFormat(parseFloat(this.y))}:function(){return"<b>"+_+":</b> "+e.numberFormat(parseFloat(this.x))+"<br /><b>"+B+":</b> "+e.numberFormat(parseFloat(this.y))},d={clustered:u,chart:{type:o},title:{text:q?""+_+" vs. "+B:""+_+" "+B},series:v,xAxis:{title:{text:_},type:C},yAxis:{title:{text:B},type:D},tooltip:{formatter:h}},O.length&&(d.xAxis.categories=O),z.length&&(d.yAxis.categories=z),v[1]||(d.legend={enabled:!1}),"scatter"===o&&(d.yAxis.gridLineWidth=0,I||(d.chart.zoomType="xy")),d},a=function(e){var s,r,a,i,n;for(a=[],i=0,n=e.length;n>i;i++)s=e[i],r=t.clone(s),r.x=s.values[0],r.y=null!=s.values[1]?s.values[1]:s.count,a.push(r);return{data:t.sortBy(a,"x")}},{processResponse:n,getSeries:a}});
//# sourceMappingURL=utils.js.map