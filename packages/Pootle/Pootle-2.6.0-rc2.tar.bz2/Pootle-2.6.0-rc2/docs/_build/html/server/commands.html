<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Management commands &mdash; Pootle 2.6.0-rc1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.6.0-rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Pootle 2.6.0-rc1 documentation" href="../index.html" />
    <link rel="up" title="Administering a server" href="index.html" />
    <link rel="next" title="Developers" href="../developers/index.html" />
    <link rel="prev" title="Text indexing for Pootle" href="indexing.html" /> 
  </head>
  <body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="../index.html">Pootle</a>
        <span class="navbar-text pull-left"><b>2.6.0</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users/index.html">User&#8217;s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administering a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Pootle API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_docs.html">External documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
</ul>
</li>
              
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Management commands</a><ul>
<li><a class="reference internal" href="#running-wsgi-servers">Running WSGI servers</a><ul>
<li><a class="reference internal" href="#run-cherrypy">run_cherrypy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#managing-pootle-projects">Managing Pootle projects</a><ul>
<li><a class="reference internal" href="#refresh-stats">refresh_stats</a></li>
<li><a class="reference internal" href="#sync-stores">sync_stores</a></li>
<li><a class="reference internal" href="#update-stores">update_stores</a></li>
<li><a class="reference internal" href="#update-against-templates">update_against_templates</a></li>
<li><a class="reference internal" href="#update-translation-projects">update_translation_projects</a></li>
<li><a class="reference internal" href="#update-from-vcs">update_from_vcs</a></li>
<li><a class="reference internal" href="#commit-to-vcs">commit_to_vcs</a></li>
<li><a class="reference internal" href="#list-languages">list_languages</a></li>
<li><a class="reference internal" href="#list-projects">list_projects</a></li>
<li><a class="reference internal" href="#latest-change-id">latest_change_id</a></li>
<li><a class="reference internal" href="#assign-permissions">assign_permissions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#local-tm">Local TM</a><ul>
<li><a class="reference internal" href="#create-local-tm">create_local_tm</a></li>
</ul>
</li>
<li><a class="reference internal" href="#goals">Goals</a><ul>
<li><a class="reference internal" href="#add-project-goals">add_project_goals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manually-installing-pootle">Manually Installing Pootle</a><ul>
<li><a class="reference internal" href="#setup">setup</a></li>
<li><a class="reference internal" href="#syncdb">syncdb</a></li>
<li><a class="reference internal" href="#migrate">migrate</a></li>
<li><a class="reference internal" href="#initdb">initdb</a></li>
<li><a class="reference internal" href="#updatedb">updatedb</a></li>
<li><a class="reference internal" href="#upgrade">upgrade</a></li>
<li><a class="reference internal" href="#collectstatic">collectstatic</a></li>
<li><a class="reference internal" href="#assets">assets</a></li>
</ul>
</li>
<li><a class="reference internal" href="#useful-django-commands">Useful Django commands</a><ul>
<li><a class="reference internal" href="#changepassword">changepassword</a></li>
<li><a class="reference internal" href="#createsuperuser">createsuperuser</a></li>
<li><a class="reference internal" href="#dbshell">dbshell</a></li>
<li><a class="reference internal" href="#shell">shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-commands-in-cron">Running Commands in cron</a></li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="indexing.html"
         title="previous chapter">&laquo; Text indexing for Pootle</a></li>
  <li><a href="../developers/index.html"
         title="next chapter">Developers &raquo;</a></li>
            
          </ul>
          <ul class="nav pull-right">
            
              
            
          
            
<form class="navbar-search pull-right" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container content">
   
  <div class="section" id="management-commands">
<span id="commands"></span><h1>Management commands<a class="headerlink" href="#management-commands" title="Permalink to this headline">¶</a></h1>
<p>The management commands are administration commands provided by Django, Pootle
or any external Django app being used with Pootle. You will usually run these
commands by issuing <tt class="docutils literal"><span class="pre">pootle</span> <span class="pre">&lt;command&gt;</span> <span class="pre">[options]</span></tt>.</p>
<p>For example, to get information about all available management commands, you
will run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle <span class="nb">help</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you run Pootle from a repository checkout you can use the <em>manage.py</em> file
found in the root of the repository.</p>
</div>
<div class="section" id="running-wsgi-servers">
<span id="commands-running"></span><h2>Running WSGI servers<a class="headerlink" href="#running-wsgi-servers" title="Permalink to this headline">¶</a></h2>
<p>There are multiple ways to run Pootle, and some of them rely on running WSGI
servers that can be reverse proxied to a proper HTTP web server such as nginx
or lighttpd.</p>
<p>The Translate Toolkit offers a bundled CherryPy server but there are many more
options such as gunicorn, flup, paste, etc.</p>
<div class="section" id="run-cherrypy">
<span id="commands-run-cherrypy"></span><h3>run_cherrypy<a class="headerlink" href="#run-cherrypy" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>This command runs the CherryPy server bundled with the Translate Toolkit.</p>
<p>Available options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">--host</span></tt></dt>
<dd><p class="first">The hostname to listen on.</p>
<p class="last">Default: <tt class="docutils literal"><span class="pre">127.0.0.1</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--port</span></tt></dt>
<dd><p class="first">The TCP port on which the server should listen for new connections.</p>
<p class="last">Default: <tt class="docutils literal"><span class="pre">8080</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--threads</span></tt></dt>
<dd><p class="first">The number of working threads to create.</p>
<p class="last">Default: <tt class="docutils literal"><span class="pre">1</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--name</span></tt></dt>
<dd><p class="first">The name of the worker process.</p>
<p class="last">Default: <a class="reference external" href="https://docs.python.org/2.7/library/socket.html#socket.gethostname" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">socket.gethostname()</span></tt></a>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--queue</span></tt></dt>
<dd><p class="first">Specifies the maximum number of queued connections. This is the the
<tt class="docutils literal"><span class="pre">backlog</span></tt> argument to <tt class="xref py py-func docutils literal"><span class="pre">socket.listen()</span></tt>.</p>
<p class="last">Default: <tt class="docutils literal"><span class="pre">5</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--ssl_certificate</span></tt></dt>
<dd>The filename of the server SSL certificate.</dd>
<dt><tt class="docutils literal"><span class="pre">--ssl_privatekey</span></tt></dt>
<dd>The filename of the server&#8217;s private key file.</dd>
</dl>
</div>
</div>
<div class="section" id="managing-pootle-projects">
<span id="commands-managing-pootle-projects"></span><h2>Managing Pootle projects<a class="headerlink" href="#managing-pootle-projects" title="Permalink to this headline">¶</a></h2>
<p>These commands will go through all existing projects performing maintenance
tasks. The tasks are all available through the web interface but on a project
by project or file by file basis.</p>
<p>All commands in this category accept a <tt class="docutils literal"><span class="pre">--directory</span></tt> command line option that
limits its action to a path relative to the <em>po/</em> directory.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.1.2.</span></p>
</div>
<p>The commands target can be limited in a more flexible way using the <tt class="docutils literal"><span class="pre">--project</span></tt>
<tt class="docutils literal"><span class="pre">--language</span></tt> command line options. They can be repeated to indicate multiple
languages or projects. If you use both options together it will only match the
files that match both languages and projects selected.</p>
<p>If you need to limit the commands to certain files or subdirectories you can
use the <tt class="docutils literal"><span class="pre">--path-prefix</span></tt> option, path should be relative to project/language
pair.</p>
<p>For example, to <em>refresh_stats</em> for the tutorial project only, run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle refresh_stats --project<span class="o">=</span>tutorial
</pre></div>
</div>
<p>To only refresh a the Zulu and Basque language files within the tutorial
project, run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle refresh_stats --project<span class="o">=</span>tutorial --language<span class="o">=</span>zu --language<span class="o">=</span>eu
</pre></div>
</div>
<div class="section" id="refresh-stats">
<span id="commands-refresh-stats"></span><h3>refresh_stats<a class="headerlink" href="#refresh-stats" title="Permalink to this headline">¶</a></h3>
<p>This command will go through all existing projects making sure calculated data
is up to date. Running <tt class="docutils literal"><span class="pre">refresh_stats</span></tt> immediately after an install, upgrade
or after adding a large number of files will ensure statistics, such as word
and suggestion counts, are up to date. On large installations, refresh_stats
can take several tens of minutes to fully run through all projects.</p>
<p><tt class="docutils literal"><span class="pre">refresh_stats</span></tt> will flush existing caches and update the statistics cache.</p>
<p>When the <tt class="docutils literal"><span class="pre">--calculate-checks</span></tt> option is set, quality checks will be
recalculated for all existing units in the database. This is a very expensive
operation.</p>
</div>
<div class="section" id="sync-stores">
<span id="commands-sync-stores"></span><h3>sync_stores<a class="headerlink" href="#sync-stores" title="Permalink to this headline">¶</a></h3>
<p>This command will save all translations currently in the database to the file
system, thereby bringing the files under the <a class="reference internal" href="settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a> directory
in sync with the Pootle database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For better performance Pootle keeps translations in database and
doesn&#8217;t save them to disk except on demand (before file downloads and
major file level operations like version control updates).</p>
</div>
<p>You must run this command before taking backups or running scripts that modify
the translation files directly on the file system, otherwise you might miss out
on translations that are in database but not yet saved to disk.</p>
<p>When the <tt class="docutils literal"><span class="pre">--overwrite</span></tt> option is specified, the sync operation will not be
conservative and it will overwrite the existing files on disk, making strings
obsolete and updating the file&#8217;s structure.</p>
<p>With the <tt class="docutils literal"><span class="pre">--skip-missing</span></tt> option, files that are missing on disk will be
ignored, and no new files will be created.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>With the <tt class="docutils literal"><span class="pre">--modified-since</span></tt> option it is possible to give a change identifier
(from the output of <a class="reference internal" href="#commands-latest-change-id"><em>latest_change_id</em></a>) to specifically indicate
which changes need to be synced to disk. This will override Pootle on what
has/hasn&#8217;t been synced to disk, and specifically those changes will be synced.
Note that bulk changes (from uploads and version control actions) don&#8217;t yet
record fine-grained changes, and these will therefore not be synced to disk.
However, these should already be on disk, since those actions always sync to
disk anyway.</p>
</div>
<div class="section" id="update-stores">
<span id="commands-update-stores"></span><h3>update_stores<a class="headerlink" href="#update-stores" title="Permalink to this headline">¶</a></h3>
<p>This command is the opposite of <a class="reference internal" href="#commands-sync-stores"><em>sync_stores</em></a>. It will update the
strings in database to reflect what is on disk, as Pootle will not detect
changes in the file system on its own.</p>
<p>It will also discover and import any new files added to existing languages
within the projects.</p>
<p>You must run this command after running scripts that modify translation files
directly on the file system.</p>
<p><tt class="docutils literal"><span class="pre">update_stores</span></tt> has an extra command line option <tt class="docutils literal"><span class="pre">--keep</span></tt> that will
prevent it from overwriting any existing translation in the database, thus
only updating new translations, removing obsolete strings and discovering
new files and strings.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.5.1.</span></p>
</div>
<p>Note that <tt class="docutils literal"><span class="pre">--keep</span></tt> doesn&#8217;t keep obsolete units around anymore, they are
either deleted in case the string is untranslated or marked as obsolete in
case the string was translated.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.5.</span></p>
</div>
<p>Along with <tt class="docutils literal"><span class="pre">--keep</span></tt>, the <tt class="docutils literal"><span class="pre">--modified-since</span></tt> option can be used to
control the set of translations that will be updated: translations with a
change ID <strong>greater than</strong> the given value will be kept.</p>
<p>To illustrate the results of these two options, the following table
emulates the behavior of a <tt class="docutils literal"><span class="pre">pootle</span> <span class="pre">update_stores</span> <span class="pre">--modified-since=5</span>
<span class="pre">--keep</span></tt> run:</p>
<table border="1" class="docutils">
<colgroup>
<col width="58%" />
<col width="18%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File on disk</th>
<th class="head">DB before
(change ID)</th>
<th class="head">DB after
(result)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>New string appeared in existing file</td>
<td>&lt;none&gt;</td>
<td>String added</td>
</tr>
<tr class="row-odd"><td>Existing string changed in existing file</td>
<td>&lt;none&gt;</td>
<td>String updated</td>
</tr>
<tr class="row-even"><td>Existing string changed in existing file</td>
<td>2</td>
<td>String updated</td>
</tr>
<tr class="row-odd"><td>Existing string changed in existing file</td>
<td>5</td>
<td>String updated</td>
</tr>
<tr class="row-even"><td>Existing string changed in existing file</td>
<td>8</td>
<td>String kept</td>
</tr>
<tr class="row-odd"><td>New string in a new file</td>
<td>&lt;none&gt;</td>
<td>String added</td>
</tr>
<tr class="row-even"><td>String removed from the file</td>
<td>3</td>
<td>String removed</td>
</tr>
<tr class="row-odd"><td>String removed from the file</td>
<td>10</td>
<td>String removed</td>
</tr>
<tr class="row-even"><td>File removed</td>
<td>4</td>
<td>Strings removed</td>
</tr>
<tr class="row-odd"><td>File removed</td>
<td>12</td>
<td>Strings removed</td>
</tr>
</tbody>
</table>
<p>By default, <tt class="docutils literal"><span class="pre">update_stores</span></tt> will only update files that appear to have changed
on disk since the last synchronization with Pootle. To force all files to
update, specify <tt class="docutils literal"><span class="pre">--force</span></tt>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If files on the file system are corrupt, translations might be
deleted from the database. Handle with care!</p>
</div>
</div>
<div class="section" id="update-against-templates">
<span id="commands-update-against-templates"></span><h3>update_against_templates<a class="headerlink" href="#update-against-templates" title="Permalink to this headline">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.5: </span>The name of the command has been renamed from <tt class="docutils literal"><span class="pre">update_from_templates</span></tt>.</p>
</div>
<p>Updates languages to match what is present in the translation templates.</p>
<p>This command is essentially an interface to the
Translate Toolkit command <a class="reference external" href="http://docs.translatehouse.org/projects/translate-toolkit/en/latest/commands/pot2po.html#pot2po" title="(in Translate Toolkit v1.13.0)"><em class="xref std std-ref">pot2po</em></a> with special Pootle
specific routines to update the database and file system to reflect the
latest version of translation templates for each language in a project.</p>
<p>During the process, translations existing in the database will first be synced
to disk (only in bilingual formats), then they will be updated against the
latest templates and after that the database will also be updated to reflect
the latest changes.</p>
<p>When updating existing translated files under a given language, the command
will retain any existing translations, fuzzy matching is performed on strings
with minor changes, and unused translations will be marked as obsolete. New
template files will initialize new untranslated files.</p>
<p>It is unlikely you will ever need to run this command for all projects at once.
Use the <tt class="docutils literal"><span class="pre">--directory</span></tt>, <tt class="docutils literal"><span class="pre">--project</span></tt> or <tt class="docutils literal"><span class="pre">--language</span></tt> command line options
to be specific about the project, language or project/language pair you want to
target.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the template files are corrupt translations might be lost.
If you generate templates based on a script make sure they are in good
shape.</p>
</div>
</div>
<div class="section" id="update-translation-projects">
<span id="commands-update-translation-projects"></span><h3>update_translation_projects<a class="headerlink" href="#update-translation-projects" title="Permalink to this headline">¶</a></h3>
<p>This command scans project directories looking for files matching languages not
added to the project then adds them. It basically repeats the discovery process
done by Pootle when you create a new project.</p>
<p>Using the <tt class="docutils literal"><span class="pre">--cleanup</span></tt> command line option, languages added to projects that
no longer have matching files on the filesystem will be deleted.</p>
</div>
<div class="section" id="update-from-vcs">
<span id="commands-update-from-vcs"></span><h3>update_from_vcs<a class="headerlink" href="#update-from-vcs" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>This command updates the specified files from their <a class="reference internal" href="../features/version_control.html"><em>Version Control
System(s)</em></a>. It supports the <tt class="docutils literal"><span class="pre">--directory</span></tt>,
<tt class="docutils literal"><span class="pre">--project</span></tt>, and <tt class="docutils literal"><span class="pre">--language</span></tt> parameters.</p>
<p>Pootle will take care to avoid version control conflicts, and will handle any
conflicts on a string level, just like it would if the update was done through
the web front-end.</p>
<p>The command first syncs database contents to disk.</p>
</div>
<div class="section" id="commit-to-vcs">
<span id="commands-commit-to-vcs"></span><h3>commit_to_vcs<a class="headerlink" href="#commit-to-vcs" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>This command commits the specified files to their <a class="reference internal" href="../features/version_control.html"><em>Version Control
System(s)</em></a>. It supports the <tt class="docutils literal"><span class="pre">--directory</span></tt>,
<tt class="docutils literal"><span class="pre">--project</span></tt>, and <tt class="docutils literal"><span class="pre">--language</span></tt> parameters.</p>
<p>A file needs to be up to date, otherwise the commit will fail. Files can be
updated inside Pootle, or using the <a class="reference internal" href="#commands-update-from-vcs"><em>update_from_vcs</em></a> command.
This is not done automatically, otherwise the merged version of the file will
be committed without review without anybody knowing.</p>
</div>
<div class="section" id="list-languages">
<span id="commands-list-languages"></span><h3>list_languages<a class="headerlink" href="#list-languages" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>This command prints all the language codes on the server. This might be useful
for automation.</p>
<p>Accepts the <tt class="docutils literal"><span class="pre">--modified-since</span></tt> parameter to list only those languages
modified since the change id given by <a class="reference internal" href="#commands-latest-change-id"><em>latest_change_id</em></a>.</p>
<p>The option <tt class="docutils literal"><span class="pre">--project</span></tt> limits the output to one or more projects. Specify the
option multiple times for more than one project.</p>
</div>
<div class="section" id="list-projects">
<span id="commands-list-projects"></span><h3>list_projects<a class="headerlink" href="#list-projects" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>This command prints all the project codes on the server. This might be useful
for automation.</p>
<p>Accepts the <tt class="docutils literal"><span class="pre">--modified-since</span></tt> parameter to list only those projects
modified since the change id given by <a class="reference internal" href="#commands-latest-change-id"><em>latest_change_id</em></a>.</p>
</div>
<div class="section" id="latest-change-id">
<span id="commands-latest-change-id"></span><h3>latest_change_id<a class="headerlink" href="#latest-change-id" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>This command prints the ID of the latest change (submission) made on the
server. This is mostly useful in combination with other commands that operate
with these IDs.</p>
</div>
<div class="section" id="assign-permissions">
<span id="commands-assign-permissions"></span><h3>assign_permissions<a class="headerlink" href="#assign-permissions" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.6.0.</span></p>
</div>
<p>This command allows to assign permissions for a given user in a project,
language or translation project.</p>
<p>This command has two mandatory options: <em class="xref std std-option">--permissions</em> and
<em class="xref std std-option">--user</em>. It is also mandatory to either provide <em class="xref std std-option">--language</em>
or <em class="xref std std-option">--project</em>.</p>
<p>It is possible to provide both <em class="xref std std-option">--language</em> and <em class="xref std std-option">--project</em> at
the same time to indicate that the permissions should be applied only for a
given project inside a given language (i.e. for a given translation project).</p>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Accepted value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em class="xref std std-option">--user</em></td>
<td>Valid username</td>
</tr>
<tr class="row-odd"><td><em class="xref std std-option">--language</em></td>
<td>Valid language code</td>
</tr>
<tr class="row-even"><td><em class="xref std std-option">--project</em></td>
<td>Valid project code</td>
</tr>
<tr class="row-odd"><td><em class="xref std std-option">--permissions</em></td>
<td>Comma separated list of valid
permission codenames</td>
</tr>
</tbody>
</table>
<p>Check the list of <a class="reference internal" href="../features/permissions.html#permissions-available-permissions"><em>available permissions</em></a> to know which permissions you can use.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All of the options, including <em class="xref std std-option">--language</em>, can only be
provided once, and all of them accept only one value.</p>
</div>
<p>The following example assigns the <tt class="docutils literal"><span class="pre">review</span></tt>, <tt class="docutils literal"><span class="pre">view</span></tt>, <tt class="docutils literal"><span class="pre">translate</span></tt> and
<tt class="docutils literal"><span class="pre">suggest</span></tt> permissions to the <tt class="docutils literal"><span class="pre">sauron</span></tt> user in the <tt class="docutils literal"><span class="pre">task-123</span></tt> project for
the language <tt class="docutils literal"><span class="pre">de_AT</span></tt>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle assign_permissions --user<span class="o">=</span>sauron --language<span class="o">=</span>de_AT --project<span class="o">=</span>task-123 --permissions<span class="o">=</span>review,view,translate,suggest
</pre></div>
</div>
<p>The following example assigns the <tt class="docutils literal"><span class="pre">translate</span></tt> permission to the <tt class="docutils literal"><span class="pre">sauron</span></tt>
user in the <tt class="docutils literal"><span class="pre">task-123</span></tt> project.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle assign_permissions --user<span class="o">=</span>sauron --project<span class="o">=</span>task-123 --permissions<span class="o">=</span>translate
</pre></div>
</div>
</div>
</div>
<div class="section" id="local-tm">
<span id="commands-local-tm"></span><h2>Local TM<a class="headerlink" href="#local-tm" title="Permalink to this headline">¶</a></h2>
<p>These commands allow you to perform tasks with the local Translation Memory
from the command line.</p>
<div class="section" id="create-local-tm">
<span id="commands-create-local-tm"></span><h3>create_local_tm<a class="headerlink" href="#create-local-tm" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.6.0.</span></p>
</div>
<p>This command allows to create a local Translation Memory for Pootle usage by
using already existing translated units in Pootle database. To run it just
type:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle create_local_tm
</pre></div>
</div>
<p>Also you can run it providing the <em class="xref std std-option">--project</em> and <em class="xref std std-option">--language</em>
optional options:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle create_local_tm --project<span class="o">=</span>firefox --language<span class="o">=</span>af --language<span class="o">=</span>gl
</pre></div>
</div>
<p>Despite these two options are optional, it is highly recommended to run this
command using one <em class="xref std std-option">--project</em> when dealing with a Pootle instance with
projects that together have a lot of units. Also in the specific case where the
given project has too many units it is recommended to provide one or several
<em class="xref std std-option">--language</em> options.</p>
<p>This command also has one optional option <em class="xref std std-option">--drop-local-tm</em> which is
used to tell whether the local TM (if it exists) should be dropped before
recreating it:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle create_local_tm --drop-local-tm --project<span class="o">=</span>firefox --language<span class="o">=</span>af --language<span class="o">=</span>gl
</pre></div>
</div>
</div>
</div>
<div class="section" id="goals">
<span id="commands-goals"></span><h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>These commands allow you to perform tasks with goals from the command line.</p>
<div class="section" id="add-project-goals">
<span id="commands-add-project-goals"></span><h3>add_project_goals<a class="headerlink" href="#add-project-goals" title="Permalink to this headline">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.6.0.</span></p>
</div>
<p>This command allows you to create <strong>project goals</strong> for a given project reading
them from a phaselist file.</p>
<p>Such file comprises two sections.</p>
<p>The first section has several lines where each line consists on three fields
separated by a tab. The first field includes a mandatory name for the goal, the
second an optional numeric priority for the goal (being 1 the highest
priority), and a third optional field with the goal description that can span
several lines. The tabs separating the fields must always be present, even if
they are not specified.</p>
<p>The second section has several lines where each line consists on two fields
separated by a tab. The first field specifies a goal name and the second one is
the path of a file:</p>
<div class="highlight-ini"><div class="highlight"><pre>[goals]
user1       1       Most visible strings for the user.
user2       2
user3       7
other
developer   9       Strings for developer \
tools. As you can see this description spans \
several lines.
install     5       Installation related strings.
[files]
user1       ./browser/branding/official/brand.dtd.pot
other       ./browser/chrome/browser/aboutCertError.dtd.pot
user1       browser/chrome/browser/aboutDialog.dtd.pot
user2       browser/chrome/browser/aboutSessionRestore.dtd.pot
developer   ./browser/chrome/browser/devtools/appcacheutils.properties.pot
developer   browser/chrome/browser/devtools/debugger.dtd.pot
user2       browser/chrome/browser/downloads/downloads.dtd.pot
user3       browser/chrome/browser/engineManager.dtd.pot
install     browser/chrome/browser/migration/migration.dtd.pot
install     ./browser/chrome/browser/migration/migration.properties.pot
</pre></div>
</div>
<p>The goals are created if necessary. If the goal exists and has any relationship
to any store, that relationships are deleted to make sure that the goals
specified on the phaselist file are only applied to the specified stores.</p>
<p>After all goals are created then they are tied to the files on template
translation project for the project as they are specified on the phaselist
file. If any specified file does not exist for the template translation project
on the given project then it is skipped.</p>
<p>This command has two mandatory options: <em class="xref std std-option">--project</em> and
<em class="xref std std-option">--filename</em>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle add_project_goals --project<span class="o">=</span>tutorial --filename<span class="o">=</span>phaselist.txt
</pre></div>
</div>
</div>
</div>
<div class="section" id="manually-installing-pootle">
<span id="commands-manually-installing-pootle"></span><h2>Manually Installing Pootle<a class="headerlink" href="#manually-installing-pootle" title="Permalink to this headline">¶</a></h2>
<p>These commands expose the database installation and upgrade process from the
command line.</p>
<div class="section" id="setup">
<span id="commands-setup"></span><h3>setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.1.</span></p>
</div>
<p>This command either initializes a new DB or upgrades an existing DB, as
required.</p>
</div>
<div class="section" id="syncdb">
<span id="commands-syncdb"></span><h3>syncdb<a class="headerlink" href="#syncdb" title="Permalink to this headline">¶</a></h3>
<p>Originally, <tt class="docutils literal"><span class="pre">syncdb</span></tt> was a generic Django management command that creates
empty database tables. It has been customized for Pootle to create everything
required for a bare bones install for releases up to 2.5.0. This includes
database tables, default permissions, some default objects used internally by
Pootle (like the <em>&#8220;default&#8221;</em> and <em>&#8220;nobody&#8221;</em> user profiles) and the special
<a class="reference internal" href="../features/terminology.html#terminology"><em>Terminology</em></a> project and
<a class="reference internal" href="../features/templates.html#templates-the-templates-language"><em>Templates language</em></a>.</p>
<p>For releases up to 2.5.0, if you just run <tt class="docutils literal"><span class="pre">syncdb</span></tt> you will have a usable
Pootle install but you will need to create all languages manually, and you will
not have a tutorial project to play with.  For releases after 2.5.0, <tt class="docutils literal"><span class="pre">syncdb</span></tt>
is not sufficient to create the database schema; it will remain incomplete and
unusable until you apply all migrations to the database schema by running the
<a class="reference internal" href="#commands-migrate"><em>migrate</em></a> command.</p>
</div>
<div class="section" id="migrate">
<span id="commands-migrate"></span><h3>migrate<a class="headerlink" href="#migrate" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.1.</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the addition of the <a class="reference internal" href="#commands-setup"><em>setup</em></a> management command it
is not necessary to directly run this command. Please refer to the
<a class="reference internal" href="upgrading.html#upgrading"><em>Upgrading</em></a> or <a class="reference internal" href="installation.html#installation"><em>Installation</em></a>
instructions to see how to run the <tt class="docutils literal"><span class="pre">setup</span></tt> management command in those
scenarios.</p>
</div>
<p>This is South&#8217;s <a class="reference external" href="https://south.readthedocs.org/en/latest/commands.html#commands" title="(in South v1.0)"><em class="xref std std-ref">migrate command</em></a>, which applies
migrations to bring the database up to the latest schema revision. It is
required for releases after 2.5.0, even for a fresh install where you are not
upgrading from a previous release.</p>
</div>
<div class="section" id="initdb">
<span id="commands-initdb"></span><h3>initdb<a class="headerlink" href="#initdb" title="Permalink to this headline">¶</a></h3>
<p>This is Pootle&#8217;s install process, it creates the default <em>admin</em> user, populates
the language table with several languages with their correct fields, initializes
several terminology projects, and creates the tutorial project.</p>
<p><tt class="docutils literal"><span class="pre">initdb</span></tt> can only be run after <a class="reference internal" href="#commands-syncdb"><em>syncdb</em></a> and <a class="reference internal" href="#commands-migrate"><em>migrate</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">initdb</span></tt> will not import translations into the database, so the
first visit to Pootle after <tt class="docutils literal"><span class="pre">initdb</span></tt> will be very slow. <strong>It is
best to run</strong> <a class="reference internal" href="#commands-refresh-stats"><em>refresh_stats</em></a> <strong>immediately after initdb</strong>.</p>
</div>
</div>
<div class="section" id="updatedb">
<span id="commands-updatedb"></span><h3>updatedb<a class="headerlink" href="#updatedb" title="Permalink to this headline">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.5.1.</span></p>
</div>
<p>This is a command line interface to Pootle&#8217;s database schema upgrade
process.</p>
<p>This will only perform schema upgrades to version 2.5 from Pootle versions
older than 2.5. To upgrade to version 2.5.1 and later South&#8217;s
<a class="reference external" href="https://south.readthedocs.org/en/latest/commands.html#commands" title="(in South v1.0)"><em class="xref std std-ref">migrate command</em></a> must be used, after upgrading
to version 2.5.</p>
<p>For detailed instructions on upgrading, read the <a class="reference internal" href="upgrading.html#upgrading"><em>Upgrading</em></a> section
of the documentation.</p>
</div>
<div class="section" id="upgrade">
<span id="commands-upgrade"></span><h3>upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.1.</span></p>
</div>
<p>Performs post schema upgrade actions that are necessary to leave all the
bits in place. It also serves as a trigger for any changes needed by
Translate Toolkit version upgrades.</p>
<p>Optionally, the command accepts the <tt class="docutils literal"><span class="pre">--calculate-stats</span></tt> flag, which will
calculate full translation statistics after doing the upgrade.</p>
<p>Also, the <tt class="docutils literal"><span class="pre">--flush-checks</span></tt> flag forces flushing the existing quality
checks. This is useful when new quality checks have been added or existing
ones have been updated, but take into account that <strong>this operation is
very expensive</strong>.</p>
<p>For detailed instructions on upgrading, read the <a class="reference internal" href="upgrading.html#upgrading"><em>Upgrading</em></a> section
of the documentation.</p>
</div>
<div class="section" id="collectstatic">
<span id="commands-collectstatic"></span><h3>collectstatic<a class="headerlink" href="#collectstatic" title="Permalink to this headline">¶</a></h3>
<p>Running the Django admin <a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/#django-admin-collectstatic" title="(in Django v1.8)"><tt class="docutils literal"><span class="pre">collectstatic</span></tt></a> command finds
and extracts static content such as images, CSS and JavaScript files used by
the Pootle server, so that they can be served separately from a static
webserver.  Typically, this is run with the <em class="xref std std-option">--clear</em>
<em class="xref std std-option">--noinput</em> options, to flush any existing static data and use default
answers for the content finders.</p>
</div>
<div class="section" id="assets">
<span id="commands-assets"></span><h3>assets<a class="headerlink" href="#assets" title="Permalink to this headline">¶</a></h3>
<p>Pootle uses the Django app <a class="reference external" href="http://elsdoerfer.name/docs/django-assets/">django-assets</a> interface of <cite>webassets</cite> to minify
and bundle CSS and JavaScript; this app has a management command that is used
to make these preparations using the command <tt class="docutils literal"><span class="pre">assets</span> <span class="pre">build</span></tt>. This command is
usually executed after the <a class="reference internal" href="#commands-collectstatic"><em>collectstatic</em></a> one.</p>
</div>
</div>
<div class="section" id="useful-django-commands">
<span id="commands-useful-django-commands"></span><h2>Useful Django commands<a class="headerlink" href="#useful-django-commands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="changepassword">
<span id="commands-changepassword"></span><h3>changepassword<a class="headerlink" href="#changepassword" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pootle changepassword &lt;username&gt;
</pre></div>
</div>
<p>This can be used to change the password of any user from the command line.</p>
</div>
<div class="section" id="createsuperuser">
<span id="commands-createsuperuser"></span><h3>createsuperuser<a class="headerlink" href="#createsuperuser" title="Permalink to this headline">¶</a></h3>
<p>This creates a new admin user. It will prompt for username, password and email
address.</p>
</div>
<div class="section" id="dbshell">
<span id="commands-dbshell"></span><h3>dbshell<a class="headerlink" href="#dbshell" title="Permalink to this headline">¶</a></h3>
<p>This opens a database command prompt with the Pootle database already loaded.
It is useful if you know SQL.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Try not to break anything.</p>
</div>
</div>
<div class="section" id="shell">
<span id="commands-shell"></span><h3>shell<a class="headerlink" href="#shell" title="Permalink to this headline">¶</a></h3>
<p>This opens a Python shell with the Django and Pootle environment already
loaded. Useful if you know a bit of Python or the Django models syntax.</p>
</div>
</div>
<div class="section" id="running-commands-in-cron">
<span id="commands-running-in-cron"></span><h2>Running Commands in cron<a class="headerlink" href="#running-commands-in-cron" title="Permalink to this headline">¶</a></h2>
<p>If you want to schedule certain actions on your Pootle server, using management
commands with cron might be a solution.</p>
<p>The management commands can perform certain batch commands which you might want
to have executed periodically without user intervention.</p>
<p>For the full details on how to configure cron, read your platform documentation
(for example <tt class="docutils literal"><span class="pre">man</span> <span class="pre">crontab</span></tt>). Here is an example that runs the
<a class="reference internal" href="#commands-refresh-stats"><em>refresh_stats</em></a> command daily at 02:00 AM:</p>
<div class="highlight-python"><div class="highlight"><pre>00 02 * * * www-data /var/www/sites/pootle/manage.py refresh_stats
</pre></div>
</div>
<p>Test your command with the parameters you want from the command line. Insert it
in the cron table, and ensure that it is executed as the correct user (the same
as your web server) like <em>www-data</em>, for example. The user executing the
command is specified in the sixth column. Cron might report errors through
local mail, but it might also be useful to look at the logs in
<em>/var/log/cron/</em>, for example.</p>
<p>If you are running Pootle from a virtualenv, or if you set any custom
<tt class="docutils literal"><span class="pre">PYTHONPATH</span></tt> or similar, you might need to run your management command from a
bash script that creates the correct environment for your command to run from.
Call this script then from cron. It shouldn&#8217;t be necessary to specify the
settings file for Pootle — it should automatically be detected.</p>
</div>
</div>


</div>
<hr>

<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top ↑</a></p>
    <ul class="unstyled muted">
      <li><small>
        &copy; 2004-2014, Translate.<br/>
      </small></li>
      <li><small>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
      </small></li>
    </ul>
  </div>
</footer>
  </body>
</html>