<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Integration with Version Control Systems &mdash; Pootle 2.6.0-rc1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.6.0-rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Pootle 2.6.0-rc1 documentation" href="../index.html" />
    <link rel="up" title="Features" href="index.html" />
    <link rel="next" title="Alternative source language" href="alternative_source_language.html" />
    <link rel="prev" title="Translation templates" href="templates.html" /> 
  </head>
  <body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="../index.html">Pootle</a>
        <span class="navbar-text pull-left"><b>2.6.0</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users/index.html">User&#8217;s guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/index.html">Administering a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Pootle API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_docs.html">External documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
</ul>
</li>
              
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Integration with Version Control Systems</a><ul>
<li><a class="reference internal" href="#supported-systems">Supported systems</a></li>
<li><a class="reference internal" href="#preparation">Preparation</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-treat-special-directory-layouts">How to treat special directory layouts</a></li>
<li><a class="reference internal" href="#working-with-vcs-integrated-projects">Working with VCS integrated projects</a><ul>
<li><a class="reference internal" href="#updating">Updating</a></li>
<li><a class="reference internal" href="#committing">Committing</a><ul>
<li><a class="reference internal" href="#version-control-authentication">Version Control Authentication</a><ul>
<li><a class="reference internal" href="#subversion-http">Subversion (HTTP)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#adding">Adding</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="templates.html"
         title="previous chapter">&laquo; Translation templates</a></li>
  <li><a href="alternative_source_language.html"
         title="next chapter">Alternative source language &raquo;</a></li>
            
          </ul>
          <ul class="nav pull-right">
            
              
            
          
            
<form class="navbar-search pull-right" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container content">
   
  <div class="section" id="integration-with-version-control-systems">
<span id="version-control"></span><h1>Integration with Version Control Systems<a class="headerlink" href="#integration-with-version-control-systems" title="Permalink to this headline">¶</a></h1>
<p>Pootle has the ability to integrate with version control systems (also called
revision control systems). Read more on Wikipedia for a general overview of
what a <a class="reference external" href="https://en.wikipedia.org/wiki/Revision_control">Version Control System</a> is.</p>
<div class="section" id="supported-systems">
<span id="version-control-supported-systems"></span><h2>Supported systems<a class="headerlink" href="#supported-systems" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="78%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">System</th>
<th class="head">Status</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Concurrent_Versions_System">CVS</a></td>
<td>Supported</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Apache_Subversion">Subversion</a></td>
<td>Supported</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Darcs">Darcs</a></td>
<td>Supported</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Git_(software)">Git</a></td>
<td>Supported</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Bazaar_(software)">Bazaar</a></td>
<td>Supported</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Mercurial">Mercurial</a></td>
<td>Supported</td>
</tr>
</tbody>
</table>
<p>It should be possible to add other systems fairly easily. Interested
programmers can look at the <a class="reference external" href="https://github.com/translate/translate/tree/master/translate/storage/versioncontrol">versioncontrol</a>
module.</p>
</div>
<div class="section" id="preparation">
<span id="version-control-preparation"></span><h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<div class="last versionchanged">
<p><span class="versionmodified">Changed in version 2.5: </span><a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> was introduced for separating version control
directories.  Previously your <a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a> contained your files
from version control. Separation allows Pootle to work reliably on
Distributed Version Control Systems (Git, Mercurial, etc).</p>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The setup of version control has to be done outside of the Pootle
admin interface.</p>
</div>
<p>To have any sort of integration with version control from within Pootle, it is
necessary to construct the correct file system structure in the
<a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> as defined in the settings. Any projects integrating
with a version control system have to follow a layout that corresponds to the
<a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>. The <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> is <em>pootle/repos</em> by
default and should contain one directory for each project on the server that is
either a clone/checkout for the corresponding Pootle project, or a symlink (or
a directory with symlinks) to the repo somewhere else on the file system.</p>
<p>The <a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a> therefore contains the translation files used during
normal operation of Pootle, and the <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> contains &#8220;clean&#8221;
versions (with no uncommitted changes) that enables the version control
integration. The meta files for the version control system (<em>CVS/</em>, <em>.svn/</em>,
<em>.hg</em>, <em>.git</em>, etc.) therefore should be present in <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a>
for Pootle to perform the integration.</p>
<p>An example layout:</p>
<div class="highlight-python"><div class="highlight"><pre>.../
|-- po
|   `-- project1
|       |-- de.po
|       |-- fr.po
|       `-- pt_BR.po
`-- repos
    `-- project1
        |-- de.po
        |-- fr.po
        `-- pt_BR.po
</pre></div>
</div>
<p>Here <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> is <tt class="docutils literal"><span class="pre">.../repos</span></tt> and <a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a> is
<tt class="docutils literal"><span class="pre">.../po</span></tt>.  The directory <tt class="docutils literal"><span class="pre">.../repos/project1</span></tt> contains a clean checkout of
the translations from version control.  This is where Pootle will perform any
version control actions such as updates and commits.</p>
<p>The <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> should never contain uncommitted changes. Pootle
will bring in changes from the upstream VCS and rely on it succeeding without
conflicts.</p>
<div class="section" id="example">
<span id="version-control-example"></span><h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>$ cd pootle/repos/
$ svn co https://translate.svn.sourceforge.net/svnroot/translate/src/trunk/Pootle/po/pootle
</pre></div>
</div>
<p>Now you have the directory <em>pootle</em> containing a translation project. If that
directory is now one of your projects registered on the server, the version
control functions should appear for all users with the necessary privileges.
Look for the functions under the actions on the overview page.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The summary of steps to add a new project which will use a VCS are:</p>
<ol class="arabic simple">
<li>Create a local copy of the repository in <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> (for
example using <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">checkout</span></tt> in Subversion, or <tt class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span></tt> in Git),</li>
<li>Copy the newly created directory, which holds the translation files for
the new project, from <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> to <a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>,</li>
<li>Add the project via the administration panel. Remember that the project
code should match the project directory name both in
<a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> and <a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>.</li>
</ol>
<p class="last">The project will be automatically imported by Pootle.</p>
</div>
</div>
</div>
<div class="section" id="how-to-treat-special-directory-layouts">
<span id="version-control-how-to-treat-special-directory-layouts"></span><h2>How to treat special directory layouts<a class="headerlink" href="#how-to-treat-special-directory-layouts" title="Permalink to this headline">¶</a></h2>
<p>There exists some conventions for directories.</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Convention</th>
<th class="head">Directory structure</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Standard convention</td>
<td><a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>/project_name/language_code/files.po</td>
</tr>
<tr class="row-odd"><td>GNU convention</td>
<td><a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>/project_name/language_code.po</td>
</tr>
</tbody>
</table>
<p>Is the directory structure for the language files of your project different
from the default structure found in the source project?</p>
<p>If yes, then you might consider using symlinking every single language file to
the expected location. The version control support of Pootle will follow these
links. Thus the meta directories of your version control system (e.g.: <em>.svn/</em>
or <em>CVS/</em>) do not necessarily have to be below your <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a>
(see your settings for the value of this setting). In this case, everything
under <a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> for this project must be outside of the
clone/checkout for the project.</p>
<p>You can use an <a class="reference internal" href="hooks.html#hooks-initialize"><em>initialize</em></a> hook script to automate the creation of
these symlinks whenever languages are added to your project.</p>
<p>If you use symlinks, ensure that the resulting structure under
<a class="reference internal" href="../server/settings.html#std:setting-VCS_DIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">VCS_DIRECTORY</span></tt></a> corresponds to the structure under
<a class="reference internal" href="../server/settings.html#std:setting-PODIRECTORY"><tt class="xref std std-setting docutils literal"><span class="pre">PODIRECTORY</span></tt></a>.</p>
</div>
<div class="section" id="working-with-vcs-integrated-projects">
<span id="version-control-working"></span><h2>Working with VCS integrated projects<a class="headerlink" href="#working-with-vcs-integrated-projects" title="Permalink to this headline">¶</a></h2>
<p>Once you have added a project with VCS integration to Pootle, if you have the
necessary privileges, you will be able to perform the different version control
functions from the actions section on the translation project overview page.</p>
<div class="section" id="updating">
<span id="version-control-updating"></span><h3>Updating<a class="headerlink" href="#updating" title="Permalink to this headline">¶</a></h3>
<p>If you want to update the Pootle copy of the translations with the version that
is currently in version control, a contributor with the &#8216;update&#8217; right can
click on the <em>Update</em> link for a file which will then perform the update
process.  The project administrator needs to assign the &#8220;update&#8221; right.</p>
<p>When updating from version control there is the possibility that a third party
could have changed the file (another translator accessing the version control
directly could have made a change).  Traditionally in version control this
would create a file with conflicts.  Those familiar with version control
conflicts will understand that we can&#8217;t afford to have that as we won&#8217;t be able
to resolve them.  Therefore Pootle will be conservative and will consider the
version control system to be the authority and any conflicts in the local file
get be converted to suggestions.  These suggestions then need to be reviewed by
a translator with <em>review</em> rights.</p>
</div>
<div class="section" id="committing">
<span id="version-control-committing"></span><h3>Committing<a class="headerlink" href="#committing" title="Permalink to this headline">¶</a></h3>
<p>You can commit translation files from within Pootle.  In the case where
authentication is required to submit the translation to version control
(probably almost all relevant systems), there needs to be a non-blocking
authentication method.  Pootle will not be able to commit if a password is
necessary to complete the action. This unfortunately means that it will
probably not be realistic for Pootle to commit with the project admin&#8217;s
credentials, as this will require his/her private key(s) to be on the Pootle
server.</p>
<p>This usage scenario is more useful for people hosting their own Pootle server
where they are able to setup one commit account on the version control server,
or perhaps one account for each team.  A typical commit message when committing
from Pootle will look something like this:</p>
<div class="highlight-python"><div class="highlight"><pre>Commit from GNOME Pootle by user Sipho.  80 of 100 messages translated (7
fuzzy).
</pre></div>
</div>
<p>So it is still possible to see who submitted what and when, and actually
provides some useful statistics in the commit message.  A user must be assigned
&#8216;commit&#8217; privileges by the project administrator.  If the user has the correct
privileges, they will see a &#8220;submit&#8221; link next to each file.</p>
<div class="section" id="version-control-authentication">
<span id="id1"></span><h4>Version Control Authentication<a class="headerlink" href="#version-control-authentication" title="Permalink to this headline">¶</a></h4>
<p>To access the repository of version controlled files (especially for
submitting), it is necessary to configure a non-interactive authentication.
This enables the Pootle server to connect to the version control server and to
submit changes with the appropriate privileges.</p>
<p>The following examples should help the pootle administrator to configure this
authentication properly.</p>
<div class="section" id="subversion-http">
<span id="version-control-subversion"></span><h5>Subversion (HTTP)<a class="headerlink" href="#subversion-http" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Add a new user with appropriate privileges to the subversion server, if
necessary (e.g. read <a class="reference external" href="http://svnbook.red-bean.com/nightly/en/svn.serverconfig.httpd.html#svn.serverconfig.httpd.authz">subversion authorization</a>)</li>
<li>Make sure, that the <em>pootle user</em> has write access for <cite>~/.subversion/</cite> to
store authentication tokens.  The <em>pootle user</em> is whichever user is running
the Pootle application.  When running behind a webserver this might be the
webserver user. Thus on some systems using Apache that user is <em>www-data</em>.</li>
<li>Do a real <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">commit</span></tt> with the uid of the <em>pootle user</em> in order to:<ul>
<li>Import (possibly) an SSL certificate</li>
<li>Store the username and password in the subversion authentication cache (by
default, the option <tt class="docutils literal"><span class="pre">store-passwords</span></tt> is enabled in
<cite>~/.subversion/config</cite>)</li>
</ul>
</li>
<li>If you start Pootle from an init script, make sure that all necessary
environment variables are set. <tt class="docutils literal"><span class="pre">$HOME</span></tt> will be needed to obtain your cached
authentication information, for example.</li>
</ul>
<p>From now on, the <em>pootle user</em> should use these stored access credentials when
uploading commits for this repository.</p>
</div>
</div>
</div>
<div class="section" id="adding">
<span id="version-control-adding"></span><h3>Adding<a class="headerlink" href="#adding" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>When a language is initialized from templates, Pootle will check if it is
inside a version control checkout/clone. If it is, it will add the new files as
initialized from the templates, and commit these initial versions. The same is
done when updating against templates at a later stage &#8211; if this introduced any new
files, these will be added to the configured version control system.</p>
<p>A typical commit message when adding from Pootle will look something like
this:</p>
<div class="highlight-python"><div class="highlight"><pre>New files added from Labs Translation Server based on templates
</pre></div>
</div>
</div>
</div>
</div>


</div>
<hr>

<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top ↑</a></p>
    <ul class="unstyled muted">
      <li><small>
        &copy; 2004-2014, Translate.<br/>
      </small></li>
      <li><small>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
      </small></li>
    </ul>
  </div>
</footer>
  </body>
</html>